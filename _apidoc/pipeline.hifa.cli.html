

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pipeline.hifa.cli package &mdash; Pipeline unknown documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/custom_theme.css?v=678032d9" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=3f1b9271"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Pipeline
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Pipeline Tasks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pipeline_tasks/pipeline_tasks.html">Pipeline Heuristics Tasks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Pipeline Task (sphinx-autosummary)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.h.cli.html">pipeline.h.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.hif.cli.html">pipeline.hif.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.hifa.cli.html">pipeline.hifa.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.hifv.cli.html">pipeline.hifv.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.hsd.cli.html">pipeline.hsd.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.hsdn.cli.html">pipeline.hsdn.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.domain.html">pipeline.domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.infrastructure.launcher.html">pipeline.infrastructure.launcher</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.domain.html">pipeline.domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.infrastructure.launcher.html">pipeline.infrastructure.launcher</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Pipeline Heuristics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../heuristics/field_parameter.html">Field parameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../heuristics/FlaggingTasks.html">Pipeline Flagging Tasks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Releases etc.</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Pipeline Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modular.html">Run the Pipeline in a Conda environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dependencies.html">Dependencies of <cite>Pipeline</cite></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Pipeline Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../basics.html">pipeline.domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics.html#module-pipeline.infrastructure.launcher">pipeline.infrastructure.launcher</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Task Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../task_classes.html">pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../task_classes.html#module-pipeline.hif.tasks">pipeline-l2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../task_classes.html#module-pipeline.hif">pipeline-l3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../task_classes.html#pipeline-diagram">pipeline-diagram</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/ways_to_run_the_pipeline.html">Ways to run the Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/comparing_pipeline_executions.html">Comparing pipeline executions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/building_the_pipeline.html">Building the pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/ALMA-Imaging-Workflow.html">ALMA interferometry imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/VLA-Imaging-Workflow.html">VLA interferometry imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/VLASS-SE-CONT-Imaging-Workflow.html">VLASS-SE-CONT imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/VLASS-SE-CUBE-Imaging-Workflow.html">VLASS-SE-CUBE imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/selfcal_workflow.html">VLASS Selfcal &amp; Restore workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/pipeline_tests.html">Pipeline testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/DataType_Testing.html">DataType Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/QA_scores.html">Pipeline Quality Assurance (QA) Score Class Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/DeveloperDocumentation.html">Pipeline developer documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/python3_conversion_notes.html">Python 3 conversion notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/recipes.html">Pipeline Recipes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples Notes (from Jupyter Notebooks)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/test1.html">test</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example Notes (from .rst)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/test2.html">Example 1</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Pipeline</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">pipeline.hifa.cli package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_apidoc/pipeline.hifa.cli.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pipeline-hifa-cli-package">
<h1>pipeline.hifa.cli package<a class="headerlink" href="#pipeline-hifa-cli-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-pipeline.hifa.cli.hifa_antpos">
<span id="pipeline-hifa-cli-hifa-antpos-module"></span><h2>pipeline.hifa.cli.hifa_antpos module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_antpos" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_antpos.hifa_antpos">
<span class="sig-name descname"><span class="pre">hifa_antpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_antpos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antposfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_antpos.html#hifa_antpos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_antpos.hifa_antpos" title="Link to this definition"></a></dt>
<dd><p>hifa_antpos —- Derive an antenna position calibration table</p>
<p>The hifa_antpos task corrects the antenna positions recorded in the ASDMs using
updated antenna position calibration information determined after the
observation was taken.</p>
<p>Corrections can be input by hand, read from a file on disk, or in the future
by querying an ALMA database service.</p>
<p>The antenna positions file is in ‘csv’ format containing 6 comma-delimited
columns as shown below. This file should not include blank lines, including
after the end of the last entry. The default name of this file is ‘antennapos.csv’.</p>
<p>Example of contents for an ‘antennapos.csv’ file:</p>
<blockquote>
<div><p>ms,antenna,xoffset,yoffset,zoffset,comment</p>
<p>uid___A002_X30a93d_X43e.ms,DV11,0.000,0.010,0.000,”No comment”</p>
<p>uid___A002_X30a93d_X43e.dup.ms,DV11,0.000,-0.010,0.000,”No comment”</p>
</div></blockquote>
<p>The offset values in this file are in meters.</p>
<p>The corrections are used to generate a calibration table which is recorded
in the pipeline context and applied to the raw visibility data, on the fly to
generate other calibration tables, or permanently to generate calibrated
visibilities for imaging.</p>
<p>Note: the <code class="docutils literal notranslate"><span class="pre">hm_antpos</span></code> ‘online’ option will be implemented when the
observing system provides an antenna position determination service.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
<dt>caltable</dt><dd><p>List of names for the output calibration tables. Defaults
to the standard pipeline naming convention.</p>
<p>Example: caltable=[‘ngc5921.gcal’]</p>
</dd>
<dt>hm_antpos</dt><dd><p>Heuristics method for retrieving the antenna position
corrections. The options are ‘online’ (not yet implemented),
‘manual’, and ‘file’.</p>
<p>Example: hm_antpos=’manual’</p>
</dd>
<dt>antenna</dt><dd><p>The list of antennas for which the positions are to be corrected
if <code class="docutils literal notranslate"><span class="pre">hm_antpos</span></code> is ‘manual’.</p>
<p>Example: antenna=’DV05,DV07’</p>
</dd>
<dt>offsets</dt><dd><p>The list of antenna offsets for each antenna in ‘antennas’.
Each offset is a set of 3 floating point numbers separated by
commas, specified in the ITRF frame.</p>
<p>Example: offsets=[0.01, 0.02, 0.03, 0.03, 0.02, 0.01]</p>
</dd>
<dt>antposfile</dt><dd><p>The file(s) containing the antenna offsets. Used if
<code class="docutils literal notranslate"><span class="pre">hm_antpos</span></code> is ‘file’.</p>
</dd>
<dt>threshold</dt><dd><p>Highlight antenna position offsets greater than this value in
the weblog. Units are wavelengths and the default is 1.0.</p>
<p>Example: threshold=1.0</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Correct the position of antenna ‘DV05’ for all the visibility files in a
single pipeline run:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_antpos</span><span class="p">(</span><span class="n">antenna</span><span class="o">=</span><span class="s1">&#39;DV05&#39;</span><span class="p">,</span> <span class="n">offsets</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">])</span>
</pre></div>
</div>
<p>2. Correct the position of antennas for all the visibility files in a single
pipeline run using antenna positions files on disk. These files are assumed
to conform to a default naming scheme if <code class="docutils literal notranslate"><span class="pre">antposfile</span></code> is unspecified by the
user:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_antpos</span><span class="p">(</span><span class="n">hm_antpos</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="n">antposfile</span><span class="o">=</span><span class="s1">&#39;myantposfile.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_bandpass">
<span id="pipeline-hifa-cli-hifa-bandpass-module"></span><h2>pipeline.hifa.cli.hifa_bandpass module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_bandpass" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_bandpass.hifa_bandpass">
<span class="sig-name descname"><span class="pre">hifa_bandpass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_phaseup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupsolint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupbw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupnsols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_bandpass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxchannels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evenbpints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minbpsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpnsols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solnorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minblperant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unregister_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_auto_fillgaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_bandpass.html#hifa_bandpass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_bandpass.hifa_bandpass" title="Link to this definition"></a></dt>
<dd><p>hifa_bandpass —- Compute bandpass calibration solutions</p>
<p>The hifa_bandpass task computes a bandpass solution for every specified
science spectral window. By default, a ‘phaseup’ pre-calibration is
performed and applied on the fly to the data, before the bandpass is
computed.</p>
<p>The hif_refant task may be used to pre-compute a prioritized list of
reference antennas.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
<dt>caltable</dt><dd><p>List of names for the output calibration tables. Defaults
to the standard pipeline naming convention.</p>
<p>Example: caltable=[‘ngc5921.gcal’]</p>
</dd>
<dt>field</dt><dd><p>The list of field names or field ids for which
bandpasses are computed. Set to field=’’ by default,
which means the task will select all fields.</p>
<p>Example: field=’3C279’, field=’3C279,M82’</p>
</dd>
<dt>intent</dt><dd><p>A string containing a comma delimited list of intents
against which the selected fields are matched. Set to
intent=’’ by default, which means the task will select
all data with the BANDPASS intent.</p>
<p>Example: intent=’<cite>*PHASE*</cite>’</p>
</dd>
<dt>spw</dt><dd><p>The list of spectral windows and channels for which
bandpasses are computed. Set to spw=’’ by default, which
means the task will select all science spectral windows.</p>
<p>Example: spw=’11,13,15,17’</p>
</dd>
<dt>antenna</dt><dd><p>Set of data selection antenna IDs</p>
</dd>
<dt>hm_phaseup</dt><dd><p>The pre-bandpass solution phaseup gain heuristics. The
options are:</p>
<p>‘snr’: compute solution required to achieve the specified SNR</p>
<p>‘manual’: use manual solution parameters</p>
<p>‘’: skip phaseup</p>
<p>Example: hm_phaseup=’manual’</p>
</dd>
<dt>phaseupsolint</dt><dd><p>The phase correction solution interval in CASA syntax.
Used when <code class="docutils literal notranslate"><span class="pre">hm_phaseup</span></code> = ‘manual’ or as a default if
the <code class="docutils literal notranslate"><span class="pre">hm_phaseup</span></code> = ‘snr’ heuristic computation fails.</p>
<p>Example: phaseupsolint=’300s’</p>
</dd>
<dt>phaseupbw</dt><dd><p>Bandwidth to be used for phaseup. Used when
<code class="docutils literal notranslate"><span class="pre">hm_phaseup</span></code> = ‘manual’.</p>
<p>Example:</p>
<p>phaseupbw=’’ to use entire bandpass</p>
<p>phaseupbw=’500MHz’ to use central 500MHz</p>
</dd>
<dt>phaseupsnr</dt><dd><p>The required SNR for the phaseup solution. Used to calculate
the phaseup time solint, and only if
<code class="docutils literal notranslate"><span class="pre">hm_phaseup</span></code> = ‘snr’.</p>
<p>Example: phaseupsnr=10.0</p>
</dd>
<dt>phaseupnsols</dt><dd><p>The minimum number of phaseup gain solutions. Used only
if <code class="docutils literal notranslate"><span class="pre">hm_phaseup</span></code> = ‘snr’.</p>
<p>Example: phaseupnsols=4</p>
</dd>
<dt>hm_bandpass</dt><dd><p>The bandpass solution heuristics. The options are:</p>
<p>‘snr’: compute the solution required to achieve the specified SNR</p>
<p>‘smoothed’: simple ‘smoothing’ i.e. spectral solint&gt;1chan</p>
<p>‘fixed’: use the user defined parameters for all spws</p>
<p>Example: hm_bandpass=’snr’</p>
</dd>
<dt>solint</dt><dd><p>Time and channel solution intervals in CASA syntax.
Default is solint=’inf’, which is used when
<code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘fixed’.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’, then the task will attempt
to compute and use an optimal SNR-based solint (and warn
if this solint is not good enough).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘smoothed’, the task will override
the spectral solint with bandwidth/maxchannels.</p>
<p>Example: solint=’int’</p>
</dd>
<dt>maxchannels</dt><dd><p>The bandpass solution ‘smoothing’ factor in channels,
i.e. spectral solint will be set to bandwidth / maxchannels
Set to 0 for no smoothing. Used if
<code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘smoothed’.</p>
<p>Example: maxchannels=240</p>
</dd>
<dt>evenbpints</dt><dd><p>Force the per spw frequency solint to be evenly divisible
into the spw bandpass if <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’.</p>
<p>Example: evenbpints=False</p>
</dd>
<dt>bpsnr</dt><dd><p>The required SNR for the bandpass solution. Used only if
<code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’.</p>
<p>Example: bpsnr=30.0</p>
</dd>
<dt>minbpsnr</dt><dd><p>The minimum required SNR for the bandpass solution
when strong atmospheric lines exist in Tsys spectra.
Used only if <a href="#id1"><span class="problematic" id="id2">``</span></a>hm_bandpass``=’snr’.</p>
<p>Example: minbpsnr=10.0</p>
</dd>
<dt>bpnsols</dt><dd><p>The minimum number of bandpass solutions. Used only if
<code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’.</p>
<p>Example: bpnsols=8</p>
</dd>
<dt>combine</dt><dd><p>Data axes to combine for solving. Axes are ‘’, ‘scan’,
‘spw’, ‘field’ or any comma-separated combination.</p>
<p>Example: combine=’scan,field’</p>
</dd>
<dt>refant</dt><dd><p>List of reference antenna names. Defaults to the
value(s) stored in the pipeline context. If undefined in
the pipeline context defaults to the CASA reference
antenna naming scheme.</p>
<p>Example: refant=’DV06,DV07’</p>
</dd>
<dt>solnorm</dt><dd><p>Normalise the bandpass solution; defaults to True.</p>
<p>Example: solnorm=False</p>
</dd>
<dt>minblperant</dt><dd><p>Minimum number of baselines required per antenna for
each solve. Antennas with fewer baselines are excluded
from solutions.</p>
<p>Example: minblperant=4</p>
</dd>
<dt>minsnr</dt><dd><p>Solutions below this SNR are rejected in the phaseup and
bandpass solves.</p>
<p>Example: minsnr=3.0</p>
</dd>
<dt>unregister_existing</dt><dd><p>Unregister all bandpass calibrations from the pipeline
context before registering the new bandpass calibrations
from this task. Defaults to False.</p>
<p>Example: unregister_existing=True</p>
</dd>
<dt>hm_auto_fillgaps</dt><dd><p>If True, then the <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’ or ‘smoothed’
modes, that solve bandpass per SpW, are performed with
CASA bandpass task parameter ‘fillgaps’ set to a quarter
of the respective SpW bandwidth (in channels).</p>
<p>If False, then these bandpass solves will use
fillgaps=0.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘fixed’ mode is unaffected by
<code class="docutils literal notranslate"><span class="pre">hm_auto_fillgaps</span></code> and always uses fillgaps=0.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Compute a channel bandpass for all visibility files in the pipeline
context using the CASA reference antenna determination scheme:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_bandpass</span><span class="p">()</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Same as the above but precompute a prioritized reference antenna list:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hif_refant</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_bandpass</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_bandpassflag">
<span id="pipeline-hifa-cli-hifa-bandpassflag-module"></span><h2>pipeline.hifa.cli.hifa_bandpassflag module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_bandpassflag" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_bandpassflag.hifa_bandpassflag">
<span class="sig-name descname"><span class="pre">hifa_bandpassflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_phaseup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupsolint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupbw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupnsols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_bandpass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxchannels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evenbpints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minbpsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpnsols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minblperant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solnorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antnegsig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antpossig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmantint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antblnegsig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antblpossig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relaxed_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_auto_fillgaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_bandpassflag.html#hifa_bandpassflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_bandpassflag.hifa_bandpassflag" title="Link to this definition"></a></dt>
<dd><p>hifa_bandpassflag —- Bandpass calibration flagging</p>
<p>This task performs a preliminary phased-up bandpass solution and temporarily
applies it, then computes the flagging heuristics by calling
hif_correctedampflag which looks for outlier visibility points by statistically
examining the scalar difference of the corrected amplitudes minus model
amplitudes, and then flags those outliers. The philosophy is that only outlier
data points that have remained outliers after calibration will be flagged. Note
that the phase of the data is not assessed.</p>
<p>Plots are generated at two points in this workflow: after bandpass calibration
but before flagging heuristics are run, and after flagging heuristics have been
run and applied. If no points were flagged, the ‘after’ plots are not generated
or displayed.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
<dt>caltable</dt><dd><p>List of names for the output calibration tables. Defaults
to the standard pipeline naming convention.</p>
<p>Example: caltable=[‘ngc5921.gcal’]</p>
</dd>
<dt>intent</dt><dd><p>A string containing a comma delimited list of intents against
which the selected fields are matched. Set to intent=’’ by default, which
means the task will select all data with the BANDPASS intent.</p>
<p>Example: intent=’<cite>*PHASE*</cite>’</p>
</dd>
<dt>field</dt><dd><p>The list of field names or field ids for which bandpasses are
computed. Set to field=’’ by default, which means the task
will select all fields.</p>
<p>Example: field=’3C279’, field=’3C279,M82’</p>
</dd>
<dt>spw</dt><dd><p>The list of spectral windows and channels for which bandpasses are
computed. Set to spw=’’ by default, which means the task will select all
science spectral windows.</p>
<p>Example: spw=’11,13,15,17’</p>
</dd>
<dt>antenna</dt><dd><p>Set of data selection antenna IDs</p>
</dd>
<dt>hm_phaseup</dt><dd><p>The pre-bandpass solution phaseup gain heuristics. The options are:</p>
<p>‘snr’: compute solution required to achieve the specified SNR</p>
<p>‘manual’: use manual solution parameters</p>
<p>‘’: skip phaseup</p>
<p>Example: hm_phaseup=’manual’</p>
</dd>
<dt>phaseupsolint</dt><dd><p>The phase correction solution interval in CASA syntax.
Used when <code class="docutils literal notranslate"><span class="pre">hm_phaseup</span></code> = ‘manual’ or as a default if the
<code class="docutils literal notranslate"><span class="pre">hm_phaseup</span></code> = ‘snr’ heuristic computation fails.</p>
<p>Example: phaseupsolint=’300s’</p>
</dd>
<dt>phaseupbw</dt><dd><p>Bandwidth to be used for phaseup. Used when
<code class="docutils literal notranslate"><span class="pre">hm_phaseup</span></code> = ‘manual’.</p>
<p>Example:</p>
<p>phaseupbw=’’ to use entire bandpass</p>
<p>phaseupbw=’500MHz’ to use central 500MHz</p>
</dd>
<dt>phaseupsnr</dt><dd><p>The required SNR for the phaseup solution. Used only if
hm_phaseup=’snr’.</p>
<p>Example: phaseupsnr=10.0</p>
</dd>
<dt>phaseupnsols</dt><dd><p>The minimum number of phaseup gain solutions. Used only if
hm_phaseup=’snr’.</p>
<p>Example: phaseupnsols=4</p>
</dd>
<dt>hm_bandpass</dt><dd><p>The bandpass solution heuristics. The options are:</p>
<p>‘snr’: compute the solution required to achieve the specified SNR</p>
<p>‘smoothed’: simple ‘smoothing’ i.e. spectral solint&gt;1chan</p>
<p>‘fixed’: use the user defined parameters for all spws</p>
</dd>
<dt>solint</dt><dd><p>Time and channel solution intervals in CASA syntax.
Default is solint=’inf’, which is used when
<code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘fixed’.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’, then the task will attempt to
compute and use an optimal SNR-based solint (and warn if this
solint is not good enough).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘smoothed’, the task will override the
spectral solint with bandwidth/maxchannels.</p>
</dd>
<dt>maxchannels</dt><dd><p>The bandpass solution ‘smoothing’ factor in channels, i.e.
spectral solint will be set to bandwidth/maxchannels
Set to 0 for no smoothing.
Used if <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘smoothed’.</p>
<p>Example: maxchannels=240</p>
</dd>
<dt>evenbpints</dt><dd><p>Force the per spw frequency solint to be evenly divisible
into the spw bandpass if <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’.</p>
<p>Example: evenbpints=False</p>
</dd>
<dt>bpsnr</dt><dd><p>The required SNR for the bandpass solution. Used only if
<code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’.</p>
<p>Example: bpsnr=30.0</p>
</dd>
<dt>minbpsnr</dt><dd><p>The minimum required SNR for the bandpass solution
when strong atmospheric lines exist in Tsys spectra.
Used only if <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’.</p>
<p>Example: minbpsnr=10.0</p>
</dd>
<dt>bpnsols</dt><dd><p>The minimum number of bandpass solutions. Used only if
<code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’.</p>
<p>Example: bpnsols=8</p>
</dd>
<dt>combine</dt><dd><p>Data axes to combine for solving. Axes are ‘’, ‘scan’, ‘spw’,
‘field’ or any comma-separated combination.</p>
<p>Example: combine=’scan,field’</p>
</dd>
<dt>refant</dt><dd><p>List of reference antenna names. Defaults to the value(s) stored in the
pipeline context. If undefined in the pipeline context defaults to
the CASA reference antenna naming scheme.</p>
<p>Example: refant=’DV06,DV07’</p>
</dd>
<dt>minblperant</dt><dd><p>Minimum number of baselines required per antenna for each solve.
Antennas with fewer baselines are excluded from solutions.</p>
<p>Example: minblperant=4</p>
</dd>
<dt>minsnr</dt><dd><p>Solutions below this SNR are rejected.</p>
<p>Example: minsnr=3.0</p>
</dd>
<dt>solnorm</dt><dd><p>Normalise the bandpass solution; defaults to True.</p>
</dd>
<dt>antnegsig</dt><dd><p>Lower sigma threshold for identifying outliers as a result of
bad antennas within individual timestamps.</p>
<p>Example: antnegsig=4.0</p>
</dd>
<dt>antpossig</dt><dd><p>Upper sigma threshold for identifying outliers as a result of
bad antennas within individual timestamps.</p>
<p>Example: antpossig=4.6</p>
</dd>
<dt>tmantint</dt><dd><p>Threshold for maximum fraction of timestamps that are allowed
to contain outliers.</p>
<p>Example: tmantint=0.063</p>
</dd>
<dt>tmint</dt><dd><p>Initial threshold for maximum fraction of ‘outlier timestamps’
over ‘total timestamps’ that a baseline may be a part of.</p>
<p>Example: tmint=0.085</p>
</dd>
<dt>tmbl</dt><dd><p>Initial threshold for maximum fraction of ‘bad baselines’ over
‘all baselines’ that an antenna may be a part of.</p>
<p>Example: tmbl=0.175</p>
</dd>
<dt>antblnegsig</dt><dd><p>Lower sigma threshold for identifying outliers as a result of
‘bad baselines’ and/or ‘bad antennas’ within baselines (across all
timestamps).</p>
<p>Example: antblnegsig=3.4</p>
</dd>
<dt>antblpossig</dt><dd><p>Upper sigma threshold for identifying outliers as a result of
‘bad baselines’ and/or ‘bad antennas’ within baselines (across all
timestamps).</p>
<p>Example: antblpossig=3.2</p>
</dd>
<dt>relaxed_factor</dt><dd><p>Relaxed value to set the threshold scaling factor to under
certain conditions (see documentation of the underlying correctedampflag task).</p>
<p>Example: relaxed_factor=2.0</p>
</dd>
<dt>niter</dt><dd><p>Maximum number of times to iterate on evaluation of flagging
heuristics. If an iteration results in no new flags, then subsequent
iterations are skipped.</p>
<p>Example: niter=2</p>
</dd>
<dt>hm_auto_fillgaps</dt><dd><p>If True, then the <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’ or ‘smoothed’
modes, that solve bandpass per SpW, are performed with
CASA bandpass task parameter ‘fillgaps’ set to a quarter
of the respective SpW bandwidth (in channels).</p>
<p>If False, then these bandpass solves will use
fillgaps=0.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘fixed’ mode is unaffected by
<code class="docutils literal notranslate"><span class="pre">hm_auto_fillgaps</span></code> and always uses fillgaps=0.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. run with recommended settings to create bandpass solution with flagging
using recommended thresholds:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_bandpassflag</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_bpsolint">
<span id="pipeline-hifa-cli-hifa-bpsolint-module"></span><h2>pipeline.hifa.cli.hifa_bpsolint module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_bpsolint" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_bpsolint.hifa_bpsolint">
<span class="sig-name descname"><span class="pre">hifa_bpsolint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minphaseupints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evenbpints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minbpsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minbpnchan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_nantennas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxfracflagged</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_bpsolint.html#hifa_bpsolint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_bpsolint.hifa_bpsolint" title="Link to this definition"></a></dt>
<dd><p>hifa_bpsolint —- Compute optimal bandpass calibration solution intervals</p>
<p>The optimal bandpass phaseup time and frequency solution intervals required
to achieve the required signal-to-noise ratio is estimated based on nominal
ALMA array characteristics the metadata associated with the observation.</p>
<p>The phaseup gain time and bandpass frequency intervals are determined as
follows:</p>
<ul class="simple">
<li><p>For each data set the list of source(s) to use for bandpass solution
signal-to-noise estimation is compiled based on the values of the
<code class="docutils literal notranslate"><span class="pre">field</span></code>, <code class="docutils literal notranslate"><span class="pre">intent</span></code>, and <code class="docutils literal notranslate"><span class="pre">spw</span></code> parameters.</p></li>
<li><p>Source fluxes are determined for each spw and source combination.</p></li>
<li><p>Fluxes in Jy are derived from the pipeline context.</p></li>
<li><p>Pipeline context fluxes are derived from the online flux calibrator
catalog, the ASDM, or the user via the flux.csv file.</p></li>
<li><p>If no fluxes are available the task terminates.</p></li>
<li><p>Atmospheric calibration and observations scans are determined for each
spw and source combination.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">intent</span></code> is set to ‘PHASE’ are there are no atmospheric scans
associated with the ‘PHASE’ calibrator, ‘TARGET’ atmospheric scans will be
used instead.</p></li>
<li><p>If atmospheric scans cannot be associated with any of the spw and source
combinations the task terminates.</p></li>
<li><p>Science spws are mapped to atmospheric spws for each science spw and
source combination.</p></li>
<li><p>If mappings cannot be determined for any of the spws the task terminates.</p></li>
<li><p>The median Tsys value for each atmospheric spw and source combination is
determined from the SYSCAL table. Medians are computed first by channel,
then by antenna, in order to reduce sensitivity to deviant values.</p></li>
<li><p>The science spw parameters, exposure time(s), and integration time(s) are
determined.</p></li>
<li><p>The phase-up time interval, in time units and number of integrations
required to meet the <code class="docutils literal notranslate"><span class="pre">phaseupsnr</span></code> are computed, along with the
sensitivity in mJy and the signal-to-noise per integration. Nominal Tsys
and sensitivity values per receiver band provided by the ALMA project are
used for this estimate.</p></li>
<li><p>Warnings are issued if estimated phase-up gain time solution would contain
fewer than <code class="docutils literal notranslate"><span class="pre">minphaseupints</span></code> solutions.</p></li>
<li><p>The frequency interval, in MHz and number of channels required to meet the
<code class="docutils literal notranslate"><span class="pre">bpsnr</span></code> are computed, along with the per channel sensitivity in mJy and
the per channel signal-to-noise. Nominal Tsys and sensitivity values per
receiver band provided by the ALMA project are used for this estimate.</p></li>
<li><p>Warnings are issued if estimated bandpass solution would contain fewer
than <code class="docutils literal notranslate"><span class="pre">minbpnchan</span></code> solutions.</p></li>
<li><p>If strong atmospheric features are detected in the Tsys spectrum for a
given spw, the frequency interval of bandpass solution is recalculated to
meet the lower threshold, <code class="docutils literal notranslate"><span class="pre">minbpsnr</span></code> - i.e. a lower snr is tolerated in
order to preserve enough frequency intervals to capture the atmospheric
line.</p></li>
</ul>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>example: vis=[‘M82A.ms’, ‘M82B.ms’]</p>
</dd>
<dt>field</dt><dd><p>The list of field names of sources to be used for
signal-to-noise estimation. Defaults to all fields with the
standard intent.</p>
<p>example: field=’3C279’</p>
</dd>
<dt>intent</dt><dd><p>A string containing a comma delimited list of intents against
which the selected fields are matched. Defaults to
‘BANDPASS’.</p>
<p>example: intent=’PHASE’</p>
</dd>
<dt>spw</dt><dd><p>The list of spectral windows and channels for which gain
solutions are computed. Defaults to all the science spectral
windows for which there are both ‘intent’ and TARGET intents.</p>
<p>example: spw=’13,15’</p>
</dd>
<dt>phaseupsnr</dt><dd><p>The required phase-up gain time interval solution
signal-to-noise.</p>
<p>example: phaseupsnr=10.0</p>
</dd>
<dt>minphaseupints</dt><dd><p>The minimum number of time intervals in the phase-up gain
solution.</p>
<p>example: minphaseupints=4</p>
</dd>
<dt>evenbpints</dt><dd><p>Use a bandpass frequency solint that is an integer divisor of
the spw bandwidth, to prevent the occurrence of one narrower
fractional frequency interval.</p>
</dd>
<dt>bpsnr</dt><dd><p>The required bandpass frequency interval solution
signal-to-noise.</p>
<p>example: bpsnr=30.0</p>
</dd>
<dt>minbpsnr</dt><dd><p>The minimum required bandpass frequency interval solution
signal-to-noise when strong atmospheric lines exist in Tsys
spectra.</p>
<p>example: minbpsnr=10.0</p>
</dd>
<dt>minbpnchan</dt><dd><p>The minimum number of frequency intervals in the bandpass
solution.</p>
<p>example: minbpnchan=16</p>
</dd>
<dt>hm_nantennas</dt><dd><p>The heuristics for determines the number of antennas to use
in the signal-to-noise estimate. The options are ‘all’ and
‘unflagged’. The ‘unflagged’ options is not currently
supported.</p>
<p>example: hm_nantennas=’unflagged’</p>
</dd>
<dt>maxfracflagged</dt><dd><p>The maximum fraction of an antenna that can be flagged before
it is excluded from the signal-to-noise estimate.</p>
<p>example: maxfracflagged=0.80</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Estimate the phaseup gain time interval and the bandpass frequency
interval required to match the desired signal-to-noise for bandpass
solutions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_bpsolint</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_diffgaincal">
<span id="pipeline-hifa-cli-hifa-diffgaincal-module"></span><h2>pipeline.hifa.cli.hifa_diffgaincal module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_diffgaincal" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_diffgaincal.hifa_diffgaincal">
<span class="sig-name descname"><span class="pre">hifa_diffgaincal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_diffgaincal.html#hifa_diffgaincal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_diffgaincal.hifa_diffgaincal" title="Link to this definition"></a></dt>
<dd><p>hifa_diffgaincal —- Derive SpW phase offsets from differential gain calibrator.</p>
<p>This task creates the spectral window phase gain offset table used to allow
calibrating the “on-source” spectral setup with phase gains from a
“reference” spectral setup. A bright point source Quasar, called the
Differential Gain Calibrator (DIFFGAIN) source, is used for this purpose.
This DIFFGAIN source typically observed in groups of interleaved “reference”
and “on-source” scans, once at the start and once at the end of the
observations. In very long observations, there may be a group of scans
occurring during the middle. Scan groups are combined while solving for SpW
offsets between “reference” and “on-source” spectral setups.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: [‘M32A.ms’, ‘M32B.ms’]</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Derive SpW phase offsets from differential gain calibrator.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_diffgaincal</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_exportdata">
<span id="pipeline-hifa-cli-hifa-exportdata-module"></span><h2>pipeline.hifa.cli.hifa_exportdata module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_exportdata" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_exportdata.hifa_exportdata">
<span class="sig-name descname"><span class="pre">hifa_exportdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imaging_products_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exportmses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pprfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calintents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calimages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetimages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">products_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_exportdata.html#hifa_exportdata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_exportdata.hifa_exportdata" title="Link to this definition"></a></dt>
<dd><p>hifa_exportdata —- Prepare interferometry data for export</p>
<p>Prepare interferometry data for export.</p>
<p>The hifa_exportdata task for ALMA CASA pipeline exports the data defined
in the pipeline context and exports it to the data products directory,
converting and or packing it as necessary.</p>
<p>The current version of the task exports the following products</p>
<ul class="simple">
<li><p>an XML file containing the pipeline processing request</p></li>
<li><p>a tar file per ASDM / MS containing the final flags version</p></li>
<li><p>a text file per ASDM / MS containing the final calibration apply list</p></li>
<li><p>a FITS image for each selected calibrator source image</p></li>
<li><p>a FITS image for each selected science target source image</p></li>
<li><p>a tar file per session containing the caltables for that session</p></li>
<li><p>a tar file containing the file web log</p></li>
<li><p>a text file containing the final list of CASA commands</p></li>
<li><p>an XML “manifest” file listing the products</p></li>
<li><p>an XML “aquareport” file listing the QA scores and sub-scores,
image sensitivities, and other numerical information</p></li>
</ul>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of visibility data files for which flagging and calibration
information will be exported. Defaults to the list maintained in the
pipeline context.</p>
<p>Example: vis=[‘X227.ms’, ‘X228.ms’]</p>
</dd>
<dt>session</dt><dd><p>List of sessions one per visibility file. Currently defaults
to a single virtual session containing all the visibility files in vis.
In the future, this will default to the set of observing sessions defined
in the context.</p>
<p>Example: session=[‘session1’, ‘session2’]</p>
</dd>
<dt>imaging_products_only</dt><dd><p>Export science target imaging products only</p>
</dd>
<dt>exportmses</dt><dd><p>Export the final MeasurementSets instead of the final flags,
calibration tables, and calibration instructions.</p>
</dd>
<dt>pprfile</dt><dd><p>Name of the pipeline processing request to be exported. Defaults
to a file matching the template ‘PPR_*.xml’.</p>
<p>Example: pprfile=[‘PPR_GRB021004.xml’]</p>
</dd>
<dt>calintents</dt><dd><p>List of calibrator image types to be exported. Defaults to
all standard calibrator intents, ‘BANDPASS’, ‘PHASE’, ‘FLUX’.</p>
<p>Example: ‘PHASE’</p>
</dd>
<dt>calimages</dt><dd><p>List of calibrator images to be exported. Defaults to all
calibrator images recorded in the pipeline context.</p>
<p>Example: calimages=[‘3C454.3.bandpass’, ‘3C279.phase’]</p>
</dd>
<dt>targetimages</dt><dd><p>List of science target images to be exported. Defaults to all
science target images recorded in the pipeline context.</p>
<p>Example: targetimages=[‘NGC3256.band3’, ‘NGC3256.band6’]</p>
</dd>
<dt>products_dir</dt><dd><p>Name of the data products subdirectory. Defaults to ‘./’.</p>
<p>Example: products_dir=’../products’</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Export the pipeline results for a single session to the data products
directory:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; !mkdir ../products
&gt;&gt;&gt; hif_exportdata(products_dir=&#39;../products&#39;)
</pre></div>
</div>
<p>2. Export the pipeline results to the data products directory specify that
only the gain calibrator images be saved:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; !mkdir ../products
&gt;&gt;&gt; hif_exportdata(products_dir=&#39;../products&#39;, calintents=&#39;*PHASE*&#39;)
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_flagdata">
<span id="pipeline-hifa-cli-hifa-flagdata-module"></span><h2>pipeline.hifa.cli.hifa_flagdata module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_flagdata" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_flagdata.hifa_flagdata">
<span class="sig-name descname"><span class="pre">hifa_flagdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autocorr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shadow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scannumber</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgespw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracspw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracspwfps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">online</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partialpol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowtrans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mintransrepspw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mintransnonrepspws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fileonline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetemplate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_tbuff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tbuff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flagbackup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_flagdata.html#hifa_flagdata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_flagdata.hifa_flagdata" title="Link to this definition"></a></dt>
<dd><p>hifa_flagdata —- Do metadata based flagging of a list of MeasurementSets.</p>
<p>The hifa_flagdata data performs basic flagging operations on a list of
measurements including:</p>
<ul class="simple">
<li><p>applying online flags</p></li>
<li><p>applying a flagging template</p></li>
<li><p>partial polarization flagging</p></li>
<li><p>autocorrelation data flagging</p></li>
<li><p>shadowed antenna data flagging</p></li>
<li><p>scan-based flagging by intent or scan number</p></li>
<li><p>edge channel flagging, as needed</p></li>
<li><p>low atmospheric transmission flagging</p></li>
</ul>
<p>About the spectral window edge channel flagging:</p>
<ul class="simple">
<li><p>For TDM spectral windows, a number of edge channels are always flagged,
according to the <code class="docutils literal notranslate"><span class="pre">fracspw</span></code> and <code class="docutils literal notranslate"><span class="pre">fracspwfps</span></code> parameters (the latter
operates only on spectral windows with 62, 124, or 248 channels). With the
default setting of <code class="docutils literal notranslate"><span class="pre">fracspw</span></code>, the number of channels flagged on each edge
is 2, 4, or 8 for 64, 128, or 256-channel spectral windows, respectively.</p></li>
<li><p>For most FDM spectral windows, no edge flagging is done. The only exceptions
are ACA spectral windows that encroach too close to the baseband edge.
Channels that lie closer to the baseband edge than the following values are
flagged: 62.5, 40, 20, 10, and 5 MHz for spectral windows with bandwidths of
1000, 500, 250, 125, and 62.5 MHz, respectively. A warning is generated in
the weblog if flagging occurs due to proximity to the baseband edge.
By definition, 2000 MHz spectral windows always encroach the baseband edge on
both sides of the spectral window, and thus are always flagged on both sides
in order to achieve 1875 MHz bandwidth (in effect, they are flagged by
62.5 MHz on each side), and thus no warning is generated.</p></li>
</ul>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets defined in the pipeline context.</p>
</dd>
<dt>autocorr</dt><dd><p>Flag autocorrelation data.</p>
</dd>
<dt>shadow</dt><dd><p>Flag shadowed antennas.</p>
</dd>
<dt>tolerance</dt><dd><p>Amount of antenna shadowing tolerated, in meters. A positive number
allows antennas to overlap in projection. A negative number forces antennas
apart in projection. Zero implies a distance of radius_1+radius_2 between
antenna centers.</p>
</dd>
<dt>scan</dt><dd><p>Flag a list of specified scans.</p>
</dd>
<dt>scannumber</dt><dd><p>A string containing a comma delimited list of scans to be
flagged.</p>
<p>Example: scannumber=’3,5,6’</p>
</dd>
<dt>intents</dt><dd><p>A string containing a comma delimited list of intents against
which the scans to be flagged are matched.</p>
<p>Example: intents=’<cite>*BANDPASS*</cite>’</p>
</dd>
<dt>edgespw</dt><dd><p>Flag the edge spectral window channels.</p>
</dd>
<dt>fracspw</dt><dd><p>Fraction of channels to flag at both edges of TDM spectral windows.</p>
</dd>
<dt>fracspwfps</dt><dd><p>Fraction of channels to flag at both edges of ACA TDM
spectral windows that were created with the earlier (original)
implementation of the frequency profile synthesis (FPS) algorithm.</p>
</dd>
<dt>online</dt><dd><p>Apply the online flags.</p>
</dd>
<dt>partialpol</dt><dd><p>Identify integrations in multi-polarisation data where part
of the polarization products are already flagged, and flag the other
polarization products in those integrations.</p>
</dd>
<dt>lowtrans</dt><dd><p>Flag spectral windows for which a significant fraction of
the channels have atmospheric transmission below the
threshold (<code class="docutils literal notranslate"><span class="pre">mintransrepspw</span></code>, <code class="docutils literal notranslate"><span class="pre">mintransnonrepspws</span></code>).</p>
</dd>
<dt>mintransnonrepspws</dt><dd><p>This atmospheric transmissivity threshold is used to flag
a non-representative science spectral window when more than 60% of
its channels have a transmissivity below this level.</p>
</dd>
<dt>mintransrepspw</dt><dd><p>This atmospheric transmissivity threshold is used to flag the
representative science spectral window when more than 60% of its channels
have a transmissivity below this level.</p>
</dd>
<dt>fileonline</dt><dd><p>File containing the online flags. These are computed by the
h_init or hif_importdata data tasks. If the online flags files
are undefined a name of the form ‘msname.flagonline.txt’ is assumed.</p>
</dd>
<dt>template</dt><dd><p>Apply flagging templates</p>
</dd>
<dt>filetemplate</dt><dd><p>The name of a text file that contains the flagging template
for RFI, birdies, telluric lines, etc. If the template flags files
is undefined a name of the form ‘msname.flagtemplate.txt’ is assumed.</p>
</dd>
<dt>hm_tbuff</dt><dd><p>The heuristic for computing the default time interval padding
parameter. The options are ‘halfint’ and ‘manual’. In ‘halfint’ mode tbuff
is set to half the maximum of the median integration time of the science
and calibrator target observations. The value of 0.048 seconds is
subtracted from the lower time limit to accommodate the behavior of the
ALMA Control system.</p>
</dd>
<dt>tbuff</dt><dd><p>The time in seconds used to pad flagging command time
intervals if <code class="docutils literal notranslate"><span class="pre">hm_tbuff</span></code> = ‘manual’. The default in
manual mode is no flagging.</p>
</dd>
<dt>qa0</dt><dd><p>QA0 flags.</p>
</dd>
<dt>qa2</dt><dd><p>QA2 flags.</p>
</dd>
<dt>flagbackup</dt><dd><p>Back up any pre-existing flags.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Do basic flagging on a MeasurementSet:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_flagdata</span><span class="p">()</span>
</pre></div>
</div>
<p>2. Do basic flagging on a MeasurementSet flagging additional scans selected
by number as well:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_flagdata</span><span class="p">(</span><span class="n">scannumber</span><span class="o">=</span><span class="s1">&#39;13,18&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_flagtargets">
<span id="pipeline-hifa-cli-hifa-flagtargets-module"></span><h2>pipeline.hifa.cli.hifa_flagtargets module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_flagtargets" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_flagtargets.hifa_flagtargets">
<span class="sig-name descname"><span class="pre">hifa_flagtargets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetemplate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flagbackup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_flagtargets.html#hifa_flagtargets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_flagtargets.hifa_flagtargets" title="Link to this definition"></a></dt>
<dd><p>hifa_flagtargets —- Do science target flagging</p>
<p>The hifa_flagtargets task performs basic flagging operations on a list of
science target MeasurementSets, including:</p>
<ul class="simple">
<li><p>applying a flagging template</p></li>
</ul>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl class="simple">
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list
of MeasurementSets defined in the pipeline context.</p>
</dd>
<dt>template</dt><dd><p>Apply flagging templates; defaults to True.</p>
</dd>
<dt>filetemplate</dt><dd><p>The name of a text file that contains the flagging
template for issues with the science target data etc.
If the template flags files is undefined a name of the
form ‘msname_flagtargetstemplate.txt’ is assumed.</p>
</dd>
<dt>flagbackup</dt><dd><p>Back up any pre-existing flags; defaults to False.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Do basic flagging on a science target MeasurementSet:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_flagtargets</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_fluxcalflag">
<span id="pipeline-hifa-cli-hifa-fluxcalflag-module"></span><h2>pipeline.hifa.cli.hifa_fluxcalflag module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_fluxcalflag" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_fluxcalflag.hifa_fluxcalflag">
<span class="sig-name descname"><span class="pre">hifa_fluxcalflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">appendlines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linesfiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">applyflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_fluxcalflag.html#hifa_fluxcalflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_fluxcalflag.hifa_fluxcalflag" title="Link to this definition"></a></dt>
<dd><p>hifa_fluxcalflag —- Locate and flag line regions in solar system flux calibrators</p>
<p>Search the built-in solar system flux calibrator line catalog for overlaps with
the science spectral windows. Generate a list of line overlap regions and
flagging commands.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets defined in the pipeline context.</p>
</dd>
<dt>field</dt><dd><p>The list of field names or field ids for which the models are
to be set. Defaults to all fields with intent ‘AMPLITUDE’.</p>
<p>Example: field=’3C279’, field=’3C279, M82’</p>
</dd>
<dt>intent</dt><dd><p>A string containing a comma delimited list of intents against
which the selected fields are matched. Defaults to all data
with amplitude intent.</p>
<p>Example: intent=’AMPLITUDE’</p>
</dd>
<dt>spw</dt><dd><p>Spectral windows and channels for which bandpasses are
computed. Defaults to all science spectral windows.</p>
<p>Example: spw=’11,13,15,17’</p>
</dd>
<dt>threshold</dt><dd><p>If the fraction of a spectral window occupied by line regions
is greater than this threshold value, then flag the entire
spectral window.</p>
</dd>
<dt>appendlines</dt><dd><p>Append user defined line regions to the line dictionary.</p>
</dd>
<dt>linesfile</dt><dd><p>Read in a file containing lines regions and append it to the
builtin dictionary. Blank lines and comments beginning with #
are skipped. The data is contained in 4 whitespace delimited
fields containing the solar system object field name, e.g.
‘Callisto’, the molecular species name, e.g. ‘13CO’, and the
starting and ending frequency in GHz.</p>
</dd>
<dt>applyflags</dt><dd><p>Boolean for whether to apply the generated flag commands. (default True)</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Locate known lines in any solar system object flux calibrators:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_fluxcalflag</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_gaincalsnr">
<span id="pipeline-hifa-cli-hifa-gaincalsnr-module"></span><h2>pipeline.hifa.cli.hifa_gaincalsnr module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_gaincalsnr" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_gaincalsnr.hifa_gaincalsnr">
<span class="sig-name descname"><span class="pre">hifa_gaincalsnr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phasesnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bwedgefrac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_nantennas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxfracflagged</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_gaincalsnr.html#hifa_gaincalsnr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_gaincalsnr.hifa_gaincalsnr" title="Link to this definition"></a></dt>
<dd><p>hifa_gaincalsnr —- Compute gaincal signal-to-noise ratios per spw</p>
<p>The gaincal solution signal-to-noise is determined as follows:</p>
<ul class="simple">
<li><p>For each data set the list of source(s) to use for the per-scan gaincal
solution signal-to-noise estimation is compiled based on the values of the
field, intent, and spw parameters.</p></li>
<li><p>Source fluxes are determined for each spw and source combination.</p></li>
<li><p>Fluxes in Jy are derived from the pipeline context.</p></li>
<li><p>Pipeline context fluxes are derived from the online flux calibrator
catalog, the ASDM, or the user via the flux.csv file.</p></li>
<li><p>If no fluxes are available the task terminates.</p></li>
<li><p>Atmospheric calibration and observations scans are determined for each spw
and source combination.</p></li>
<li><p>If intent is set to ‘PHASE’ are there are no atmospheric scans associated
with the ‘PHASE’ calibrator, ‘TARGET’ atmospheric scans will be used
instead.</p></li>
<li><p>If atmospheric scans cannot be associated with any of the spw and source
combinations the task terminates.</p></li>
<li><p>Science spws are mapped to atmospheric spws for each science spw and
source combinations.</p></li>
<li><p>If mappings cannot be determined for any of the spws the task terminates.</p></li>
<li><p>The median Tsys value for each atmospheric spw and source combination is
determined from the SYSCAL table. Medians are computed first by channel,
then by antenna, in order to reduce sensitivity to deviant values.</p></li>
<li><p>The science spw parameters, exposure time(s), and integration time(s) are
determined.</p></li>
<li><p>The per scan sensitivity and signal-to-noise estimates are computed per
science spectral window. Nominal Tsys and sensitivity values per receiver
band provide by the ALMA project are used for this estimate.</p></li>
<li><p>The QA score is based on how many signal-to-noise estimates greater than
the requested signal-to-noise ratio can be computed.</p></li>
</ul>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘M82A.ms’, ‘M82B.ms’]</p>
</dd>
<dt>field</dt><dd><p>The list of field names of sources to be used for signal to noise
estimation. Defaults to all fields with the standard intent.</p>
<p>Example: field=’3C279’</p>
</dd>
<dt>intent</dt><dd><p>A string containing a comma delimited list of intents against which
the selected fields are matched. Defaults to ‘PHASE’.</p>
<p>Example: intent=’BANDPASS’</p>
</dd>
<dt>spw</dt><dd><p>The list of spectral windows and channels for which gain solutions are
computed. Defaults to all the science spectral windows for which there are
both ‘intent’ and TARGET intents.</p>
<p>Example: spw=’13,15’</p>
</dd>
<dt>phasesnr</dt><dd><p>The required gaincal solution signal to noise.</p>
<p>Example: phasesnr=20.0</p>
</dd>
<dt>bwedgefrac</dt><dd><p>The fraction of the bandwidth edges that is flagged.</p>
<p>Example: bwedgefrac=0.0</p>
</dd>
<dt>hm_nantennas</dt><dd><p>The heuristics for determines the number of antennas to use
in the signal to noise estimate. The options are ‘all’ and ‘unflagged’.
The ‘unflagged’ options is not currently supported.</p>
<p>Example: hm_nantennas=’unflagged’</p>
</dd>
<dt>maxfracflagged</dt><dd><p>The maximum fraction of an antenna that can be flagged
before it is excluded from the signal to noise estimate.</p>
<p>Example: maxfracflagged=0.80</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Estimate the per scan gaincal solution sensitivities and signal to noise
ratios for all the science spectral windows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_gaincalsnr</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_gfluxscale">
<span id="pipeline-hifa-cli-hifa-gfluxscale-module"></span><h2>pipeline.hifa.cli.hifa_gfluxscale module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_gfluxscale" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_gfluxscale.hifa_gfluxscale">
<span class="sig-name descname"><span class="pre">hifa_gfluxscale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transfer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refintent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transintent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refspwmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reffile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupsolint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_resolvecals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_outlier_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_gfluxscale.html#hifa_gfluxscale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_gfluxscale.hifa_gfluxscale" title="Link to this definition"></a></dt>
<dd><p>hifa_gfluxscale —- Derive flux density scales from standard calibrators</p>
<p>Derive flux densities for point source transfer calibrators using flux models
for reference calibrators.</p>
<p>Flux values are determined by:</p>
<ul class="simple">
<li><p>computing phase only solutions for all the science spectral windows
using the calibrator data selected by the <code class="docutils literal notranslate"><span class="pre">reference</span></code> and <code class="docutils literal notranslate"><span class="pre">refintent</span></code>
parameters and the <code class="docutils literal notranslate"><span class="pre">transfer</span></code> and <code class="docutils literal notranslate"><span class="pre">transintent</span></code> parameters, the value
of the <code class="docutils literal notranslate"><span class="pre">phaseupsolint</span></code> parameter, and any spw combination determined
in hifa_spwphaseup.</p></li>
<li><p>computing complex amplitude only solutions for all the science spectral
windows using calibrator data selected with <code class="docutils literal notranslate"><span class="pre">reference</span></code> and
<code class="docutils literal notranslate"><span class="pre">refintent</span></code> parameters and the <code class="docutils literal notranslate"><span class="pre">transfer</span></code> and <code class="docutils literal notranslate"><span class="pre">transintent</span></code>
parameters, the value of the <code class="docutils literal notranslate"><span class="pre">solint</span></code> parameter.</p></li>
<li><p>examining the amplitude-only solutions for obvious outliers and flagging
them in the caltable.</p></li>
<li><p>transferring the flux scale from the reference calibrators to the transfer
calibrators using <code class="docutils literal notranslate"><span class="pre">refspwmap</span></code> for windows without data in the reference
calibrators.</p></li>
<li><p>inserting the computed flux density values into the MODEL_DATA column.</p></li>
</ul>
<p>Resolved calibrators are handled via antenna selection either automatically
(<code class="docutils literal notranslate"><span class="pre">hm_resolvedcals</span></code> = ‘automatic’) or manually (<code class="docutils literal notranslate"><span class="pre">hm_resolvedcals</span></code> =
‘manual’). In the former case, antennas closer to the reference antenna than
the uv distance where visibilities fall to <code class="docutils literal notranslate"><span class="pre">peak_fraction</span></code> of the peak are
used. In manual mode, the antennas specified in <code class="docutils literal notranslate"><span class="pre">antenna</span></code> are used.</p>
<p>Note that the flux corrected calibration table computed internally is
not currently used in later pipeline apply calibration steps.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: [‘M32A.ms’, ‘M32B.ms’]</p>
</dd>
<dt>reference</dt><dd><p>A string containing a comma delimited list of field names
defining the reference calibrators. Defaults to field names with
intent ‘<cite>*AMP*</cite>’.</p>
<p>Example: reference=’M82,3C273’</p>
</dd>
<dt>transfer</dt><dd><p>A string containing a comma delimited list of field names
defining the transfer calibrators. Defaults to field names with
intent ‘<cite>*PHASE*</cite>’.</p>
<p>Example: transfer=’J1328+041,J1206+30’</p>
</dd>
<dt>refintent</dt><dd><p>A string containing a comma delimited list of intents
used to select the reference calibrators. Defaults to ‘AMPLITUDE’.</p>
<p>Example: refintent=’’, refintent=’AMPLITUDE’</p>
</dd>
<dt>transintent</dt><dd><p>A string containing a comma delimited list of intents
defining the transfer calibrators. Defaults to
‘PHASE,BANDPASS,CHECK,POLARIZATION,POLANGLE,POLLEAKAGE’.</p>
<p>Example: transintent=’’, transintent=’PHASE,BANDPASS’</p>
</dd>
<dt>refspwmap</dt><dd><p>Vector of spectral window ids enabling scaling across
spectral windows. Defaults to no scaling.</p>
<p>Example: refspwmap=[1,1,3,3] - (4 spws, reference fields in 1 and 3, transfer
fields in 0,1,2,3</p>
</dd>
<dt>reffile</dt><dd><p>Path to a file containing flux densities for calibrators.
Setjy will be run for any that have both reference and transfer intents.
Values given in this file will take precedence over MODEL column values
set by previous tasks. By default, the path is set to the CSV file created
by hifa_importdata, consisting of catalogue fluxes extracted from the ASDM
and / or edited by the user.</p>
<p>example: reffile=’’, reffile=’working/flux.csv’</p>
</dd>
<dt>phaseupsolint</dt><dd><p>Time solution intervals in CASA syntax for the phase solution.</p>
<p>example: phaseupsolint=’inf’, phaseupsolint=’int’, phaseupsolint=’100sec’</p>
</dd>
<dt>solint</dt><dd><p>Time solution intervals in CASA syntax for the amplitude solution.</p>
<p>example: solint=’inf’, solint=’int’, solint=’100sec’</p>
</dd>
<dt>minsnr</dt><dd><p>Minimum signal-to-noise ratio for gain calibration solutions.</p>
<p>example: minsnr=1.5, minsnr=0.0</p>
</dd>
<dt>refant</dt><dd><p>A string specifying the reference antenna(s). By default,
this is read from the context.</p>
<p>Example: refant=’DV05’</p>
</dd>
<dt>hm_resolvedcals</dt><dd><p>Heuristics method for handling resolved calibrators. The
options are ‘automatic’ and ‘manual’. In automatic mode,
antennas closer to the reference antenna than the uv
distance where visibilities fall to <code class="docutils literal notranslate"><span class="pre">peak_fraction</span></code> of the
peak are used. In manual mode, the antennas specified in
<code class="docutils literal notranslate"><span class="pre">antenna</span></code> are used.</p>
</dd>
<dt>antenna</dt><dd><p>A comma delimited string specifying the antenna names or ids
to be used for the fluxscale determination. Used in
<code class="docutils literal notranslate"><span class="pre">hm_resolvedcals</span></code> = ‘manual’ mode.</p>
<p>Example: antenna=’DV16,DV07,DA12,DA08’</p>
</dd>
<dt>peak_fraction</dt><dd><p>The limiting UV distance from the reference antenna for
antennas to be included in the flux calibration. Defined as
the point where the calibrator visibilities have fallen to
<code class="docutils literal notranslate"><span class="pre">peak_fraction</span></code> of the peak value.</p>
</dd>
<dt>amp_outlier_sigma</dt><dd><p>Sigma threshold used to identify outliers in the amplitude
caltable. Default: 50.0</p>
<p>Example: amp_outlier_sigma=30.0</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Compute flux values for the phase calibrator using model data from
the amplitude calibrator:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_gfluxscale</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_gfluxscaleflag">
<span id="pipeline-hifa-cli-hifa-gfluxscaleflag-module"></span><h2>pipeline.hifa.cli.hifa_gfluxscaleflag module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_gfluxscaleflag" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_gfluxscaleflag.hifa_gfluxscaleflag">
<span class="sig-name descname"><span class="pre">hifa_gfluxscaleflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupsolint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antnegsig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antpossig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmantint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antblnegsig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antblpossig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relaxed_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_gfluxscaleflag.html#hifa_gfluxscaleflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_gfluxscaleflag.hifa_gfluxscaleflag" title="Link to this definition"></a></dt>
<dd><p>hifa_gfluxscaleflag —- Flag the flux, diffgain, phase calibrators and check source</p>
<p>This task computes the flagging heuristics on the flux, diffgain, and phase
calibrators and the check source, by calling hif_correctedampflag which
looks for outlier visibility points by statistically examining the scalar
difference of corrected amplitudes minus model amplitudes, and flags those
outliers. The philosophy is that only outlier data points that have remained
outliers after calibration will be flagged. The heuristic works equally well
on resolved calibrators and point sources because it is not performing a
vector difference, and thus is not sensitive to nulls in the flux density
vs. uvdistance domain. Note that the phase of the data is not assessed.</p>
<p>In further detail, the workflow is as follows: a snapshot of the flagging
state is preserved at the start, a preliminary phase and amplitude gaincal
solution is solved and applied, the flagging heuristics are run and
any outliers are marked for flagging, the flagging state is restored from the
snapshot. If any outliers were found, then these are flagged. Plots are
generated at two points in this workflow: after preliminary phase and
amplitude calibration but before flagging heuristics are run, and after
flagging heuristics have been run and applied. If no points were flagged,
the ‘after’ plots are not generated or displayed. The score for this stage
is the standard data flagging score, which depends on the fraction of data
flagged.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘M51.ms’]</p>
</dd>
<dt>intent</dt><dd><p>A string containing a comma delimited list of intents against
which the selected fields are matched. If undefined (default), it
will select all data with the AMPLITUDE, PHASE, and CHECK intents,
except for one case: if one of the AMPLITUDE intent fields was also
used for BANDPASS, then this task will select only data with PHASE
and CHECK intents.</p>
<p>Example: intent=’<cite>*PHASE*</cite>’</p>
</dd>
<dt>phaseupsolint</dt><dd><p>The phase correction solution interval in CASA syntax.</p>
<p>Example: phaseupsolint=’300s’</p>
</dd>
<dt>solint</dt><dd><p>Time and channel solution intervals in CASA syntax.</p>
<p>Example: solint=’inf,10ch’, solint=’inf’</p>
</dd>
<dt>minsnr</dt><dd><p>Solutions below this SNR are rejected.</p>
</dd>
<dt>refant</dt><dd><p>Reference antenna names. Defaults to the value(s) stored in the
pipeline context. If undefined in the pipeline context defaults to
the CASA reference antenna naming scheme.</p>
<p>Example: refant=’DV01’, refant=’DV06,DV07’</p>
</dd>
<dt>antnegsig</dt><dd><p>Lower sigma threshold for identifying outliers as a result of
bad antennas within individual timestamps.</p>
<p>Example: antnegsig=4.0</p>
</dd>
<dt>antpossig</dt><dd><p>Upper sigma threshold for identifying outliers as a result of
bad antennas within individual timestamps.</p>
<p>Example: antpossig=4.6</p>
</dd>
<dt>tmantint</dt><dd><p>Threshold for maximum fraction of timestamps that are allowed to
contain outliers.</p>
<p>Example: tmantint=0.063</p>
</dd>
<dt>tmint</dt><dd><p>Threshold for maximum fraction of “outlier timestamps” over
“total timestamps” that a baseline may be a part of.</p>
<p>Example: tmint=0.085</p>
</dd>
<dt>tmbl</dt><dd><p>Initial threshold for maximum fraction of “bad baselines” over “all
baselines” that an antenna may be a part of.</p>
<p>Example: tmbl=0.175</p>
</dd>
<dt>antblnegsig</dt><dd><p>Lower sigma threshold for identifying outliers as a result of
“bad baselines” and/or “bad antennas” within baselines, across all
timestamps.</p>
<p>Example: antblnegsig=3.4</p>
</dd>
<dt>antblpossig</dt><dd><p>Threshold for identifying outliers as a result of
“bad baselines” and/or “bad antennas” within baselines, across all
timestamps.</p>
<p>Example: antblpossig=3.2</p>
</dd>
<dt>relaxed_factor</dt><dd><p>Relaxed value to set the threshold scaling factor to under
certain conditions (see task description).</p>
<p>Example: relaxed_factor=2.0</p>
</dd>
<dt>niter</dt><dd><p>Maximum number of times to iterate on evaluation of flagging
heuristics. If an iteration results in no new flags, then subsequent
iterations are skipped.</p>
<p>Example: niter=2</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. run with recommended settings to create flux scale calibration with flagging
using recommended thresholds:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_gfluxscaleflag</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_imageprecheck">
<span id="pipeline-hifa-cli-hifa-imageprecheck-module"></span><h2>pipeline.hifa.cli.hifa_imageprecheck module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_imageprecheck" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_imageprecheck.hifa_imageprecheck">
<span class="sig-name descname"><span class="pre">hifa_imageprecheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired_angular_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calcsb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_imageprecheck.html#hifa_imageprecheck"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_imageprecheck.hifa_imageprecheck" title="Link to this definition"></a></dt>
<dd><p>hifa_imageprecheck —- Calculates the best Briggs robust parameter to achieve sensitivity and angular resolution goals.</p>
<p>In this task, the representative source and the spw containing the representative
frequency selected by the PI in the OT are used to calculate the synthesized beam
and to make sensitivity estimates for the aggregate bandwidth and representative
bandwidth for several values of the Briggs robust parameter. This information is
reported in a table in the weblog. If no representative target/frequency information
is available, it defaults to the first target and center of first spw in the data
(e.g. pre-Cycle 5 data does not have this information available). The best Briggs
robust parameter to achieve the PI’s desired angular resolution is chosen
automatically. See the User’s guide for further details.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl class="simple">
<dt>vis                              The list of input MeasurementSets. Defaults to the list of</dt><dd><p>MeasurementSets specified in the h_init or hif_importdata task.
‘’: use all MeasurementSets in the context
Examples: ‘ngc5921.ms’, [‘ngc5921a.ms’, ngc5921b.ms’, ‘ngc5921c.ms’]</p>
</dd>
<dt>desired_angular_resolution       User specified angular resolution goal string. When this</dt><dd><p>parameter is set, uvtapering may be performed.
‘’: automatic from performance parameters (default)
Example: ‘1.0arcsec’</p>
</dd>
</dl>
<p>calcsb                           Force (re-)calculation of sensitivities and beams; defaults to False
parallel                         Use MPI cluster where possible</p>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>run with recommended settings to perform checks prior to imaging:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_imageprecheck</span><span class="p">()</span>
</pre></div>
</div>
<p>2. run to perform checks prior to imaging and force the re-calculation of
sensitivities and beams:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_imageprecheck</span><span class="p">(</span><span class="n">calcsb</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_importdata">
<span id="pipeline-hifa-cli-hifa-importdata-module"></span><h2>pipeline.hifa.cli.hifa_importdata module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_importdata" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_importdata.hifa_importdata">
<span class="sig-name descname"><span class="pre">hifa_importdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_caldevice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bdfflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datacolumns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dbservice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ocorr_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">createmms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minparang</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_importdata.html#hifa_importdata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_importdata.hifa_importdata" title="Link to this definition"></a></dt>
<dd><p>hifa_importdata —- Imports data into the interferometry pipeline</p>
<p>The hifa_importdata task loads the specified visibility data into the pipeline
context unpacking and / or converting it as necessary.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> input parameter is set to False and the task is asked
to convert an input ASDM input to an MS, then when the output MS already
exists in the output directory, the importasdm conversion step is skipped,
and the existing MS will be imported instead.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of visibility data files. These may be ASDMs, tar
files of ASDMs, MSes, or tar files of MSes. If ASDM files
are specified, they will be converted to MS format.</p>
<p>Example: vis=[‘X227.ms’, ‘asdms.tar.gz’]</p>
</dd>
<dt>session</dt><dd><p>List of session names, one for each visibility dataset,
used to group the MSes into sessions.</p>
<p>Example: session=[‘session_1’, ‘session_2’]</p>
</dd>
<dt>asis</dt><dd><p>Creates verbatim copies of the ASDM tables in the output MS.
The value given to this option must be a list of table names
separated by space characters.</p>
</dd>
<dt>process_caldevice</dt><dd><p>Import the caldevice table from the ASDM.</p>
</dd>
<dt>overwrite</dt><dd><p>Overwrite existing files on import; defaults to False.
When converting ASDM to MS, if overwrite=False and the MS
already exists in the output directory, then this existing
MS dataset will be used instead.</p>
<p>Example: overwrite=True</p>
</dd>
<dt>nocopy</dt><dd><p>Disable copying of MS to working directory; defaults to
False.</p>
<p>Example: nocopy=True</p>
</dd>
<dt>bdfflags</dt><dd><p>Apply BDF flags on import.</p>
</dd>
<dt>datacolumns</dt><dd><p>Dictionary defining the data types of existing columns.
The format is:</p>
<p>{‘data’: ‘data type 1’}</p>
<p>or</p>
<p>{‘data’: ‘data type 1’, ‘corrected’: ‘data type 2’}</p>
<p>For ASDMs the data type can only be RAW and one
can only specify it for the data column.</p>
<p>For MSes one can define two different data types
for the DATA and CORRECTED_DATA columns and they
can be any of the known data types (RAW,
REGCAL_CONTLINE_ALL, REGCAL_CONTLINE_SCIENCE,
SELFCAL_CONTLINE_SCIENCE, REGCAL_LINE_SCIENCE,
SELFCAL_LINE_SCIENCE, BASELINED, ATMCORR). The
intent selection strings _ALL or _SCIENCE can be
skipped. In that case the task determines this
automatically by inspecting the existing intents
in the dataset.</p>
<p>Usually, a single datacolumns dictionary is used
for all datasets. If necessary, one can define a
list of dictionaries, one for each EB, with
different setups per EB.</p>
<p>If no types are specified,
{‘data’:’raw’,’corrected’:’regcal_contline’}
or {‘data’:’raw’} will be assumed, depending on
whether the corrected column exists or not.</p>
</dd>
<dt>lazy</dt><dd><p>Use the lazy filler import.</p>
</dd>
<dt>dbservice</dt><dd><p>Use the online flux catalog.</p>
</dd>
<dt>ocorr_mode</dt><dd><p>ALMA default set to ca.</p>
</dd>
<dt>createmms</dt><dd><p>Create an MMS.</p>
</dd>
<dt>minparang</dt><dd><p>Minimum required parallactic angle range for polarisation
calibrator, in degrees. The default of 0.0 is used for
non-polarisation processing.</p>
</dd>
<dt>parallel</dt><dd><p>Execute using CASA HPC functionality, if available.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Load an ASDM list in the ../rawdata subdirectory into the context:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_importdata</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;../rawdata/uid___A002_X30a93d_X43e&#39;</span><span class="p">,</span> <span class="s1">&#39;../rawdata/uid_A002_x30a93d_X44e&#39;</span><span class="p">])</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Load an MS in the current directory into the context:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_importdata</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;uid___A002_X30a93d_X43e.ms&#39;</span><span class="p">])</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Load a tarred ASDM in ../rawdata into the context:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_importdata</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;../rawdata/uid___A002_X30a93d_X43e.tar.gz&#39;</span><span class="p">])</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Import a list of MeasurementSets:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">myvislist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;uid___A002_X30a93d_X43e.ms&#39;</span><span class="p">,</span> <span class="s1">&#39;uid_A002_x30a93d_X44e.ms&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_importdata</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="n">myvislist</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Run with explicit setting of data column types:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_importdata</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;uid___A002_X30a93d_X43e_targets.ms&#39;</span><span class="p">],</span> <span class="n">datacolumns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;regcal_contline&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_importdata</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;uid___A002_X30a93d_X43e_targets_line.ms&#39;</span><span class="p">],</span> <span class="n">datacolumns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;regcal_line&#39;</span><span class="p">,</span> <span class="s1">&#39;corrected&#39;</span><span class="p">:</span> <span class="s1">&#39;selfcal_line&#39;</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_lock_refant">
<span id="pipeline-hifa-cli-hifa-lock-refant-module"></span><h2>pipeline.hifa.cli.hifa_lock_refant module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_lock_refant" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_lock_refant.hifa_lock_refant">
<span class="sig-name descname"><span class="pre">hifa_lock_refant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_lock_refant.html#hifa_lock_refant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_lock_refant.hifa_lock_refant" title="Link to this definition"></a></dt>
<dd><p>hifa_lock_refant —- Lock reference antenna list</p>
<p>hifa_lock_refant marks the reference antenna list as “locked” for specified
measurement sets, preventing modification of the refant list by subsequent
tasks.</p>
<p>After executing hifa_lock_refant, all subsequent gaincal calls will by
default be executed with refantmode=’strict’.</p>
<p>The refant list can be unlocked with the hifa_unlock_refant task.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Lock the refant list for all MSes in pipeline context:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_lock_refant</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_polcal">
<span id="pipeline-hifa-cli-hifa-polcal-module"></span><h2>pipeline.hifa.cli.hifa_polcal module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_polcal" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_polcal.hifa_polcal">
<span class="sig-name descname"><span class="pre">hifa_polcal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minpacov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solint_chavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_polcal.html#hifa_polcal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_polcal.hifa_polcal" title="Link to this definition"></a></dt>
<dd><p>hifa_polcal —- Derive instrumental polarization calibration for ALMA.</p>
<p>Derive the instrumental polarization calibrations for ALMA using the
polarization calibrators.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: [‘M32A.ms’, ‘M32B.ms’]</p>
</dd>
<dt>minpacov</dt><dd><p>Minimum Parallactic Angle Coverage (degrees) required for
Q, U estimation in task polfromgain. This enables avoiding
pathological cases of antennas with insufficient parallactic
angle coverage which can yield spurious source polarization
solutions or cause polfromgain to fail to find any
solutions.</p>
<p>Default: 30.0</p>
</dd>
<dt>solint_chavg</dt><dd><p>Channel averaging to include in solint for gaincal steps
producing cross-hand delay, cross-hand phase, and leakage
(D-terms) solutions.</p>
<p>Default: ‘5MHz’</p>
</dd>
<dt>vs_stats</dt><dd><p>List of visstat statistics to use for diagnostic comparison
between the concatenated session MS and individual MSes in
that session after applying polarization calibration tables.</p>
<p>Default: [‘min’,’max’,’mean’]</p>
</dd>
<dt>vs_thresh</dt><dd><p>Threshold to use in diagnostic comparison of visstat
statistics; relative differences larger than this threshold
are reported in the CASA log.</p>
<p>Default: 1e-3</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Compute the polarization calibrations:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_polcal</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_polcalflag">
<span id="pipeline-hifa-cli-hifa-polcalflag-module"></span><h2>pipeline.hifa.cli.hifa_polcalflag module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_polcalflag" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_polcalflag.hifa_polcalflag">
<span class="sig-name descname"><span class="pre">hifa_polcalflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_polcalflag.html#hifa_polcalflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_polcalflag.hifa_polcalflag" title="Link to this definition"></a></dt>
<dd><p>hifa_polcalflag —- Flag polarization calibrators</p>
<p>This task flags corrected visibility outliers in the polarization calibrator
data using the hif_correctedampflag heuristics.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the h_init or hif_importdata task.
‘’: use all MeasurementSets in the context</p>
<p>Examples: ‘ngc5921.ms’, [‘ngc5921a.ms’, ngc5921b.ms’, ‘ngc5921c.ms’]</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Run with recommended settings to flag visibility outliers in the
polarization calibrator data:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_polcalflag</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_renorm">
<span id="pipeline-hifa-cli-hifa-renorm-module"></span><h2>pipeline.hifa.cli.hifa_renorm module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_renorm" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_renorm.hifa_renorm">
<span class="sig-name descname"><span class="pre">hifa_renorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">createcaltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excludechan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atm_auto_exclude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bwthreshspw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_renorm.html#hifa_renorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_renorm.hifa_renorm" title="Link to this definition"></a></dt>
<dd><p>hifa_renorm —- ALMA renormalization task</p>
<p>This task makes an assessment, and optionally applies a correction, to data
suffering from incorrect amplitude normalization caused by bright
astronomical lines detected in the autocorrelations of some target sources.</p>
<p>For a full description of the effects of bright emission lines and the
correction heuristics used in this task, please see the Pipeline User Guide.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
<dt>createcaltable</dt><dd><p>Boolean to select whether to create the renormalization
correction cal table (True), or only run the assessment
(False, default).</p>
<p>Example: createcaltable=True</p>
</dd>
<dt>threshold</dt><dd><p>Apply correction if max correction is above this threshold
value and <code class="docutils literal notranslate"><span class="pre">apply</span></code> = True. Default is 1.02 (i.e. 2%).</p>
<p>Example: threshold=1.02</p>
</dd>
<dt>spw</dt><dd><p>The list of real (not virtual - i.e. the actual spwIDs in
the MS) spectral windows to evaluate.</p>
<p>Set to spw=’’ by default, which means the task will select
all relevant (science FDM) spectral windows.</p>
<p>Note that for data with multiple MSs, a list with the
correct spectral window selection for each MS can be
provided.</p>
<p>Examples:</p>
<p>spw=”11,13,15,17”</p>
<p>spw=[“11,13,15,17”, “5,7,11,13”]</p>
</dd>
<dt>excludechan</dt><dd><p>Channels to exclude in either channel or frequency space
(TOPO, GHz), specifying the real (not virtual) spectral
window per selection.</p>
<p>Note that for data with multiple MSs, a list of
dictionaries with the correct selection for each MS can be
provided.</p>
<p>Examples:</p>
<p>excludechan={‘22’:’100~150;800~850’, ‘24’:’100~200’}</p>
<p>excludechan={‘22’:’230.1GHz~230.2GHz’}</p>
<p>excludechan=[{‘22’:’100~150’}, {‘15’:’100~150’}]</p>
</dd>
<dt>atm_auto_exclude</dt><dd><p>Automatically find and exclude regions with atmospheric
features. Default is False</p>
</dd>
<dt>bwthreshspw</dt><dd><p>Bandwidth beyond which a SPW is split into chunks to fit
separately. The default value for all SPWs is 120e6, and
this parameter allows one to override it for specific SPWs,
due to needing potentially various ‘nsegments’ when EBs
have very different SPW bandwidths.</p>
<p>Example: bwthreshspw={‘16: 64e6, ‘22: 64e6}</p>
</dd>
<dt>parallel</dt><dd><p>Execute using CASA HPC functionality, if available.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Run with recommended settings to assess the need for an ALMA amplitude
renormalization correction.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_renorm</span><span class="p">()</span>
</pre></div>
</div>
<p>2. Run to assess the necessary ALMA amplitude renormalization correction,
and apply this correction if it exceeds a threshold of 3% (1.03).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_renorm</span><span class="p">(</span><span class="n">createcaltable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">1.03</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_restoredata">
<span id="pipeline-hifa-cli-hifa-restoredata-module"></span><h2>pipeline.hifa.cli.hifa_restoredata module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_restoredata" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_restoredata.hifa_restoredata">
<span class="sig-name descname"><span class="pre">hifa_restoredata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">products_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copytoraw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawdata_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bdfflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ocorr_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_restoredata.html#hifa_restoredata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_restoredata.hifa_restoredata" title="Link to this definition"></a></dt>
<dd><p>hifa_restoredata —- Restore flagged and calibration interferometry data from a pipeline run</p>
<p>The hifa_restoredata task restores flagged and calibrated MeasurementSets
from archived ASDMs and pipeline flagging and calibration data products.</p>
<p>hifa_restoredata assumes that the ASDMs to be restored are present in the
directory specified by the <code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code> (default: ‘../rawdata’).</p>
<p>By default (<code class="docutils literal notranslate"><span class="pre">copytoraw</span></code> = True), hifa_restoredata assumes that for each
ASDM in the input list, the corresponding pipeline flagging and calibration
data products (in the format produced by the hifa_exportdata task) are
present in the directory specified by <code class="docutils literal notranslate"><span class="pre">products_dir</span></code> (default: ‘../products’).
At the start of the task, these products are copied from the <code class="docutils literal notranslate"><span class="pre">products_dir</span></code>
to the <code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">copytoraw</span></code> = False, hifa_restoredata assumes that these products are
to be found in <code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code> along with the ASDMs.</p>
<p>The expected flagging and calibration products (for each ASDM) include:</p>
<blockquote>
<div><ul class="simple">
<li><p>a compressed tar file of the final flagversions file, e.g.
uid___A002_X30a93d_X43e.ms.flagversions.tar.gz</p></li>
<li><p>a text file containing the applycal instructions, e.g.
uid___A002_X30a93d_X43e.ms.calapply.txt</p></li>
<li><p>a compressed tar file containing the caltables for the parent session,
e.g. uid___A001_X74_X29.session_3.caltables.tar.gz</p></li>
</ul>
</div></blockquote>
<p>hifa_restoredata performs the following operations:</p>
<ul class="simple">
<li><p>imports the ASDM(s)</p></li>
<li><p>removes the default MS.flagversions directory created by the filler</p></li>
<li><p>restores the final MS.flagversions directory stored by the pipeline</p></li>
<li><p>restores the final set of pipeline flags to the MS</p></li>
<li><p>restores the final calibration state of the MS</p></li>
<li><p>restores the final calibration tables for each MS</p></li>
<li><p>applies the calibration tables to each MS</p></li>
</ul>
<p>When importing the ASDM and converting it to a Measurement Set (MS), if the
output MS already exists in the output directory, then the importasdm
conversion step is skipped, and instead the existing MS will be imported.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of raw visibility data files to be restored.
Assumed to be in the directory specified by rawdata_dir.</p>
<p>Example: vis=[‘uid___A002_X30a93d_X43e’]</p>
</dd>
<dt>session</dt><dd><p>List of sessions one per visibility file.</p>
<p>Example: session=[‘session_3’]</p>
</dd>
<dt>products_dir</dt><dd><p>Name of the data products directory to copy calibration
products from.
Default: ‘../products’</p>
<p>The parameter is effective only when <code class="docutils literal notranslate"><span class="pre">copytoraw</span></code> = True.
When <code class="docutils literal notranslate"><span class="pre">copytoraw</span></code> = False, calibration products in
<code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code> will be used.</p>
<p>Example: products_dir=’myproductspath’</p>
</dd>
<dt>copytoraw</dt><dd><p>Copy calibration and flagging tables from <code class="docutils literal notranslate"><span class="pre">products_dir</span></code> to
<code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code> directory.
Default: True</p>
<p>Example: copytoraw=False</p>
</dd>
<dt>rawdata_dir</dt><dd><p>Name of the raw data directory.
Default: ‘../rawdata’</p>
<p>Example: rawdata_dir=’myrawdatapath’</p>
</dd>
<dt>lazy</dt><dd><p>Use the lazy filler option.
Default: False</p>
<p>Example: lazy=True</p>
</dd>
<dt>bdfflags</dt><dd><p>Set the BDF flags.
Default: True</p>
<p>Example: bdfflags=False</p>
</dd>
<dt>ocorr_mode</dt><dd><p>Set ocorr_mode.
Default: ‘ca’</p>
<p>Example: ocorr_mode=’ca’</p>
</dd>
<dt>asis</dt><dd><p>Creates verbatim copies of the ASDM tables in the output MS.
The value given to this option must be a string containing a
list of table names separated by whitespace characters.
Default: ‘SBSummary ExecBlock Antenna Annotation Station Receiver Source CalAtmosphere CalWVR CalPointing’</p>
<p>Example: asis=’Source Receiver’</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Restore the pipeline results for a single ASDM in a single session:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_restoredata</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;uid___A002_X30a93d_X43e&#39;</span><span class="p">],</span> <span class="n">session</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;session_1&#39;</span><span class="p">],</span> <span class="n">ocorr_mode</span><span class="o">=</span><span class="s1">&#39;ca&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_session_refant">
<span id="pipeline-hifa-cli-hifa-session-refant-module"></span><h2>pipeline.hifa.cli.hifa_session_refant module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_session_refant" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_session_refant.hifa_session_refant">
<span class="sig-name descname"><span class="pre">hifa_session_refant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_session_refant.html#hifa_session_refant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_session_refant.hifa_session_refant" title="Link to this definition"></a></dt>
<dd><p>hifa_session_refant —- Select best reference antenna for session(s)</p>
<p>This task re-evaluates the reference antenna lists from all measurement sets
within a session and combines these to select a single common reference
antenna (per session) that is to be used by any subsequent pipeline stages.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
<dt>phase_threshold</dt><dd><p>Threshold (in degrees) used to identify absolute phase
solution outliers in caltables.</p>
<p>Example: phase_threshold=0.005</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Compute a single common reference antenna per session:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_session_refant</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_spwphaseup">
<span id="pipeline-hifa-cli-hifa-spwphaseup-module"></span><h2>pipeline.hifa.cli.hifa_spwphaseup module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_spwphaseup" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_spwphaseup.hifa_spwphaseup">
<span class="sig-name descname"><span class="pre">hifa_spwphaseup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_spwmapmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxnarrowbw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minfracmaxbw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samebb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phasesnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bwedgefrac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_nantennas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxfracflagged</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minblperant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unregister_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_spwphaseup.html#hifa_spwphaseup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_spwphaseup.hifa_spwphaseup" title="Link to this definition"></a></dt>
<dd><p>hifa_spwphaseup —- Compute phase calibration spw map and per spw phase offsets</p>
<p>The spw map for phase calibration is computed. Phase offsets as a function of
spectral window are computed using high signal-to-noise calibration observations.</p>
<p>Previous calibrations are applied on the fly.</p>
<p>hifa_spwphaseup performs two functions:</p>
<ul class="simple">
<li><p>Determines the spectral window mapping or combination mode, for each phase
and check source, to use when solving for phase as a function of time
(gfluxscale and timegaincal), and when applying those solutions to
targets.</p></li>
<li><p>Computes the per-spectral-window phase offset table that will be applied
to the data to remove mean phase differences between the spectral windows.</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">hm_spwmapmode</span></code> = ‘auto’, then the spectral window map is computed for
each SpectralSpec and each source with phase or check intent, using the
following algorithm:</p>
<ul class="simple">
<li><p>Estimate the per-spectral-window (spw) per-scan signal-to-noise ratio for
each phase and check source based on catalog flux densities, Tsys, number
of antennas, and integration scan time.</p></li>
<li><p>If the signal-to-noise of all spws is greater than <code class="docutils literal notranslate"><span class="pre">phasesnr</span></code>, then
<code class="docutils literal notranslate"><span class="pre">hm_spwmapmode</span></code> = ‘default’ mapping is used in which each spw is used
to calibrate itself.</p></li>
<li><p>If the signal-to-noise of only some spws are greater than the value of
<code class="docutils literal notranslate"><span class="pre">phasesnr</span></code>, then each lower-SNR spw is mapped to the highest SNR spw
in the same SpectralSpec.</p></li>
<li><p>If all spws have low SNR, or SNR cannot be computed for any reason (for
example, there is no flux information), then <code class="docutils literal notranslate"><span class="pre">hm_spwmapmode</span></code> = ‘combine’.</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">hm_spwmapmode</span></code> = ‘combine’, hifa_spwphaseup maps all the science windows
to a single science spectral window. For example, if the list of science
spectral windows is [9, 11, 13, 15] then all the science spectral windows
in the data will be combined and mapped to the science window 9 in the
combined phase vs time calibration table.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">hm_spwmapmode</span></code> = ‘simple’, a mapping from narrow science to wider
science spectral windows is computed using the following algorithm:</p>
<ul class="simple">
<li><p>Construct a list of the bandwidths of all the science spectral windows.</p></li>
<li><p>Determine the maximum bandwidth in this list as ‘maxbandwidth’</p></li>
<li><p>For each science spectral window with bandwidth less than ‘maxbandwidth’
construct a list of spectral windows with bandwidths greater than
<code class="docutils literal notranslate"><span class="pre">minfracmaxbw</span></code> * ‘maxbandwidth’, then select the spectral window in this
list whose band center most closely matches the band center of the narrow
spectral window, and preferentially match within the same baseband if
<code class="docutils literal notranslate"><span class="pre">samebb</span></code> = True.</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">hm_spwmapmode</span></code> = ‘default’ the spw mapping is assumed to be one to one.</p>
<p>Phase offsets per spectral window are determined by computing a phase only gain
calibration on the selected data, normally the high signal-to-noise bandpass
calibrator observations, using the solution interval ‘inf’.</p>
<p>At the end of the task the spectral window map and the phase offset calibration
table in the pipeline are stored in the context for use by later tasks.</p>
<p>Finally, the SNR of the calibration solutions are inspected and if the median value
on a per-spw basis does not reach specific thresholds, then issue a warning and reduced
QA score, with thresholds at <code class="docutils literal notranslate"><span class="pre">phasesnr</span></code> <a href="#id3"><span class="problematic" id="id4">*</span></a>0.75 (blue), <a href="#id5"><span class="problematic" id="id6">*</span></a>0.5 (yellow) and <a href="#id7"><span class="problematic" id="id8">*</span></a>0.33 (red).</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘M82A.ms’, ‘M82B.ms’]</p>
</dd>
<dt>caltable</dt><dd><p>The list of output calibration tables. Defaults to the standard
pipeline naming convention.</p>
<p>Example: caltable=[‘M82.gcal’, ‘M82B.gcal’]</p>
</dd>
<dt>field</dt><dd><p>The list of field names or field ids for which phase offset solutions
are to be computed. Defaults to all fields with the default intent.</p>
<p>Example: field=’3C279’, field=’3C279, M82’</p>
</dd>
<dt>intent</dt><dd><p>A string containing a comma delimited list of intents against
which the selected fields are matched. Defaults to the BANDPASS
observations.</p>
<p>Example: intent=’PHASE’</p>
</dd>
<dt>spw</dt><dd><p>The list of spectral windows and channels for which gain solutions are
computed. Defaults to all the science spectral windows.</p>
<p>Example: spw=’13,15’</p>
</dd>
<dt>hm_spwmapmode</dt><dd><p>The spectral window mapping mode. The options are: ‘auto’,
‘combine’, ‘simple’, and ‘default’. In ‘auto’ mode hifa_spwphaseup
estimates the SNR of the phase calibrator observations and uses these
estimates to choose between ‘combine’ mode (low SNR) and ‘default’ mode
(high SNR). In combine mode all spectral windows are combined and mapped to
one spectral window. In ‘simple’ mode narrow spectral windows are mapped to
wider ones using an algorithm defined by ‘maxnarrowbw’, ‘minfracmaxbw’, and
‘samebb’. In ‘default’ mode the spectral window map defaults to the
standard one to one mapping.</p>
<p>Example: hm_spwmapmode=’combine’</p>
</dd>
<dt>maxnarrowbw</dt><dd><p>The maximum bandwidth defining narrow spectral windows. Values
must be in CASA compatible frequency units.</p>
<p>Example: maxnarrowbw=’’</p>
</dd>
<dt>minfracmaxbw</dt><dd><p>The minimum fraction of the maximum bandwidth in the set of
spws to use for matching.</p>
<p>Example: minfracmaxbw=0.75</p>
</dd>
<dt>samebb</dt><dd><p>Match within the same baseband if possible.</p>
<p>Example: samebb=False</p>
</dd>
<dt>phasesnr</dt><dd><p>The required gaincal solution signal-to-noise.</p>
<p>Example: phaseupsnr=20.0</p>
</dd>
<dt>bwedgefrac</dt><dd><p>The fraction of the bandwidth edges that is flagged.</p>
<p>Example: bwedgefrac=0.0</p>
</dd>
<dt>hm_nantennas</dt><dd><p>The heuristics for determines the number of antennas to use
in the signal-to-noise estimate. The options are ‘all’ and ‘unflagged’.
The ‘unflagged’ options is not currently supported.</p>
<p>Example: hm_nantennas=’unflagged’</p>
</dd>
<dt>maxfracflagged</dt><dd><p>The maximum fraction of an antenna that can be flagged
before it is excluded from the signal-to-noise estimate.</p>
<p>Example: maxfracflagged=0.80</p>
</dd>
<dt>combine</dt><dd><p>Data axes to combine for solving. Options are ‘’, ‘scan’, ‘spw’,
‘field’ or any comma-separated combination.</p>
<p>Example: combine=’’</p>
</dd>
<dt>refant</dt><dd><p>Reference antenna name(s) in priority order. Defaults to most recent
values set in the pipeline context.  If no reference antenna is defined in
the pipeline context the CASA defaults are used.</p>
<p>Example: refant=’DV01’, refant=’DV05,DV07’</p>
</dd>
<dt>minblperant</dt><dd><p>Minimum number of baselines required per antenna for each solve.
Antennas with fewer baselines are excluded from solutions.</p>
<p>Example: minblperant=2</p>
</dd>
<dt>minsnr</dt><dd><p>Solutions below this SNR are rejected.</p>
</dd>
<dt>unregister_existing</dt><dd><p>Unregister previous spwphaseup calibrations from the pipeline context
before registering the new calibrations from this task.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Compute the default spectral window map and the per spectral window phase
offsets:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_spwphaseup</span><span class="p">()</span>
</pre></div>
</div>
<p>2. Compute the default spectral window map and the per spectral window phase
offsets set the spectral window mapping mode to ‘simple’:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_spwphaseup</span><span class="p">(</span><span class="n">hm_spwmapmode</span><span class="o">=</span><span class="s1">&#39;simple&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_targetflag">
<span id="pipeline-hifa-cli-hifa-targetflag-module"></span><h2>pipeline.hifa.cli.hifa_targetflag module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_targetflag" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_targetflag.hifa_targetflag">
<span class="sig-name descname"><span class="pre">hifa_targetflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_targetflag.html#hifa_targetflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_targetflag.hifa_targetflag" title="Link to this definition"></a></dt>
<dd><p>hifa_targetflag —- Flag target source outliers</p>
<p>This task flags very obvious target source outliers. The calibration tables and
flags accumulated in the cal library up to this point are pre-applied, then
hif_correctedampflag is called for just the TARGET intent. Any resulting
flags are applied and the calibration library is restored to the state before
calling this task.</p>
<p>Because science targets are generally not point sources, the flagging algorithm
needs to be more clever than for point source calibrators. The algorithm identifies
outliers by examining statistics within successive overlapping radial uv bins,
allowing it to adapt to an arbitrary uv structure. Outliers must appear to be a
potential outlier in two bins in order to be declared an outlier.  To further avoid
overflagging of good data, only the highest threshold levels are used (+12/-13 sigma).
This stage does can add significant processing time, particularly in making the plots.
So to save time, the amp vs. time plots are created only if flags are generated, and
the amp vs. uv distance plots are made for only those spws that generated flags.
Also, to avoid confusion in mosaics and single field surveys, the amp vs. uv distance
plots only show field IDs with new flags.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the h_init or hif_importdata task.
‘’: use all MeasurementSets in the context</p>
<p>Examples: ‘ngc5921.ms’, [‘ngc5921a.ms’, ngc5921b.ms’, ‘ngc5921c.ms’]</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Run with recommended settings to flag outliers in science target(s):</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_targetflag</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_timegaincal">
<span id="pipeline-hifa-cli-hifa-timegaincal-module"></span><h2>pipeline.hifa.cli.hifa_timegaincal module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_timegaincal" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_timegaincal.hifa_timegaincal">
<span class="sig-name descname"><span class="pre">hifa_timegaincal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calamptable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calphasetable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsetstable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetphasetable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amptable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calsolint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetsolint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refantmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solnorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minblperant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calminsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetminsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smodel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_timegaincal.html#hifa_timegaincal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_timegaincal.hifa_timegaincal" title="Link to this definition"></a></dt>
<dd><p>hifa_timegaincal —- Determine temporal gains from calibrator observations</p>
<p>The time-dependent complex gains for each antenna/spwid are determined from
the raw data (DATA column) divided by the model (MODEL column), for the
specified fields. The gains are computed according to the spw-combination
model determined in hifa_spwphaseup.</p>
<p>Previous calibrations are applied on the fly.</p>
<p>The complex gains are derived from the data column (raw data) divided by the
model column (usually set with hif_setjy). The gains are obtained for the
specified solution intervals, spw combination and field combination. One
gain solution is computed for the science targets and one for the calibrator
targets.</p>
<p>Good candidate reference antennas can be determined using the hif_refant
task.</p>
<p>Previous calibrations that have been stored in the pipeline context are
applied on the fly. Users can interact with these calibrations via the
h_export_calstate and h_import_calstate tasks.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘M82A.ms’, ‘M82B.ms’]</p>
</dd>
<dt>calamptable</dt><dd><p>The list of output diagnostic calibration amplitude tables for
the calibration targets. Defaults to the standard pipeline naming
convention.</p>
<p>Example: calamptable=[‘M82.gacal’, ‘M82B.gacal’]</p>
</dd>
<dt>offsetstable</dt><dd><p>The list of output diagnostic phase offset tables for the
calibration targets. Defaults to the standard pipeline naming convention.</p>
<p>Example: offsetstable=[‘M82.offsets.gacal’, ‘M82B.offsets.gacal’]</p>
</dd>
<dt>calphasetable</dt><dd><p>The list of output calibration phase tables for the
calibration targets. Defaults to the standard pipeline naming convention.</p>
<p>Example: calphasetable=[‘M82.gpcal’, ‘M82B.gpcal’]</p>
</dd>
<dt>targetphasetable</dt><dd><p>The list of output phase calibration tables for the science
targets. Defaults to the standard pipeline naming convention.</p>
<p>Example: targetphasetable=[‘M82.gpcal’, ‘M82B.gpcal’]</p>
</dd>
<dt>amptable</dt><dd><p>The list of output calibration amplitude tables for the
calibration and science targets.
Defaults to the standard pipeline naming convention.</p>
<p>Example: amptable=[‘M82.gacal’, ‘M82B.gacal’]</p>
</dd>
<dt>field</dt><dd><p>The list of field names or field ids for which gain solutions are to
be computed. Defaults to all fields with the standard intent.</p>
<p>Example: field=’3C279’, field=’3C279, M82’</p>
</dd>
<dt>spw</dt><dd><p>The list of spectral windows and channels for which gain solutions are
computed. Defaults to all science spectral windows.</p>
<p>Example: spw=’11’, spw=’11, 13’</p>
</dd>
<dt>antenna</dt><dd><p>The selection of antennas for which gains are computed. Defaults to all.</p>
</dd>
<dt>calsolint</dt><dd><p>Time solution interval in CASA syntax for calibrator source
solutions.</p>
<p>Example: calsolint=’inf’, calsolint=’int’, calsolint=’100sec’</p>
</dd>
<dt>targetsolint</dt><dd><p>Time solution interval in CASA syntax for target source
solutions.</p>
<p>Example: targetsolint=’inf’, targetsolint=’int’, targetsolint=’100sec’</p>
</dd>
<dt>refant</dt><dd><p>Reference antenna name(s) in priority order. Defaults to most recent
values set in the pipeline context. If no reference antenna is defined in
the pipeline context use the CASA defaults.</p>
<p>example: refant=’DV01’, refant=’DV05,DV07’</p>
</dd>
<dt>refantmode</dt><dd><p>Controls how the refant is applied. Currently available
choices are ‘flex’, ‘strict’, and the default value of ‘’.
Setting to ‘’ allows the pipeline to select the appropriate
mode based on the state of the reference antenna list.</p>
<p>Examples: refantmode=’strict’, refantmode=’’</p>
</dd>
<dt>solnorm</dt><dd><p>Normalise the gain solutions.</p>
</dd>
<dt>minblperant</dt><dd><p>Minimum number of baselines required per antenna for each solve.
Antennas with fewer baselines are excluded from solutions.</p>
<p>Example: minblperant=2</p>
</dd>
<dt>calminsnr</dt><dd><p>Solutions below this SNR are rejected for calibrator solutions.</p>
</dd>
<dt>targetminsnr</dt><dd><p>Solutions below this SNR are rejected for science target
solutions.</p>
</dd>
<dt>smodel</dt><dd><p>Point source Stokes parameters for source model (experimental)
Defaults to using standard MODEL_DATA column data.</p>
<p>Example: smodel=[1,0,0,0]  - (I=1, unpolarized)</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Compute standard per scan gain solutions that will be used to calibrate
the target:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_timegaincal</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_tsysflag">
<span id="pipeline-hifa-cli-hifa-tsysflag-module"></span><h2>pipeline.hifa.cli.hifa_tsysflag module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_tsysflag" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_tsysflag.hifa_tsysflag">
<span class="sig-name descname"><span class="pre">hifa_tsysflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_nmedian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnm_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnm_byfield</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_derivative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fd_max_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_edgechans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fe_edge_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_fieldshape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff_refintent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff_max_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_birdies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fb_sharps_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_toomany</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmf1_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmef1_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_tsys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetemplate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_tsysflag.html#hifa_tsysflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_tsysflag.hifa_tsysflag" title="Link to this definition"></a></dt>
<dd><p>hifa_tsysflag —- Flag deviant system temperatures for ALMA interferometry measurements.</p>
<p>This task flags all deviant system temperature measurements in the system
temperature calibration table by running a sequence of flagging tests, each
designed to look for a different type of possible error.</p>
<p>If a file with manual Tsys flags is provided with the <code class="docutils literal notranslate"><span class="pre">filetemplate</span></code>
parameter, then these flags are applied prior to the evaluation of the
flagging heuristics listed below.</p>
<p>The tests are:</p>
<ol class="arabic simple">
<li><p>Flag Tsys spectra with high median values</p></li>
<li><p>Flag Tsys spectra with high median derivatives. This is meant to spot
spectra that are ‘ringing’.</p></li>
<li><p>Flag the edge channels of the Tsys spectra in each SpW.</p></li>
<li><p>Flag Tsys spectra whose shape is different from that associated with
the BANDPASS intent.</p></li>
<li><p>Flag ‘birdies’.</p></li>
<li><p>Flag the Tsys spectra of all antennas in a timestamp and spw if
proportion of antennas already flagged in this timestamp and spw exceeds
a threshold, and flag Tsys spectra for all antennas and all timestamps
in a spw, if proportion of antennas that are already entirely flagged
in all timestamps exceeds a threshold.</p></li>
</ol>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets (Not used).</p>
</dd>
<dt>caltable</dt><dd><p>List of input Tsys calibration tables.</p>
<p>Default: [] - Use the table currently stored in the pipeline context.</p>
<p>Example: caltable=[‘X132.ms.tsys.s2.tbl’]</p>
</dd>
<dt>flag_nmedian</dt><dd><p>True to flag Tsys spectra with high median value.</p>
</dd>
<dt>fnm_limit</dt><dd><p>Flag spectra with median value higher than fnm_limit * median
of this measure over all spectra.</p>
</dd>
<dt>fnm_byfield</dt><dd><p>Evaluate the nmedian metric separately for each field.</p>
</dd>
<dt>flag_derivative</dt><dd><p>True to flag Tsys spectra with high median derivative.</p>
</dd>
<dt>fd_max_limit</dt><dd><p>Flag spectra with median derivative higher than
fd_max_limit * median of this measure over all spectra.</p>
</dd>
<dt>flag_edgechans</dt><dd><p>True to flag edges of Tsys spectra.</p>
</dd>
<dt>fe_edge_limit</dt><dd><p>Flag channels whose channel to channel difference &gt;
fe_edge_limit * median across spectrum.</p>
</dd>
<dt>flag_fieldshape</dt><dd><p>True to flag Tsys spectra with a radically different
shape to those of the ff_refintent.</p>
</dd>
<dt>ff_refintent</dt><dd><p>Data intent that provides the reference shape for
‘flag_fieldshape’.</p>
</dd>
<dt>ff_max_limit</dt><dd><p>Flag Tsys spectra with ‘fieldshape’ metric values &gt;
ff_max_limit.</p>
</dd>
<dt>flag_birdies</dt><dd><p>True to flag channels covering sharp spectral features.</p>
</dd>
<dt>fb_sharps_limit</dt><dd><p>Flag channels bracketing a channel to channel
difference &gt; fb_sharps_limit.</p>
</dd>
<dt>flag_toomany</dt><dd><p>True to flag Tsys spectra for which a proportion of
antennas for given timestamp and/or proportion of antennas that are
entirely flagged in all timestamps exceeds their respective thresholds.</p>
</dd>
<dt>tmf1_limit</dt><dd><p>Flag Tsys spectra for all antennas in a timestamp and spw if
proportion of antennas already flagged in this timestamp and spw exceeds
tmf1_limit.</p>
</dd>
<dt>tmef1_limit</dt><dd><p>Flag Tsys spectra for all antennas and all timestamps
in a spw, if proportion of antennas that are already entirely flagged
in all timestamps exceeds tmef1_limit.</p>
</dd>
<dt>metric_order</dt><dd><p>Order in which to evaluate the flagging metrics that are
enabled. Disabled metrics are skipped.</p>
</dd>
<dt>normalize_tsys</dt><dd><p>True to create a normalized Tsys table that is used to
evaluate the Tsys flagging metrics. All newly found flags are also applied
to the original Tsys caltable that continues to be used for subsequent
calibration.</p>
</dd>
<dt>filetemplate</dt><dd><p>The name of a text file that contains the manual Tsys flagging
template. If the template flags file is undefined, a name of the form
‘msname.flagtsystemplate.txt’ is assumed.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Flag Tsys measurements using currently recommended tests:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_tsysflag</span><span class="p">()</span>
</pre></div>
</div>
<p>2. Flag Tsys measurements using all recommended tests apart from that
using the ‘fieldshape’ metric:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_tsysflag</span><span class="p">(</span><span class="n">flag_fieldshape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_tsysflagcontamination">
<span id="pipeline-hifa-cli-hifa-tsysflagcontamination-module"></span><h2>pipeline.hifa.cli.hifa_tsysflagcontamination module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_tsysflagcontamination" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_tsysflagcontamination.hifa_tsysflagcontamination">
<span class="sig-name descname"><span class="pre">hifa_tsysflagcontamination</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetemplate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_n_extreme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_detection_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagnostic_plots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continue_on_failure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_tsysflagcontamination.html#hifa_tsysflagcontamination"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_tsysflagcontamination.hifa_tsysflagcontamination" title="Link to this definition"></a></dt>
<dd><p>hifa_tsysflagcontamination —- Flag line contamination in ALMA interferometric Tsys caltables</p>
<p>This task flags all line contamination detected through an analysis of the
Tsys and bandpass caltables.</p>
<p>The general idea for the detection algorithm is to discern features which
appear in the Tsys calibration tables of the scans taken in the vicinity
of the source field in comparison with the Tsys calibration tables of the
scans taken toward the bandpass. The bandpass scan should be clean of
astrophysical line features.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets (Not used).</p>
</dd>
<dt>caltable</dt><dd><p>List of input Tsys calibration tables.</p>
<p>Default: [] - Use the table currently stored in the pipeline context.</p>
<p>Example: caltable=[‘X132.ms.tsys.s2.tbl’]</p>
</dd>
<dt>filetemplate</dt><dd><p>output file to which regions to flag will be written</p>
</dd>
<dt>logpath</dt><dd><p>output file to which heuristic log statements will be
written</p>
</dd>
<dt>remove_n_extreme</dt><dd><p>expert parameter for contamination heuristic</p>
<p>Default: 2</p>
</dd>
<dt>relative_detection_factor</dt><dd><p>expert parameter for contamination detection heuristic</p>
<p>Default: 0.005</p>
</dd>
<dt>diagnostic_plots</dt><dd><p>create diagnostic plots for the line contamination heuristic</p>
<p>Default: True</p>
</dd>
<dt>continue_on_failure</dt><dd><p>controls whether pipeline execution continues if a failure
occurs in the underlying contamination detection heuristic.</p>
<p>Default: True</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Flag Tsys line contamination using currently recommended parameters:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_tsysflagcontamination</span><span class="p">()</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Halt pipeline execution if a failure occurs in the underlying heuristic:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_tsysflagcontamination</span><span class="p">(</span><span class="n">continue_on_failure</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_unlock_refant">
<span id="pipeline-hifa-cli-hifa-unlock-refant-module"></span><h2>pipeline.hifa.cli.hifa_unlock_refant module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_unlock_refant" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_unlock_refant.hifa_unlock_refant">
<span class="sig-name descname"><span class="pre">hifa_unlock_refant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_unlock_refant.html#hifa_unlock_refant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_unlock_refant.hifa_unlock_refant" title="Link to this definition"></a></dt>
<dd><p>hifa_unlock_refant —- Unlock reference antenna list</p>
<p>hifa_unlock_refant marks the reference antenna list as “unlocked” for
specified measurement sets, allowing the list to be modified by subsequent
tasks.</p>
<p>After executing hifa_unlock_refant, all subsequent gaincal calls will by
default be executed with refantmode=’flex’.</p>
<p>The refant list can be locked with the hifa_lock_refant task.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Unlock the refant list for all MSes in pipeline context:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_unlock_refant</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_wvrgcal">
<span id="pipeline-hifa-cli-hifa-wvrgcal-module"></span><h2>pipeline.hifa.cli.hifa_wvrgcal module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_wvrgcal" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_wvrgcal.hifa_wvrgcal">
<span class="sig-name descname"><span class="pre">hifa_wvrgcal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsetstable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_toffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segsource</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sourceflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_tie</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disperse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvrflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxdistm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minnumants</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mingoodfrac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa_intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa_bandpass_intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa_spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_wvrgcal.html#hifa_wvrgcal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_wvrgcal.hifa_wvrgcal" title="Link to this definition"></a></dt>
<dd><p>hifa_wvrgcal —-
Generate a gain table based on Water Vapor Radiometer data, and calculate
a QA score based on its effect on the interferometric data.</p>
<p>Generate a gain table based on the Water Vapor Radiometer data in each vis
file. By applying the wvr calibration to the data specified by <code class="docutils literal notranslate"><span class="pre">qa_intent</span></code>
and <code class="docutils literal notranslate"><span class="pre">qa_spw</span></code>, calculate a QA score to indicate its effect on
interferometric data; a score &gt; 1 implies that the phase noise is improved,
a score &lt; 1 implies that it is made worse. If the score is less than
<code class="docutils literal notranslate"><span class="pre">accept_threshold</span></code> then the wvr gain table is not accepted into the
context for subsequent use.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input visibility files.</p>
<p>Default: none, in which case the vis files to be used
will be read from the context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
<dt>caltable</dt><dd><p>List of output gain calibration tables.</p>
<p>Default: none, in which case the names of the caltables
will be generated automatically.</p>
<p>Example: caltable=’ngc5921.wvr’</p>
</dd>
<dt>offsetstable</dt><dd><p>List of input temperature offsets table files to subtract
from WVR measurements before calculating phase corrections.</p>
<p>Default: none, in which case no offsets are applied.</p>
<p>Example: offsetstable=[‘ngc5921.cloud_offsets’]</p>
</dd>
<dt>hm_toffset</dt><dd><p>If ‘manual’, set the <code class="docutils literal notranslate"><span class="pre">toffset</span></code> parameter to the user-specified value.
If ‘automatic’, set the <code class="docutils literal notranslate"><span class="pre">toffset</span></code> parameter according to the
date of the MeasurementSet; toffset=-1 if before 2013-01-21T00:00:00
toffset=0 otherwise.</p>
</dd>
<dt>toffset</dt><dd><p>Time offset (sec) between interferometric and WVR data.</p>
</dd>
<dt>segsource</dt><dd><p>If True calculate new atmospheric phase correction coefficients
for each source, subject to the constraints of the <code class="docutils literal notranslate"><span class="pre">tie</span></code> parameter.
‘segsource’ is forced to be True if the <code class="docutils literal notranslate"><span class="pre">tie</span></code> parameter is set to a
non-empty value by the user or by the automatic heuristic.</p>
</dd>
<dt>sourceflag</dt><dd><p>Flag the WVR data for these source(s) as bad and do not
produce corrections for it. Requires <code class="docutils literal notranslate"><span class="pre">segsource</span></code> = True.</p>
<p>Example: [‘3C273’]</p>
</dd>
<dt>hm_tie</dt><dd><p>If ‘manual’, set the <code class="docutils literal notranslate"><span class="pre">tie</span></code> parameter to the
user-specified value. If ‘automatic’, set the <code class="docutils literal notranslate"><span class="pre">tie</span></code>
parameter to include with the target all calibrators
that are within 15 degrees of it: if no calibrators are
that close then <code class="docutils literal notranslate"><span class="pre">tie</span></code> is left empty.</p>
</dd>
<dt>tie</dt><dd><p>Use the same atmospheric phase correction coefficients
when calculating the WVR correction for all sources in
the <code class="docutils literal notranslate"><span class="pre">tie</span></code>. If <code class="docutils literal notranslate"><span class="pre">tie</span></code> is not empty then <code class="docutils literal notranslate"><span class="pre">segsource</span></code>
is forced to be True. Ignored unless <code class="docutils literal notranslate"><span class="pre">hm_tie</span></code> = ‘manual’.</p>
<p>Example: tie=[‘3C273,NGC253’, ‘IC433,3C279’]</p>
</dd>
<dt>nsol</dt><dd><p>Number of solutions for phase correction coefficients during this
observation, evenly distributed in time throughout the observation. It
is used only if segsource=False because if segsource=True then the
coefficients are recomputed whenever the telescope moves to a new
source (within the limits imposed by ‘tie’).</p>
</dd>
<dt>disperse</dt><dd><p>Apply correction for dispersion. (Deprecated; will be removed)</p>
</dd>
<dt>wvrflag</dt><dd><p>Flag the WVR data for the listed antennas as bad and replace
their data with values interpolated from the 3 nearest antennas with
unflagged data.</p>
<p>Example: [‘DV03’,’DA05’,’PM02’]</p>
</dd>
<dt>hm_smooth</dt><dd><p>If ‘manual’ set the <code class="docutils literal notranslate"><span class="pre">smooth</span></code> parameter to the user-specified value.
If ‘automatic’, run the wvrgcal task with the range of <code class="docutils literal notranslate"><span class="pre">smooth</span></code> parameters
required to match the integration time of the wvr data to that of the
interferometric data in each spectral window.</p>
</dd>
<dt>smooth</dt><dd><p>Smooth WVR data on this timescale before calculating the correction.
Ignored unless hm_smooth=’manual’.</p>
</dd>
<dt>scale</dt><dd><p>Scale the entire phase correction by this factor.</p>
</dd>
<dt>maxdistm</dt><dd><p>Maximum distance in meters of an antenna used for interpolation
from a flagged antenna.</p>
<p>Default: -1  (automatically set to 100m if &gt;50% of
antennas are 7m antennas without WVR and otherwise set to
500m).</p>
<p>Example: maxdistm=550</p>
</dd>
<dt>minnumants</dt><dd><p>Minimum number of nearby antennas (up to 3) used for
interpolation from a flagged antenna.</p>
<p>Example: minnumants=3</p>
</dd>
<dt>mingoodfrac</dt><dd><p>Minimum fraction of good data per antenna.</p>
</dd>
<dt>refant</dt><dd><p>Ranked comma delimited list of reference antennas.</p>
<p>Example: refant=’DV01,DV02’</p>
</dd>
<dt>qa_intent</dt><dd><p>The list of data intents on which the wvr correction is to be
tried as a means of estimating its effectiveness.</p>
<p>A QA ‘view’ will be calculated for each specified intent, in each spectral
window in each vis file.</p>
<p>Each QA ‘view’ will consist of a pair of 2-d images with dimensions
[‘ANTENNA’, ‘TIME’], one showing the data phase-noise before the
wvr application, the second showing the phase noise after (both ‘before’
and ‘after’ images have a bandpass calibration applied as well).</p>
<p>An overall QA score is calculated for each vis file, by dividing the
‘before’ images by the ‘after’ and taking the median of the result. An
overall score of 1 would correspond to no change in the phase noise,
a score &gt; 1 implies an improvement.</p>
<p>If the overall score for a vis file is less than the value in
‘accept_threshold’ then the wvr calibration file is not made available
for merging into the context for use in the subsequent reduction.</p>
<p>If you do not want any QA calculations then set qa_intent=’’.</p>
<p>example: qa_intent=’PHASE’</p>
</dd>
<dt>qa_bandpass_intent</dt><dd><p>The data intent to use for the bandpass calibration in
the qa calculation. The default is blank to allow the underlying bandpass
task to select a sensible intent if the dataset lacks BANDPASS data.</p>
</dd>
<dt>qa_spw</dt><dd><p>The SpW(s) to use for the qa calculation, in the order that they
should be tried. Input as a comma-separated list. The default is blank, in
which case the task will try SpWs in order of decreasing median sky
opacity.</p>
</dd>
<dt>accept_threshold</dt><dd><p>The phase-rms improvement ratio
(rms without wvr / rms with wvr) above which the wrvg file will be
accepted into the context for subsequent application.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Compute the WVR calibration for all the MeasurementSets:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_wvrgcal</span><span class="p">(</span><span class="n">hm_tie</span><span class="o">=</span><span class="s1">&#39;automatic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli.hifa_wvrgcalflag">
<span id="pipeline-hifa-cli-hifa-wvrgcalflag-module"></span><h2>pipeline.hifa.cli.hifa_wvrgcalflag module<a class="headerlink" href="#module-pipeline.hifa.cli.hifa_wvrgcalflag" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_wvrgcalflag.hifa_wvrgcalflag">
<span class="sig-name descname"><span class="pre">hifa_wvrgcalflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsetstable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_toffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segsource</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sourceflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_tie</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disperse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvrflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxdistm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minnumants</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mingoodfrac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa_intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa_bandpass_intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_hi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fhi_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fhi_minsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ants_with_wvr_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_wvrgcalflag.html#hifa_wvrgcalflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_wvrgcalflag.hifa_wvrgcalflag" title="Link to this definition"></a></dt>
<dd><p>hifa_wvrgcalflag —-
Generate a gain table based on Water Vapor Radiometer data, interpolating over
antennas with bad radiometers.</p>
<p>This task will first identify for each vis whether it includes at least 3
antennas with Water Vapor Radiometer (WVR) data, and that the fraction of
WVR antennas / all antennas exceeds the minimum threshold
(ants_with_wvr_thresh).</p>
<p>If there are not enough WVR antennas by number and/or fraction, then no WVR
caltable is created and no WVR calibration will be applied to the corresponding
vis. If there are enough WVR antennas, then the task proceeds as follows for
each valid vis:</p>
<p>First, generate a gain table based on the Water Vapor Radiometer data for
each vis.</p>
<p>Second, apply the WVR calibration to the data specified by ‘flag_intent’,
calculate flagging ‘views’ showing the ratio
‘phase-rms with WVR / phase-rms without WVR’ for each scan. A ratio &lt; 1
implies that the phase noise is improved, a ratio &gt; 1 implies that it
is made worse.</p>
<p>Third, search the flagging views for antennas with anomalous high values.
If any are found then recalculate the WVR calibration with the ‘wvrflag’
parameter set to ignore their data and interpolate results from other
antennas according to ‘maxdistm’ and ‘minnumants’.</p>
<p>Fourth, after flagging, if the remaining unflagged antennas with WVR number
fewer than 3, or represent a smaller fraction of antennas than the minimum
threshold (ants_with_wvr_thresh), then the WVR calibration file is rejected
and will not be merged into the context, i.e. not be used in subsequent
calibration.</p>
<p>Fifth, if the overall QA score for the final WVR correction of a vis file
is greater than the value in ‘accept_threshold’ then make available the
wvr calibration file for merging into the context and use in the
subsequent reduction.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input visibility files.</p>
<p>Default: none, in which case the vis files to be used
will be read from the context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
<dt>caltable</dt><dd><p>List of output gain calibration tables.</p>
<p>Default: none, in which case the names of the caltables
will be generated automatically.</p>
<p>Example: caltable=’ngc5921.wvr’</p>
</dd>
<dt>offsetstable</dt><dd><p>List of input temperature offsets table files to
subtract from WVR measurements before calculating phase
corrections.</p>
<p>Default: none, in which case no offsets are applied.</p>
<p>Example: offsetstable=[‘ngc5921.cloud_offsets’]</p>
</dd>
<dt>hm_toffset</dt><dd><p>If ‘manual’, set the ‘toffset’ parameter to the user-specified
value. If ‘automatic’, set the ‘toffset’ parameter according to the
date of the MeasurementSet; toffset=-1 if before 2013-01-21T00:00:00
toffset=0 otherwise.</p>
</dd>
<dt>toffset</dt><dd><p>Time offset (sec) between interferometric and WVR data.</p>
</dd>
<dt>segsource</dt><dd><p>If True calculate new atmospheric phase correction
coefficients for each source, subject to the
constraints of the <code class="docutils literal notranslate"><span class="pre">tie</span></code> parameter. <code class="docutils literal notranslate"><span class="pre">segsource</span></code> is
forced to be True if the <code class="docutils literal notranslate"><span class="pre">tie</span></code> parameter is set to a
non-empty value by the user or by the automatic
heuristic.</p>
</dd>
<dt>sourceflag</dt><dd><p>Flag the WVR data for these source(s) as bad and do not
produce corrections for it. Requires
<code class="docutils literal notranslate"><span class="pre">segsource</span></code> = True.</p>
<p>Example: sourceflag=[‘3C273’]</p>
</dd>
<dt>hm_tie</dt><dd><p>If ‘manual’, set the <code class="docutils literal notranslate"><span class="pre">tie</span></code> parameter to the
user-specified value. If ‘automatic’, set the <code class="docutils literal notranslate"><span class="pre">tie</span></code>
parameter to include with the target all calibrators
that are within 15 degrees of it: if no calibrators are
that close then <code class="docutils literal notranslate"><span class="pre">tie</span></code> is left empty.</p>
</dd>
<dt>tie</dt><dd><p>Use the same atmospheric phase correction coefficients
when calculating the WVR correction for all sources in
the <code class="docutils literal notranslate"><span class="pre">tie</span></code>. If <code class="docutils literal notranslate"><span class="pre">tie</span></code> is not empty then <code class="docutils literal notranslate"><span class="pre">segsource</span></code>
is forced to be True. Ignored unless <code class="docutils literal notranslate"><span class="pre">hm_tie</span></code> = ‘manual’.</p>
<p>Example: tie=[‘3C273,NGC253’, ‘IC433,3C279’]</p>
</dd>
<dt>nsol</dt><dd><p>Number of solutions for phase correction coefficients during this
observation, evenly distributed in time throughout the observation. It
is used only if segsource=False because if segsource=True then the
coefficients are recomputed whenever the telescope moves to a new
source (within the limits imposed by ‘tie’).</p>
</dd>
<dt>disperse</dt><dd><p>Apply correction for dispersion.
(Deprecated; will be removed)</p>
</dd>
<dt>wvrflag</dt><dd><p>Flag the WVR data for these antenna(s) as bad and replace its data
with interpolated values.</p>
<p>Example: wvrflag=[‘DV03’,’DA05’,’PM02’]</p>
</dd>
<dt>hm_smooth</dt><dd><p>If ‘manual’ set the ‘smooth’ parameter to the user-specified value.
If ‘automatic’, run the wvrgcal task with the range of ‘smooth’ parameters
required to match the integration time of the WVR data to that of the
interferometric data in each spectral window.</p>
</dd>
<dt>smooth</dt><dd><p>Smooth WVR data on this timescale before calculating the correction.
Ignored unless hm_smooth=’manual’.</p>
</dd>
<dt>scale</dt><dd><p>Scale the entire phase correction by this factor.</p>
</dd>
<dt>maxdistm</dt><dd><p>Distance in meters of an antenna used for interpolation
from a flagged antenna.</p>
<p>Default: -1 (automatically set to 100m if &gt;50% of
antennas are 7m antennas without WVR and otherwise set
to 500m).</p>
<p>Example: maxdistm=550</p>
</dd>
<dt>minnumants</dt><dd><p>Minimum number of nearby antennas (up to 3) used for
interpolation from a flagged antenna.</p>
<p>Example: minnumants=3</p>
</dd>
<dt>mingoodfrac</dt><dd><p>Minimum fraction of good data per antenna.</p>
<p>Example: mingoodfrac=0.7</p>
</dd>
<dt>refant</dt><dd><p>Ranked comma delimited list of reference antennas.</p>
<p>Example: refant=’DV02,DV06’</p>
</dd>
<dt>flag_intent</dt><dd><p>The data intent(s) on whose WVR correction results the
search for bad WVR antennas is to be based.</p>
<p>A ‘flagging view’ will be calculated for each specified
intent, in each spectral window in each vis file.</p>
<p>Each ‘flagging view’ will consist of a 2-d image with dimensions
[‘ANTENNA’, ‘TIME’], showing the phase noise after the WVR
correction has been applied.</p>
<p>If flag_intent is left blank, the default, the flagging views will be
derived from data with the default bandpass calibration intent i.e.
the first in the list BANDPASS, PHASE, AMPLITUDE for which the
MeasurementSet has data.</p>
</dd>
<dt>qa_intent</dt><dd><p>The list of data intents on which the WVR correction is to be
tried as a means of estimating its effectiveness.</p>
<p>A QA ‘view’ will be calculated for each specified intent, in each spectral
window in each vis file.</p>
<p>Each QA ‘view’ will consist of a pair of 2-d images with dimensions
[‘ANTENNA’, ‘TIME’], one showing the data phase-noise before the
WVR application, the second showing the phase noise after (both ‘before’
and ‘after’ images have a bandpass calibration applied as well).</p>
<p>An overall QA score is calculated for each vis file, by dividing the
‘before’ images by the ‘after’ and taking the median of the result. An
overall score of 1 would correspond to no change in the phase noise,
a score &gt; 1 implies an improvement.</p>
<p>If the overall score for a vis file is less than the value in
‘accept_threshold’ then the WVR calibration file is not made available for
merging into the context for use in the subsequent reduction.</p>
</dd>
<dt>qa_bandpass_intent</dt><dd><p>The data intent to use for the bandpass calibration in
the qa calculation. The default is blank to allow the underlying bandpass
task to select a sensible intent if the dataset lacks BANDPASS data.</p>
</dd>
<dt>accept_threshold</dt><dd><p>The phase-rms improvement ratio
(rms without WVR / rms with WVR) above which the wrvg file will be
accepted into the context for subsequent application.</p>
</dd>
<dt>flag_hi</dt><dd><p>True to flag high figure of merit outliers.</p>
</dd>
<dt>fhi_limit</dt><dd><p>Flag figure of merit values higher than limit * MAD.</p>
</dd>
<dt>fhi_minsample</dt><dd><p>Minimum number of samples for valid MAD estimate.</p>
</dd>
<dt>ants_with_wvr_thresh</dt><dd><p>This threshold sets the minimum fraction of antennas
that should have WVR data for WVR calibration and flagging to proceed; the
same threshold is used to determine, after flagging, whether there remain
enough unflagged antennas with WVR data for the WVR calibration to be
applied.</p>
<p>Example: ants_with_wvr_thresh=0.5</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Compute the WVR calibration for all the MeasurementSets:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_wvrgcalflag</span><span class="p">(</span><span class="n">hm_tie</span><span class="o">=</span><span class="s1">&#39;automatic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hifa.cli">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pipeline.hifa.cli" title="Link to this heading"></a></h2>
<p>Interferometry ALMA Tasks</p>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_antpos">
<span class="sig-name descname"><span class="pre">hifa_antpos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_antpos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antposfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_antpos.html#hifa_antpos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_antpos" title="Link to this definition"></a></dt>
<dd><p>hifa_antpos —- Derive an antenna position calibration table</p>
<p>The hifa_antpos task corrects the antenna positions recorded in the ASDMs using
updated antenna position calibration information determined after the
observation was taken.</p>
<p>Corrections can be input by hand, read from a file on disk, or in the future
by querying an ALMA database service.</p>
<p>The antenna positions file is in ‘csv’ format containing 6 comma-delimited
columns as shown below. This file should not include blank lines, including
after the end of the last entry. The default name of this file is ‘antennapos.csv’.</p>
<p>Example of contents for an ‘antennapos.csv’ file:</p>
<blockquote>
<div><p>ms,antenna,xoffset,yoffset,zoffset,comment</p>
<p>uid___A002_X30a93d_X43e.ms,DV11,0.000,0.010,0.000,”No comment”</p>
<p>uid___A002_X30a93d_X43e.dup.ms,DV11,0.000,-0.010,0.000,”No comment”</p>
</div></blockquote>
<p>The offset values in this file are in meters.</p>
<p>The corrections are used to generate a calibration table which is recorded
in the pipeline context and applied to the raw visibility data, on the fly to
generate other calibration tables, or permanently to generate calibrated
visibilities for imaging.</p>
<p>Note: the <code class="docutils literal notranslate"><span class="pre">hm_antpos</span></code> ‘online’ option will be implemented when the
observing system provides an antenna position determination service.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
<dt>caltable</dt><dd><p>List of names for the output calibration tables. Defaults
to the standard pipeline naming convention.</p>
<p>Example: caltable=[‘ngc5921.gcal’]</p>
</dd>
<dt>hm_antpos</dt><dd><p>Heuristics method for retrieving the antenna position
corrections. The options are ‘online’ (not yet implemented),
‘manual’, and ‘file’.</p>
<p>Example: hm_antpos=’manual’</p>
</dd>
<dt>antenna</dt><dd><p>The list of antennas for which the positions are to be corrected
if <code class="docutils literal notranslate"><span class="pre">hm_antpos</span></code> is ‘manual’.</p>
<p>Example: antenna=’DV05,DV07’</p>
</dd>
<dt>offsets</dt><dd><p>The list of antenna offsets for each antenna in ‘antennas’.
Each offset is a set of 3 floating point numbers separated by
commas, specified in the ITRF frame.</p>
<p>Example: offsets=[0.01, 0.02, 0.03, 0.03, 0.02, 0.01]</p>
</dd>
<dt>antposfile</dt><dd><p>The file(s) containing the antenna offsets. Used if
<code class="docutils literal notranslate"><span class="pre">hm_antpos</span></code> is ‘file’.</p>
</dd>
<dt>threshold</dt><dd><p>Highlight antenna position offsets greater than this value in
the weblog. Units are wavelengths and the default is 1.0.</p>
<p>Example: threshold=1.0</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Correct the position of antenna ‘DV05’ for all the visibility files in a
single pipeline run:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_antpos</span><span class="p">(</span><span class="n">antenna</span><span class="o">=</span><span class="s1">&#39;DV05&#39;</span><span class="p">,</span> <span class="n">offsets</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">])</span>
</pre></div>
</div>
<p>2. Correct the position of antennas for all the visibility files in a single
pipeline run using antenna positions files on disk. These files are assumed
to conform to a default naming scheme if <code class="docutils literal notranslate"><span class="pre">antposfile</span></code> is unspecified by the
user:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_antpos</span><span class="p">(</span><span class="n">hm_antpos</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="n">antposfile</span><span class="o">=</span><span class="s1">&#39;myantposfile.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_bandpass">
<span class="sig-name descname"><span class="pre">hifa_bandpass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_phaseup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupsolint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupbw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupnsols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_bandpass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxchannels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evenbpints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minbpsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpnsols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solnorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minblperant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unregister_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_auto_fillgaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_bandpass.html#hifa_bandpass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_bandpass" title="Link to this definition"></a></dt>
<dd><p>hifa_bandpass —- Compute bandpass calibration solutions</p>
<p>The hifa_bandpass task computes a bandpass solution for every specified
science spectral window. By default, a ‘phaseup’ pre-calibration is
performed and applied on the fly to the data, before the bandpass is
computed.</p>
<p>The hif_refant task may be used to pre-compute a prioritized list of
reference antennas.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
<dt>caltable</dt><dd><p>List of names for the output calibration tables. Defaults
to the standard pipeline naming convention.</p>
<p>Example: caltable=[‘ngc5921.gcal’]</p>
</dd>
<dt>field</dt><dd><p>The list of field names or field ids for which
bandpasses are computed. Set to field=’’ by default,
which means the task will select all fields.</p>
<p>Example: field=’3C279’, field=’3C279,M82’</p>
</dd>
<dt>intent</dt><dd><p>A string containing a comma delimited list of intents
against which the selected fields are matched. Set to
intent=’’ by default, which means the task will select
all data with the BANDPASS intent.</p>
<p>Example: intent=’<cite>*PHASE*</cite>’</p>
</dd>
<dt>spw</dt><dd><p>The list of spectral windows and channels for which
bandpasses are computed. Set to spw=’’ by default, which
means the task will select all science spectral windows.</p>
<p>Example: spw=’11,13,15,17’</p>
</dd>
<dt>antenna</dt><dd><p>Set of data selection antenna IDs</p>
</dd>
<dt>hm_phaseup</dt><dd><p>The pre-bandpass solution phaseup gain heuristics. The
options are:</p>
<p>‘snr’: compute solution required to achieve the specified SNR</p>
<p>‘manual’: use manual solution parameters</p>
<p>‘’: skip phaseup</p>
<p>Example: hm_phaseup=’manual’</p>
</dd>
<dt>phaseupsolint</dt><dd><p>The phase correction solution interval in CASA syntax.
Used when <code class="docutils literal notranslate"><span class="pre">hm_phaseup</span></code> = ‘manual’ or as a default if
the <code class="docutils literal notranslate"><span class="pre">hm_phaseup</span></code> = ‘snr’ heuristic computation fails.</p>
<p>Example: phaseupsolint=’300s’</p>
</dd>
<dt>phaseupbw</dt><dd><p>Bandwidth to be used for phaseup. Used when
<code class="docutils literal notranslate"><span class="pre">hm_phaseup</span></code> = ‘manual’.</p>
<p>Example:</p>
<p>phaseupbw=’’ to use entire bandpass</p>
<p>phaseupbw=’500MHz’ to use central 500MHz</p>
</dd>
<dt>phaseupsnr</dt><dd><p>The required SNR for the phaseup solution. Used to calculate
the phaseup time solint, and only if
<code class="docutils literal notranslate"><span class="pre">hm_phaseup</span></code> = ‘snr’.</p>
<p>Example: phaseupsnr=10.0</p>
</dd>
<dt>phaseupnsols</dt><dd><p>The minimum number of phaseup gain solutions. Used only
if <code class="docutils literal notranslate"><span class="pre">hm_phaseup</span></code> = ‘snr’.</p>
<p>Example: phaseupnsols=4</p>
</dd>
<dt>hm_bandpass</dt><dd><p>The bandpass solution heuristics. The options are:</p>
<p>‘snr’: compute the solution required to achieve the specified SNR</p>
<p>‘smoothed’: simple ‘smoothing’ i.e. spectral solint&gt;1chan</p>
<p>‘fixed’: use the user defined parameters for all spws</p>
<p>Example: hm_bandpass=’snr’</p>
</dd>
<dt>solint</dt><dd><p>Time and channel solution intervals in CASA syntax.
Default is solint=’inf’, which is used when
<code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘fixed’.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’, then the task will attempt
to compute and use an optimal SNR-based solint (and warn
if this solint is not good enough).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘smoothed’, the task will override
the spectral solint with bandwidth/maxchannels.</p>
<p>Example: solint=’int’</p>
</dd>
<dt>maxchannels</dt><dd><p>The bandpass solution ‘smoothing’ factor in channels,
i.e. spectral solint will be set to bandwidth / maxchannels
Set to 0 for no smoothing. Used if
<code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘smoothed’.</p>
<p>Example: maxchannels=240</p>
</dd>
<dt>evenbpints</dt><dd><p>Force the per spw frequency solint to be evenly divisible
into the spw bandpass if <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’.</p>
<p>Example: evenbpints=False</p>
</dd>
<dt>bpsnr</dt><dd><p>The required SNR for the bandpass solution. Used only if
<code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’.</p>
<p>Example: bpsnr=30.0</p>
</dd>
<dt>minbpsnr</dt><dd><p>The minimum required SNR for the bandpass solution
when strong atmospheric lines exist in Tsys spectra.
Used only if <a href="#id9"><span class="problematic" id="id10">``</span></a>hm_bandpass``=’snr’.</p>
<p>Example: minbpsnr=10.0</p>
</dd>
<dt>bpnsols</dt><dd><p>The minimum number of bandpass solutions. Used only if
<code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’.</p>
<p>Example: bpnsols=8</p>
</dd>
<dt>combine</dt><dd><p>Data axes to combine for solving. Axes are ‘’, ‘scan’,
‘spw’, ‘field’ or any comma-separated combination.</p>
<p>Example: combine=’scan,field’</p>
</dd>
<dt>refant</dt><dd><p>List of reference antenna names. Defaults to the
value(s) stored in the pipeline context. If undefined in
the pipeline context defaults to the CASA reference
antenna naming scheme.</p>
<p>Example: refant=’DV06,DV07’</p>
</dd>
<dt>solnorm</dt><dd><p>Normalise the bandpass solution; defaults to True.</p>
<p>Example: solnorm=False</p>
</dd>
<dt>minblperant</dt><dd><p>Minimum number of baselines required per antenna for
each solve. Antennas with fewer baselines are excluded
from solutions.</p>
<p>Example: minblperant=4</p>
</dd>
<dt>minsnr</dt><dd><p>Solutions below this SNR are rejected in the phaseup and
bandpass solves.</p>
<p>Example: minsnr=3.0</p>
</dd>
<dt>unregister_existing</dt><dd><p>Unregister all bandpass calibrations from the pipeline
context before registering the new bandpass calibrations
from this task. Defaults to False.</p>
<p>Example: unregister_existing=True</p>
</dd>
<dt>hm_auto_fillgaps</dt><dd><p>If True, then the <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’ or ‘smoothed’
modes, that solve bandpass per SpW, are performed with
CASA bandpass task parameter ‘fillgaps’ set to a quarter
of the respective SpW bandwidth (in channels).</p>
<p>If False, then these bandpass solves will use
fillgaps=0.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘fixed’ mode is unaffected by
<code class="docutils literal notranslate"><span class="pre">hm_auto_fillgaps</span></code> and always uses fillgaps=0.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Compute a channel bandpass for all visibility files in the pipeline
context using the CASA reference antenna determination scheme:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_bandpass</span><span class="p">()</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Same as the above but precompute a prioritized reference antenna list:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hif_refant</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_bandpass</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_bandpassflag">
<span class="sig-name descname"><span class="pre">hifa_bandpassflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_phaseup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupsolint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupbw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupnsols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_bandpass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxchannels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evenbpints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minbpsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpnsols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minblperant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solnorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antnegsig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antpossig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmantint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antblnegsig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antblpossig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relaxed_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_auto_fillgaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_bandpassflag.html#hifa_bandpassflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_bandpassflag" title="Link to this definition"></a></dt>
<dd><p>hifa_bandpassflag —- Bandpass calibration flagging</p>
<p>This task performs a preliminary phased-up bandpass solution and temporarily
applies it, then computes the flagging heuristics by calling
hif_correctedampflag which looks for outlier visibility points by statistically
examining the scalar difference of the corrected amplitudes minus model
amplitudes, and then flags those outliers. The philosophy is that only outlier
data points that have remained outliers after calibration will be flagged. Note
that the phase of the data is not assessed.</p>
<p>Plots are generated at two points in this workflow: after bandpass calibration
but before flagging heuristics are run, and after flagging heuristics have been
run and applied. If no points were flagged, the ‘after’ plots are not generated
or displayed.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
<dt>caltable</dt><dd><p>List of names for the output calibration tables. Defaults
to the standard pipeline naming convention.</p>
<p>Example: caltable=[‘ngc5921.gcal’]</p>
</dd>
<dt>intent</dt><dd><p>A string containing a comma delimited list of intents against
which the selected fields are matched. Set to intent=’’ by default, which
means the task will select all data with the BANDPASS intent.</p>
<p>Example: intent=’<cite>*PHASE*</cite>’</p>
</dd>
<dt>field</dt><dd><p>The list of field names or field ids for which bandpasses are
computed. Set to field=’’ by default, which means the task
will select all fields.</p>
<p>Example: field=’3C279’, field=’3C279,M82’</p>
</dd>
<dt>spw</dt><dd><p>The list of spectral windows and channels for which bandpasses are
computed. Set to spw=’’ by default, which means the task will select all
science spectral windows.</p>
<p>Example: spw=’11,13,15,17’</p>
</dd>
<dt>antenna</dt><dd><p>Set of data selection antenna IDs</p>
</dd>
<dt>hm_phaseup</dt><dd><p>The pre-bandpass solution phaseup gain heuristics. The options are:</p>
<p>‘snr’: compute solution required to achieve the specified SNR</p>
<p>‘manual’: use manual solution parameters</p>
<p>‘’: skip phaseup</p>
<p>Example: hm_phaseup=’manual’</p>
</dd>
<dt>phaseupsolint</dt><dd><p>The phase correction solution interval in CASA syntax.
Used when <code class="docutils literal notranslate"><span class="pre">hm_phaseup</span></code> = ‘manual’ or as a default if the
<code class="docutils literal notranslate"><span class="pre">hm_phaseup</span></code> = ‘snr’ heuristic computation fails.</p>
<p>Example: phaseupsolint=’300s’</p>
</dd>
<dt>phaseupbw</dt><dd><p>Bandwidth to be used for phaseup. Used when
<code class="docutils literal notranslate"><span class="pre">hm_phaseup</span></code> = ‘manual’.</p>
<p>Example:</p>
<p>phaseupbw=’’ to use entire bandpass</p>
<p>phaseupbw=’500MHz’ to use central 500MHz</p>
</dd>
<dt>phaseupsnr</dt><dd><p>The required SNR for the phaseup solution. Used only if
hm_phaseup=’snr’.</p>
<p>Example: phaseupsnr=10.0</p>
</dd>
<dt>phaseupnsols</dt><dd><p>The minimum number of phaseup gain solutions. Used only if
hm_phaseup=’snr’.</p>
<p>Example: phaseupnsols=4</p>
</dd>
<dt>hm_bandpass</dt><dd><p>The bandpass solution heuristics. The options are:</p>
<p>‘snr’: compute the solution required to achieve the specified SNR</p>
<p>‘smoothed’: simple ‘smoothing’ i.e. spectral solint&gt;1chan</p>
<p>‘fixed’: use the user defined parameters for all spws</p>
</dd>
<dt>solint</dt><dd><p>Time and channel solution intervals in CASA syntax.
Default is solint=’inf’, which is used when
<code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘fixed’.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’, then the task will attempt to
compute and use an optimal SNR-based solint (and warn if this
solint is not good enough).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘smoothed’, the task will override the
spectral solint with bandwidth/maxchannels.</p>
</dd>
<dt>maxchannels</dt><dd><p>The bandpass solution ‘smoothing’ factor in channels, i.e.
spectral solint will be set to bandwidth/maxchannels
Set to 0 for no smoothing.
Used if <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘smoothed’.</p>
<p>Example: maxchannels=240</p>
</dd>
<dt>evenbpints</dt><dd><p>Force the per spw frequency solint to be evenly divisible
into the spw bandpass if <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’.</p>
<p>Example: evenbpints=False</p>
</dd>
<dt>bpsnr</dt><dd><p>The required SNR for the bandpass solution. Used only if
<code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’.</p>
<p>Example: bpsnr=30.0</p>
</dd>
<dt>minbpsnr</dt><dd><p>The minimum required SNR for the bandpass solution
when strong atmospheric lines exist in Tsys spectra.
Used only if <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’.</p>
<p>Example: minbpsnr=10.0</p>
</dd>
<dt>bpnsols</dt><dd><p>The minimum number of bandpass solutions. Used only if
<code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’.</p>
<p>Example: bpnsols=8</p>
</dd>
<dt>combine</dt><dd><p>Data axes to combine for solving. Axes are ‘’, ‘scan’, ‘spw’,
‘field’ or any comma-separated combination.</p>
<p>Example: combine=’scan,field’</p>
</dd>
<dt>refant</dt><dd><p>List of reference antenna names. Defaults to the value(s) stored in the
pipeline context. If undefined in the pipeline context defaults to
the CASA reference antenna naming scheme.</p>
<p>Example: refant=’DV06,DV07’</p>
</dd>
<dt>minblperant</dt><dd><p>Minimum number of baselines required per antenna for each solve.
Antennas with fewer baselines are excluded from solutions.</p>
<p>Example: minblperant=4</p>
</dd>
<dt>minsnr</dt><dd><p>Solutions below this SNR are rejected.</p>
<p>Example: minsnr=3.0</p>
</dd>
<dt>solnorm</dt><dd><p>Normalise the bandpass solution; defaults to True.</p>
</dd>
<dt>antnegsig</dt><dd><p>Lower sigma threshold for identifying outliers as a result of
bad antennas within individual timestamps.</p>
<p>Example: antnegsig=4.0</p>
</dd>
<dt>antpossig</dt><dd><p>Upper sigma threshold for identifying outliers as a result of
bad antennas within individual timestamps.</p>
<p>Example: antpossig=4.6</p>
</dd>
<dt>tmantint</dt><dd><p>Threshold for maximum fraction of timestamps that are allowed
to contain outliers.</p>
<p>Example: tmantint=0.063</p>
</dd>
<dt>tmint</dt><dd><p>Initial threshold for maximum fraction of ‘outlier timestamps’
over ‘total timestamps’ that a baseline may be a part of.</p>
<p>Example: tmint=0.085</p>
</dd>
<dt>tmbl</dt><dd><p>Initial threshold for maximum fraction of ‘bad baselines’ over
‘all baselines’ that an antenna may be a part of.</p>
<p>Example: tmbl=0.175</p>
</dd>
<dt>antblnegsig</dt><dd><p>Lower sigma threshold for identifying outliers as a result of
‘bad baselines’ and/or ‘bad antennas’ within baselines (across all
timestamps).</p>
<p>Example: antblnegsig=3.4</p>
</dd>
<dt>antblpossig</dt><dd><p>Upper sigma threshold for identifying outliers as a result of
‘bad baselines’ and/or ‘bad antennas’ within baselines (across all
timestamps).</p>
<p>Example: antblpossig=3.2</p>
</dd>
<dt>relaxed_factor</dt><dd><p>Relaxed value to set the threshold scaling factor to under
certain conditions (see documentation of the underlying correctedampflag task).</p>
<p>Example: relaxed_factor=2.0</p>
</dd>
<dt>niter</dt><dd><p>Maximum number of times to iterate on evaluation of flagging
heuristics. If an iteration results in no new flags, then subsequent
iterations are skipped.</p>
<p>Example: niter=2</p>
</dd>
<dt>hm_auto_fillgaps</dt><dd><p>If True, then the <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘snr’ or ‘smoothed’
modes, that solve bandpass per SpW, are performed with
CASA bandpass task parameter ‘fillgaps’ set to a quarter
of the respective SpW bandwidth (in channels).</p>
<p>If False, then these bandpass solves will use
fillgaps=0.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">hm_bandpass</span></code> = ‘fixed’ mode is unaffected by
<code class="docutils literal notranslate"><span class="pre">hm_auto_fillgaps</span></code> and always uses fillgaps=0.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. run with recommended settings to create bandpass solution with flagging
using recommended thresholds:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_bandpassflag</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_bpsolint">
<span class="sig-name descname"><span class="pre">hifa_bpsolint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minphaseupints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evenbpints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minbpsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minbpnchan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_nantennas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxfracflagged</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_bpsolint.html#hifa_bpsolint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_bpsolint" title="Link to this definition"></a></dt>
<dd><p>hifa_bpsolint —- Compute optimal bandpass calibration solution intervals</p>
<p>The optimal bandpass phaseup time and frequency solution intervals required
to achieve the required signal-to-noise ratio is estimated based on nominal
ALMA array characteristics the metadata associated with the observation.</p>
<p>The phaseup gain time and bandpass frequency intervals are determined as
follows:</p>
<ul class="simple">
<li><p>For each data set the list of source(s) to use for bandpass solution
signal-to-noise estimation is compiled based on the values of the
<code class="docutils literal notranslate"><span class="pre">field</span></code>, <code class="docutils literal notranslate"><span class="pre">intent</span></code>, and <code class="docutils literal notranslate"><span class="pre">spw</span></code> parameters.</p></li>
<li><p>Source fluxes are determined for each spw and source combination.</p></li>
<li><p>Fluxes in Jy are derived from the pipeline context.</p></li>
<li><p>Pipeline context fluxes are derived from the online flux calibrator
catalog, the ASDM, or the user via the flux.csv file.</p></li>
<li><p>If no fluxes are available the task terminates.</p></li>
<li><p>Atmospheric calibration and observations scans are determined for each
spw and source combination.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">intent</span></code> is set to ‘PHASE’ are there are no atmospheric scans
associated with the ‘PHASE’ calibrator, ‘TARGET’ atmospheric scans will be
used instead.</p></li>
<li><p>If atmospheric scans cannot be associated with any of the spw and source
combinations the task terminates.</p></li>
<li><p>Science spws are mapped to atmospheric spws for each science spw and
source combination.</p></li>
<li><p>If mappings cannot be determined for any of the spws the task terminates.</p></li>
<li><p>The median Tsys value for each atmospheric spw and source combination is
determined from the SYSCAL table. Medians are computed first by channel,
then by antenna, in order to reduce sensitivity to deviant values.</p></li>
<li><p>The science spw parameters, exposure time(s), and integration time(s) are
determined.</p></li>
<li><p>The phase-up time interval, in time units and number of integrations
required to meet the <code class="docutils literal notranslate"><span class="pre">phaseupsnr</span></code> are computed, along with the
sensitivity in mJy and the signal-to-noise per integration. Nominal Tsys
and sensitivity values per receiver band provided by the ALMA project are
used for this estimate.</p></li>
<li><p>Warnings are issued if estimated phase-up gain time solution would contain
fewer than <code class="docutils literal notranslate"><span class="pre">minphaseupints</span></code> solutions.</p></li>
<li><p>The frequency interval, in MHz and number of channels required to meet the
<code class="docutils literal notranslate"><span class="pre">bpsnr</span></code> are computed, along with the per channel sensitivity in mJy and
the per channel signal-to-noise. Nominal Tsys and sensitivity values per
receiver band provided by the ALMA project are used for this estimate.</p></li>
<li><p>Warnings are issued if estimated bandpass solution would contain fewer
than <code class="docutils literal notranslate"><span class="pre">minbpnchan</span></code> solutions.</p></li>
<li><p>If strong atmospheric features are detected in the Tsys spectrum for a
given spw, the frequency interval of bandpass solution is recalculated to
meet the lower threshold, <code class="docutils literal notranslate"><span class="pre">minbpsnr</span></code> - i.e. a lower snr is tolerated in
order to preserve enough frequency intervals to capture the atmospheric
line.</p></li>
</ul>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>example: vis=[‘M82A.ms’, ‘M82B.ms’]</p>
</dd>
<dt>field</dt><dd><p>The list of field names of sources to be used for
signal-to-noise estimation. Defaults to all fields with the
standard intent.</p>
<p>example: field=’3C279’</p>
</dd>
<dt>intent</dt><dd><p>A string containing a comma delimited list of intents against
which the selected fields are matched. Defaults to
‘BANDPASS’.</p>
<p>example: intent=’PHASE’</p>
</dd>
<dt>spw</dt><dd><p>The list of spectral windows and channels for which gain
solutions are computed. Defaults to all the science spectral
windows for which there are both ‘intent’ and TARGET intents.</p>
<p>example: spw=’13,15’</p>
</dd>
<dt>phaseupsnr</dt><dd><p>The required phase-up gain time interval solution
signal-to-noise.</p>
<p>example: phaseupsnr=10.0</p>
</dd>
<dt>minphaseupints</dt><dd><p>The minimum number of time intervals in the phase-up gain
solution.</p>
<p>example: minphaseupints=4</p>
</dd>
<dt>evenbpints</dt><dd><p>Use a bandpass frequency solint that is an integer divisor of
the spw bandwidth, to prevent the occurrence of one narrower
fractional frequency interval.</p>
</dd>
<dt>bpsnr</dt><dd><p>The required bandpass frequency interval solution
signal-to-noise.</p>
<p>example: bpsnr=30.0</p>
</dd>
<dt>minbpsnr</dt><dd><p>The minimum required bandpass frequency interval solution
signal-to-noise when strong atmospheric lines exist in Tsys
spectra.</p>
<p>example: minbpsnr=10.0</p>
</dd>
<dt>minbpnchan</dt><dd><p>The minimum number of frequency intervals in the bandpass
solution.</p>
<p>example: minbpnchan=16</p>
</dd>
<dt>hm_nantennas</dt><dd><p>The heuristics for determines the number of antennas to use
in the signal-to-noise estimate. The options are ‘all’ and
‘unflagged’. The ‘unflagged’ options is not currently
supported.</p>
<p>example: hm_nantennas=’unflagged’</p>
</dd>
<dt>maxfracflagged</dt><dd><p>The maximum fraction of an antenna that can be flagged before
it is excluded from the signal-to-noise estimate.</p>
<p>example: maxfracflagged=0.80</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Estimate the phaseup gain time interval and the bandpass frequency
interval required to match the desired signal-to-noise for bandpass
solutions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_bpsolint</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_diffgaincal">
<span class="sig-name descname"><span class="pre">hifa_diffgaincal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_diffgaincal.html#hifa_diffgaincal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_diffgaincal" title="Link to this definition"></a></dt>
<dd><p>hifa_diffgaincal —- Derive SpW phase offsets from differential gain calibrator.</p>
<p>This task creates the spectral window phase gain offset table used to allow
calibrating the “on-source” spectral setup with phase gains from a
“reference” spectral setup. A bright point source Quasar, called the
Differential Gain Calibrator (DIFFGAIN) source, is used for this purpose.
This DIFFGAIN source typically observed in groups of interleaved “reference”
and “on-source” scans, once at the start and once at the end of the
observations. In very long observations, there may be a group of scans
occurring during the middle. Scan groups are combined while solving for SpW
offsets between “reference” and “on-source” spectral setups.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: [‘M32A.ms’, ‘M32B.ms’]</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Derive SpW phase offsets from differential gain calibrator.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_diffgaincal</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_exportdata">
<span class="sig-name descname"><span class="pre">hifa_exportdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imaging_products_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exportmses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pprfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calintents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calimages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetimages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">products_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_exportdata.html#hifa_exportdata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_exportdata" title="Link to this definition"></a></dt>
<dd><p>hifa_exportdata —- Prepare interferometry data for export</p>
<p>Prepare interferometry data for export.</p>
<p>The hifa_exportdata task for ALMA CASA pipeline exports the data defined
in the pipeline context and exports it to the data products directory,
converting and or packing it as necessary.</p>
<p>The current version of the task exports the following products</p>
<ul class="simple">
<li><p>an XML file containing the pipeline processing request</p></li>
<li><p>a tar file per ASDM / MS containing the final flags version</p></li>
<li><p>a text file per ASDM / MS containing the final calibration apply list</p></li>
<li><p>a FITS image for each selected calibrator source image</p></li>
<li><p>a FITS image for each selected science target source image</p></li>
<li><p>a tar file per session containing the caltables for that session</p></li>
<li><p>a tar file containing the file web log</p></li>
<li><p>a text file containing the final list of CASA commands</p></li>
<li><p>an XML “manifest” file listing the products</p></li>
<li><p>an XML “aquareport” file listing the QA scores and sub-scores,
image sensitivities, and other numerical information</p></li>
</ul>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of visibility data files for which flagging and calibration
information will be exported. Defaults to the list maintained in the
pipeline context.</p>
<p>Example: vis=[‘X227.ms’, ‘X228.ms’]</p>
</dd>
<dt>session</dt><dd><p>List of sessions one per visibility file. Currently defaults
to a single virtual session containing all the visibility files in vis.
In the future, this will default to the set of observing sessions defined
in the context.</p>
<p>Example: session=[‘session1’, ‘session2’]</p>
</dd>
<dt>imaging_products_only</dt><dd><p>Export science target imaging products only</p>
</dd>
<dt>exportmses</dt><dd><p>Export the final MeasurementSets instead of the final flags,
calibration tables, and calibration instructions.</p>
</dd>
<dt>pprfile</dt><dd><p>Name of the pipeline processing request to be exported. Defaults
to a file matching the template ‘PPR_*.xml’.</p>
<p>Example: pprfile=[‘PPR_GRB021004.xml’]</p>
</dd>
<dt>calintents</dt><dd><p>List of calibrator image types to be exported. Defaults to
all standard calibrator intents, ‘BANDPASS’, ‘PHASE’, ‘FLUX’.</p>
<p>Example: ‘PHASE’</p>
</dd>
<dt>calimages</dt><dd><p>List of calibrator images to be exported. Defaults to all
calibrator images recorded in the pipeline context.</p>
<p>Example: calimages=[‘3C454.3.bandpass’, ‘3C279.phase’]</p>
</dd>
<dt>targetimages</dt><dd><p>List of science target images to be exported. Defaults to all
science target images recorded in the pipeline context.</p>
<p>Example: targetimages=[‘NGC3256.band3’, ‘NGC3256.band6’]</p>
</dd>
<dt>products_dir</dt><dd><p>Name of the data products subdirectory. Defaults to ‘./’.</p>
<p>Example: products_dir=’../products’</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Export the pipeline results for a single session to the data products
directory:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; !mkdir ../products
&gt;&gt;&gt; hif_exportdata(products_dir=&#39;../products&#39;)
</pre></div>
</div>
<p>2. Export the pipeline results to the data products directory specify that
only the gain calibrator images be saved:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; !mkdir ../products
&gt;&gt;&gt; hif_exportdata(products_dir=&#39;../products&#39;, calintents=&#39;*PHASE*&#39;)
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_flagdata">
<span class="sig-name descname"><span class="pre">hifa_flagdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autocorr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shadow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scannumber</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgespw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracspw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracspwfps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">online</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partialpol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowtrans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mintransrepspw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mintransnonrepspws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fileonline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetemplate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_tbuff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tbuff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flagbackup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_flagdata.html#hifa_flagdata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_flagdata" title="Link to this definition"></a></dt>
<dd><p>hifa_flagdata —- Do metadata based flagging of a list of MeasurementSets.</p>
<p>The hifa_flagdata data performs basic flagging operations on a list of
measurements including:</p>
<ul class="simple">
<li><p>applying online flags</p></li>
<li><p>applying a flagging template</p></li>
<li><p>partial polarization flagging</p></li>
<li><p>autocorrelation data flagging</p></li>
<li><p>shadowed antenna data flagging</p></li>
<li><p>scan-based flagging by intent or scan number</p></li>
<li><p>edge channel flagging, as needed</p></li>
<li><p>low atmospheric transmission flagging</p></li>
</ul>
<p>About the spectral window edge channel flagging:</p>
<ul class="simple">
<li><p>For TDM spectral windows, a number of edge channels are always flagged,
according to the <code class="docutils literal notranslate"><span class="pre">fracspw</span></code> and <code class="docutils literal notranslate"><span class="pre">fracspwfps</span></code> parameters (the latter
operates only on spectral windows with 62, 124, or 248 channels). With the
default setting of <code class="docutils literal notranslate"><span class="pre">fracspw</span></code>, the number of channels flagged on each edge
is 2, 4, or 8 for 64, 128, or 256-channel spectral windows, respectively.</p></li>
<li><p>For most FDM spectral windows, no edge flagging is done. The only exceptions
are ACA spectral windows that encroach too close to the baseband edge.
Channels that lie closer to the baseband edge than the following values are
flagged: 62.5, 40, 20, 10, and 5 MHz for spectral windows with bandwidths of
1000, 500, 250, 125, and 62.5 MHz, respectively. A warning is generated in
the weblog if flagging occurs due to proximity to the baseband edge.
By definition, 2000 MHz spectral windows always encroach the baseband edge on
both sides of the spectral window, and thus are always flagged on both sides
in order to achieve 1875 MHz bandwidth (in effect, they are flagged by
62.5 MHz on each side), and thus no warning is generated.</p></li>
</ul>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets defined in the pipeline context.</p>
</dd>
<dt>autocorr</dt><dd><p>Flag autocorrelation data.</p>
</dd>
<dt>shadow</dt><dd><p>Flag shadowed antennas.</p>
</dd>
<dt>tolerance</dt><dd><p>Amount of antenna shadowing tolerated, in meters. A positive number
allows antennas to overlap in projection. A negative number forces antennas
apart in projection. Zero implies a distance of radius_1+radius_2 between
antenna centers.</p>
</dd>
<dt>scan</dt><dd><p>Flag a list of specified scans.</p>
</dd>
<dt>scannumber</dt><dd><p>A string containing a comma delimited list of scans to be
flagged.</p>
<p>Example: scannumber=’3,5,6’</p>
</dd>
<dt>intents</dt><dd><p>A string containing a comma delimited list of intents against
which the scans to be flagged are matched.</p>
<p>Example: intents=’<cite>*BANDPASS*</cite>’</p>
</dd>
<dt>edgespw</dt><dd><p>Flag the edge spectral window channels.</p>
</dd>
<dt>fracspw</dt><dd><p>Fraction of channels to flag at both edges of TDM spectral windows.</p>
</dd>
<dt>fracspwfps</dt><dd><p>Fraction of channels to flag at both edges of ACA TDM
spectral windows that were created with the earlier (original)
implementation of the frequency profile synthesis (FPS) algorithm.</p>
</dd>
<dt>online</dt><dd><p>Apply the online flags.</p>
</dd>
<dt>partialpol</dt><dd><p>Identify integrations in multi-polarisation data where part
of the polarization products are already flagged, and flag the other
polarization products in those integrations.</p>
</dd>
<dt>lowtrans</dt><dd><p>Flag spectral windows for which a significant fraction of
the channels have atmospheric transmission below the
threshold (<code class="docutils literal notranslate"><span class="pre">mintransrepspw</span></code>, <code class="docutils literal notranslate"><span class="pre">mintransnonrepspws</span></code>).</p>
</dd>
<dt>mintransnonrepspws</dt><dd><p>This atmospheric transmissivity threshold is used to flag
a non-representative science spectral window when more than 60% of
its channels have a transmissivity below this level.</p>
</dd>
<dt>mintransrepspw</dt><dd><p>This atmospheric transmissivity threshold is used to flag the
representative science spectral window when more than 60% of its channels
have a transmissivity below this level.</p>
</dd>
<dt>fileonline</dt><dd><p>File containing the online flags. These are computed by the
h_init or hif_importdata data tasks. If the online flags files
are undefined a name of the form ‘msname.flagonline.txt’ is assumed.</p>
</dd>
<dt>template</dt><dd><p>Apply flagging templates</p>
</dd>
<dt>filetemplate</dt><dd><p>The name of a text file that contains the flagging template
for RFI, birdies, telluric lines, etc. If the template flags files
is undefined a name of the form ‘msname.flagtemplate.txt’ is assumed.</p>
</dd>
<dt>hm_tbuff</dt><dd><p>The heuristic for computing the default time interval padding
parameter. The options are ‘halfint’ and ‘manual’. In ‘halfint’ mode tbuff
is set to half the maximum of the median integration time of the science
and calibrator target observations. The value of 0.048 seconds is
subtracted from the lower time limit to accommodate the behavior of the
ALMA Control system.</p>
</dd>
<dt>tbuff</dt><dd><p>The time in seconds used to pad flagging command time
intervals if <code class="docutils literal notranslate"><span class="pre">hm_tbuff</span></code> = ‘manual’. The default in
manual mode is no flagging.</p>
</dd>
<dt>qa0</dt><dd><p>QA0 flags.</p>
</dd>
<dt>qa2</dt><dd><p>QA2 flags.</p>
</dd>
<dt>flagbackup</dt><dd><p>Back up any pre-existing flags.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Do basic flagging on a MeasurementSet:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_flagdata</span><span class="p">()</span>
</pre></div>
</div>
<p>2. Do basic flagging on a MeasurementSet flagging additional scans selected
by number as well:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_flagdata</span><span class="p">(</span><span class="n">scannumber</span><span class="o">=</span><span class="s1">&#39;13,18&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_flagtargets">
<span class="sig-name descname"><span class="pre">hifa_flagtargets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetemplate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flagbackup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_flagtargets.html#hifa_flagtargets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_flagtargets" title="Link to this definition"></a></dt>
<dd><p>hifa_flagtargets —- Do science target flagging</p>
<p>The hifa_flagtargets task performs basic flagging operations on a list of
science target MeasurementSets, including:</p>
<ul class="simple">
<li><p>applying a flagging template</p></li>
</ul>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl class="simple">
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list
of MeasurementSets defined in the pipeline context.</p>
</dd>
<dt>template</dt><dd><p>Apply flagging templates; defaults to True.</p>
</dd>
<dt>filetemplate</dt><dd><p>The name of a text file that contains the flagging
template for issues with the science target data etc.
If the template flags files is undefined a name of the
form ‘msname_flagtargetstemplate.txt’ is assumed.</p>
</dd>
<dt>flagbackup</dt><dd><p>Back up any pre-existing flags; defaults to False.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Do basic flagging on a science target MeasurementSet:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_flagtargets</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_fluxcalflag">
<span class="sig-name descname"><span class="pre">hifa_fluxcalflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">appendlines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linesfiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">applyflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_fluxcalflag.html#hifa_fluxcalflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_fluxcalflag" title="Link to this definition"></a></dt>
<dd><p>hifa_fluxcalflag —- Locate and flag line regions in solar system flux calibrators</p>
<p>Search the built-in solar system flux calibrator line catalog for overlaps with
the science spectral windows. Generate a list of line overlap regions and
flagging commands.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets defined in the pipeline context.</p>
</dd>
<dt>field</dt><dd><p>The list of field names or field ids for which the models are
to be set. Defaults to all fields with intent ‘AMPLITUDE’.</p>
<p>Example: field=’3C279’, field=’3C279, M82’</p>
</dd>
<dt>intent</dt><dd><p>A string containing a comma delimited list of intents against
which the selected fields are matched. Defaults to all data
with amplitude intent.</p>
<p>Example: intent=’AMPLITUDE’</p>
</dd>
<dt>spw</dt><dd><p>Spectral windows and channels for which bandpasses are
computed. Defaults to all science spectral windows.</p>
<p>Example: spw=’11,13,15,17’</p>
</dd>
<dt>threshold</dt><dd><p>If the fraction of a spectral window occupied by line regions
is greater than this threshold value, then flag the entire
spectral window.</p>
</dd>
<dt>appendlines</dt><dd><p>Append user defined line regions to the line dictionary.</p>
</dd>
<dt>linesfile</dt><dd><p>Read in a file containing lines regions and append it to the
builtin dictionary. Blank lines and comments beginning with #
are skipped. The data is contained in 4 whitespace delimited
fields containing the solar system object field name, e.g.
‘Callisto’, the molecular species name, e.g. ‘13CO’, and the
starting and ending frequency in GHz.</p>
</dd>
<dt>applyflags</dt><dd><p>Boolean for whether to apply the generated flag commands. (default True)</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Locate known lines in any solar system object flux calibrators:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_fluxcalflag</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_gaincalsnr">
<span class="sig-name descname"><span class="pre">hifa_gaincalsnr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phasesnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bwedgefrac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_nantennas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxfracflagged</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_gaincalsnr.html#hifa_gaincalsnr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_gaincalsnr" title="Link to this definition"></a></dt>
<dd><p>hifa_gaincalsnr —- Compute gaincal signal-to-noise ratios per spw</p>
<p>The gaincal solution signal-to-noise is determined as follows:</p>
<ul class="simple">
<li><p>For each data set the list of source(s) to use for the per-scan gaincal
solution signal-to-noise estimation is compiled based on the values of the
field, intent, and spw parameters.</p></li>
<li><p>Source fluxes are determined for each spw and source combination.</p></li>
<li><p>Fluxes in Jy are derived from the pipeline context.</p></li>
<li><p>Pipeline context fluxes are derived from the online flux calibrator
catalog, the ASDM, or the user via the flux.csv file.</p></li>
<li><p>If no fluxes are available the task terminates.</p></li>
<li><p>Atmospheric calibration and observations scans are determined for each spw
and source combination.</p></li>
<li><p>If intent is set to ‘PHASE’ are there are no atmospheric scans associated
with the ‘PHASE’ calibrator, ‘TARGET’ atmospheric scans will be used
instead.</p></li>
<li><p>If atmospheric scans cannot be associated with any of the spw and source
combinations the task terminates.</p></li>
<li><p>Science spws are mapped to atmospheric spws for each science spw and
source combinations.</p></li>
<li><p>If mappings cannot be determined for any of the spws the task terminates.</p></li>
<li><p>The median Tsys value for each atmospheric spw and source combination is
determined from the SYSCAL table. Medians are computed first by channel,
then by antenna, in order to reduce sensitivity to deviant values.</p></li>
<li><p>The science spw parameters, exposure time(s), and integration time(s) are
determined.</p></li>
<li><p>The per scan sensitivity and signal-to-noise estimates are computed per
science spectral window. Nominal Tsys and sensitivity values per receiver
band provide by the ALMA project are used for this estimate.</p></li>
<li><p>The QA score is based on how many signal-to-noise estimates greater than
the requested signal-to-noise ratio can be computed.</p></li>
</ul>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘M82A.ms’, ‘M82B.ms’]</p>
</dd>
<dt>field</dt><dd><p>The list of field names of sources to be used for signal to noise
estimation. Defaults to all fields with the standard intent.</p>
<p>Example: field=’3C279’</p>
</dd>
<dt>intent</dt><dd><p>A string containing a comma delimited list of intents against which
the selected fields are matched. Defaults to ‘PHASE’.</p>
<p>Example: intent=’BANDPASS’</p>
</dd>
<dt>spw</dt><dd><p>The list of spectral windows and channels for which gain solutions are
computed. Defaults to all the science spectral windows for which there are
both ‘intent’ and TARGET intents.</p>
<p>Example: spw=’13,15’</p>
</dd>
<dt>phasesnr</dt><dd><p>The required gaincal solution signal to noise.</p>
<p>Example: phasesnr=20.0</p>
</dd>
<dt>bwedgefrac</dt><dd><p>The fraction of the bandwidth edges that is flagged.</p>
<p>Example: bwedgefrac=0.0</p>
</dd>
<dt>hm_nantennas</dt><dd><p>The heuristics for determines the number of antennas to use
in the signal to noise estimate. The options are ‘all’ and ‘unflagged’.
The ‘unflagged’ options is not currently supported.</p>
<p>Example: hm_nantennas=’unflagged’</p>
</dd>
<dt>maxfracflagged</dt><dd><p>The maximum fraction of an antenna that can be flagged
before it is excluded from the signal to noise estimate.</p>
<p>Example: maxfracflagged=0.80</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Estimate the per scan gaincal solution sensitivities and signal to noise
ratios for all the science spectral windows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_gaincalsnr</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_gfluxscale">
<span class="sig-name descname"><span class="pre">hifa_gfluxscale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transfer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refintent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transintent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refspwmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reffile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupsolint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_resolvecals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_outlier_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_gfluxscale.html#hifa_gfluxscale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_gfluxscale" title="Link to this definition"></a></dt>
<dd><p>hifa_gfluxscale —- Derive flux density scales from standard calibrators</p>
<p>Derive flux densities for point source transfer calibrators using flux models
for reference calibrators.</p>
<p>Flux values are determined by:</p>
<ul class="simple">
<li><p>computing phase only solutions for all the science spectral windows
using the calibrator data selected by the <code class="docutils literal notranslate"><span class="pre">reference</span></code> and <code class="docutils literal notranslate"><span class="pre">refintent</span></code>
parameters and the <code class="docutils literal notranslate"><span class="pre">transfer</span></code> and <code class="docutils literal notranslate"><span class="pre">transintent</span></code> parameters, the value
of the <code class="docutils literal notranslate"><span class="pre">phaseupsolint</span></code> parameter, and any spw combination determined
in hifa_spwphaseup.</p></li>
<li><p>computing complex amplitude only solutions for all the science spectral
windows using calibrator data selected with <code class="docutils literal notranslate"><span class="pre">reference</span></code> and
<code class="docutils literal notranslate"><span class="pre">refintent</span></code> parameters and the <code class="docutils literal notranslate"><span class="pre">transfer</span></code> and <code class="docutils literal notranslate"><span class="pre">transintent</span></code>
parameters, the value of the <code class="docutils literal notranslate"><span class="pre">solint</span></code> parameter.</p></li>
<li><p>examining the amplitude-only solutions for obvious outliers and flagging
them in the caltable.</p></li>
<li><p>transferring the flux scale from the reference calibrators to the transfer
calibrators using <code class="docutils literal notranslate"><span class="pre">refspwmap</span></code> for windows without data in the reference
calibrators.</p></li>
<li><p>inserting the computed flux density values into the MODEL_DATA column.</p></li>
</ul>
<p>Resolved calibrators are handled via antenna selection either automatically
(<code class="docutils literal notranslate"><span class="pre">hm_resolvedcals</span></code> = ‘automatic’) or manually (<code class="docutils literal notranslate"><span class="pre">hm_resolvedcals</span></code> =
‘manual’). In the former case, antennas closer to the reference antenna than
the uv distance where visibilities fall to <code class="docutils literal notranslate"><span class="pre">peak_fraction</span></code> of the peak are
used. In manual mode, the antennas specified in <code class="docutils literal notranslate"><span class="pre">antenna</span></code> are used.</p>
<p>Note that the flux corrected calibration table computed internally is
not currently used in later pipeline apply calibration steps.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: [‘M32A.ms’, ‘M32B.ms’]</p>
</dd>
<dt>reference</dt><dd><p>A string containing a comma delimited list of field names
defining the reference calibrators. Defaults to field names with
intent ‘<cite>*AMP*</cite>’.</p>
<p>Example: reference=’M82,3C273’</p>
</dd>
<dt>transfer</dt><dd><p>A string containing a comma delimited list of field names
defining the transfer calibrators. Defaults to field names with
intent ‘<cite>*PHASE*</cite>’.</p>
<p>Example: transfer=’J1328+041,J1206+30’</p>
</dd>
<dt>refintent</dt><dd><p>A string containing a comma delimited list of intents
used to select the reference calibrators. Defaults to ‘AMPLITUDE’.</p>
<p>Example: refintent=’’, refintent=’AMPLITUDE’</p>
</dd>
<dt>transintent</dt><dd><p>A string containing a comma delimited list of intents
defining the transfer calibrators. Defaults to
‘PHASE,BANDPASS,CHECK,POLARIZATION,POLANGLE,POLLEAKAGE’.</p>
<p>Example: transintent=’’, transintent=’PHASE,BANDPASS’</p>
</dd>
<dt>refspwmap</dt><dd><p>Vector of spectral window ids enabling scaling across
spectral windows. Defaults to no scaling.</p>
<p>Example: refspwmap=[1,1,3,3] - (4 spws, reference fields in 1 and 3, transfer
fields in 0,1,2,3</p>
</dd>
<dt>reffile</dt><dd><p>Path to a file containing flux densities for calibrators.
Setjy will be run for any that have both reference and transfer intents.
Values given in this file will take precedence over MODEL column values
set by previous tasks. By default, the path is set to the CSV file created
by hifa_importdata, consisting of catalogue fluxes extracted from the ASDM
and / or edited by the user.</p>
<p>example: reffile=’’, reffile=’working/flux.csv’</p>
</dd>
<dt>phaseupsolint</dt><dd><p>Time solution intervals in CASA syntax for the phase solution.</p>
<p>example: phaseupsolint=’inf’, phaseupsolint=’int’, phaseupsolint=’100sec’</p>
</dd>
<dt>solint</dt><dd><p>Time solution intervals in CASA syntax for the amplitude solution.</p>
<p>example: solint=’inf’, solint=’int’, solint=’100sec’</p>
</dd>
<dt>minsnr</dt><dd><p>Minimum signal-to-noise ratio for gain calibration solutions.</p>
<p>example: minsnr=1.5, minsnr=0.0</p>
</dd>
<dt>refant</dt><dd><p>A string specifying the reference antenna(s). By default,
this is read from the context.</p>
<p>Example: refant=’DV05’</p>
</dd>
<dt>hm_resolvedcals</dt><dd><p>Heuristics method for handling resolved calibrators. The
options are ‘automatic’ and ‘manual’. In automatic mode,
antennas closer to the reference antenna than the uv
distance where visibilities fall to <code class="docutils literal notranslate"><span class="pre">peak_fraction</span></code> of the
peak are used. In manual mode, the antennas specified in
<code class="docutils literal notranslate"><span class="pre">antenna</span></code> are used.</p>
</dd>
<dt>antenna</dt><dd><p>A comma delimited string specifying the antenna names or ids
to be used for the fluxscale determination. Used in
<code class="docutils literal notranslate"><span class="pre">hm_resolvedcals</span></code> = ‘manual’ mode.</p>
<p>Example: antenna=’DV16,DV07,DA12,DA08’</p>
</dd>
<dt>peak_fraction</dt><dd><p>The limiting UV distance from the reference antenna for
antennas to be included in the flux calibration. Defined as
the point where the calibrator visibilities have fallen to
<code class="docutils literal notranslate"><span class="pre">peak_fraction</span></code> of the peak value.</p>
</dd>
<dt>amp_outlier_sigma</dt><dd><p>Sigma threshold used to identify outliers in the amplitude
caltable. Default: 50.0</p>
<p>Example: amp_outlier_sigma=30.0</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Compute flux values for the phase calibrator using model data from
the amplitude calibrator:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_gfluxscale</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_gfluxscaleflag">
<span class="sig-name descname"><span class="pre">hifa_gfluxscaleflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseupsolint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antnegsig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antpossig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmantint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antblnegsig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antblpossig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relaxed_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_gfluxscaleflag.html#hifa_gfluxscaleflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_gfluxscaleflag" title="Link to this definition"></a></dt>
<dd><p>hifa_gfluxscaleflag —- Flag the flux, diffgain, phase calibrators and check source</p>
<p>This task computes the flagging heuristics on the flux, diffgain, and phase
calibrators and the check source, by calling hif_correctedampflag which
looks for outlier visibility points by statistically examining the scalar
difference of corrected amplitudes minus model amplitudes, and flags those
outliers. The philosophy is that only outlier data points that have remained
outliers after calibration will be flagged. The heuristic works equally well
on resolved calibrators and point sources because it is not performing a
vector difference, and thus is not sensitive to nulls in the flux density
vs. uvdistance domain. Note that the phase of the data is not assessed.</p>
<p>In further detail, the workflow is as follows: a snapshot of the flagging
state is preserved at the start, a preliminary phase and amplitude gaincal
solution is solved and applied, the flagging heuristics are run and
any outliers are marked for flagging, the flagging state is restored from the
snapshot. If any outliers were found, then these are flagged. Plots are
generated at two points in this workflow: after preliminary phase and
amplitude calibration but before flagging heuristics are run, and after
flagging heuristics have been run and applied. If no points were flagged,
the ‘after’ plots are not generated or displayed. The score for this stage
is the standard data flagging score, which depends on the fraction of data
flagged.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘M51.ms’]</p>
</dd>
<dt>intent</dt><dd><p>A string containing a comma delimited list of intents against
which the selected fields are matched. If undefined (default), it
will select all data with the AMPLITUDE, PHASE, and CHECK intents,
except for one case: if one of the AMPLITUDE intent fields was also
used for BANDPASS, then this task will select only data with PHASE
and CHECK intents.</p>
<p>Example: intent=’<cite>*PHASE*</cite>’</p>
</dd>
<dt>phaseupsolint</dt><dd><p>The phase correction solution interval in CASA syntax.</p>
<p>Example: phaseupsolint=’300s’</p>
</dd>
<dt>solint</dt><dd><p>Time and channel solution intervals in CASA syntax.</p>
<p>Example: solint=’inf,10ch’, solint=’inf’</p>
</dd>
<dt>minsnr</dt><dd><p>Solutions below this SNR are rejected.</p>
</dd>
<dt>refant</dt><dd><p>Reference antenna names. Defaults to the value(s) stored in the
pipeline context. If undefined in the pipeline context defaults to
the CASA reference antenna naming scheme.</p>
<p>Example: refant=’DV01’, refant=’DV06,DV07’</p>
</dd>
<dt>antnegsig</dt><dd><p>Lower sigma threshold for identifying outliers as a result of
bad antennas within individual timestamps.</p>
<p>Example: antnegsig=4.0</p>
</dd>
<dt>antpossig</dt><dd><p>Upper sigma threshold for identifying outliers as a result of
bad antennas within individual timestamps.</p>
<p>Example: antpossig=4.6</p>
</dd>
<dt>tmantint</dt><dd><p>Threshold for maximum fraction of timestamps that are allowed to
contain outliers.</p>
<p>Example: tmantint=0.063</p>
</dd>
<dt>tmint</dt><dd><p>Threshold for maximum fraction of “outlier timestamps” over
“total timestamps” that a baseline may be a part of.</p>
<p>Example: tmint=0.085</p>
</dd>
<dt>tmbl</dt><dd><p>Initial threshold for maximum fraction of “bad baselines” over “all
baselines” that an antenna may be a part of.</p>
<p>Example: tmbl=0.175</p>
</dd>
<dt>antblnegsig</dt><dd><p>Lower sigma threshold for identifying outliers as a result of
“bad baselines” and/or “bad antennas” within baselines, across all
timestamps.</p>
<p>Example: antblnegsig=3.4</p>
</dd>
<dt>antblpossig</dt><dd><p>Threshold for identifying outliers as a result of
“bad baselines” and/or “bad antennas” within baselines, across all
timestamps.</p>
<p>Example: antblpossig=3.2</p>
</dd>
<dt>relaxed_factor</dt><dd><p>Relaxed value to set the threshold scaling factor to under
certain conditions (see task description).</p>
<p>Example: relaxed_factor=2.0</p>
</dd>
<dt>niter</dt><dd><p>Maximum number of times to iterate on evaluation of flagging
heuristics. If an iteration results in no new flags, then subsequent
iterations are skipped.</p>
<p>Example: niter=2</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. run with recommended settings to create flux scale calibration with flagging
using recommended thresholds:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_gfluxscaleflag</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_imageprecheck">
<span class="sig-name descname"><span class="pre">hifa_imageprecheck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired_angular_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calcsb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_imageprecheck.html#hifa_imageprecheck"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_imageprecheck" title="Link to this definition"></a></dt>
<dd><p>hifa_imageprecheck —- Calculates the best Briggs robust parameter to achieve sensitivity and angular resolution goals.</p>
<p>In this task, the representative source and the spw containing the representative
frequency selected by the PI in the OT are used to calculate the synthesized beam
and to make sensitivity estimates for the aggregate bandwidth and representative
bandwidth for several values of the Briggs robust parameter. This information is
reported in a table in the weblog. If no representative target/frequency information
is available, it defaults to the first target and center of first spw in the data
(e.g. pre-Cycle 5 data does not have this information available). The best Briggs
robust parameter to achieve the PI’s desired angular resolution is chosen
automatically. See the User’s guide for further details.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl class="simple">
<dt>vis                              The list of input MeasurementSets. Defaults to the list of</dt><dd><p>MeasurementSets specified in the h_init or hif_importdata task.
‘’: use all MeasurementSets in the context
Examples: ‘ngc5921.ms’, [‘ngc5921a.ms’, ngc5921b.ms’, ‘ngc5921c.ms’]</p>
</dd>
<dt>desired_angular_resolution       User specified angular resolution goal string. When this</dt><dd><p>parameter is set, uvtapering may be performed.
‘’: automatic from performance parameters (default)
Example: ‘1.0arcsec’</p>
</dd>
</dl>
<p>calcsb                           Force (re-)calculation of sensitivities and beams; defaults to False
parallel                         Use MPI cluster where possible</p>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>run with recommended settings to perform checks prior to imaging:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_imageprecheck</span><span class="p">()</span>
</pre></div>
</div>
<p>2. run to perform checks prior to imaging and force the re-calculation of
sensitivities and beams:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_imageprecheck</span><span class="p">(</span><span class="n">calcsb</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_importdata">
<span class="sig-name descname"><span class="pre">hifa_importdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_caldevice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bdfflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datacolumns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dbservice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ocorr_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">createmms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minparang</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_importdata.html#hifa_importdata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_importdata" title="Link to this definition"></a></dt>
<dd><p>hifa_importdata —- Imports data into the interferometry pipeline</p>
<p>The hifa_importdata task loads the specified visibility data into the pipeline
context unpacking and / or converting it as necessary.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> input parameter is set to False and the task is asked
to convert an input ASDM input to an MS, then when the output MS already
exists in the output directory, the importasdm conversion step is skipped,
and the existing MS will be imported instead.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of visibility data files. These may be ASDMs, tar
files of ASDMs, MSes, or tar files of MSes. If ASDM files
are specified, they will be converted to MS format.</p>
<p>Example: vis=[‘X227.ms’, ‘asdms.tar.gz’]</p>
</dd>
<dt>session</dt><dd><p>List of session names, one for each visibility dataset,
used to group the MSes into sessions.</p>
<p>Example: session=[‘session_1’, ‘session_2’]</p>
</dd>
<dt>asis</dt><dd><p>Creates verbatim copies of the ASDM tables in the output MS.
The value given to this option must be a list of table names
separated by space characters.</p>
</dd>
<dt>process_caldevice</dt><dd><p>Import the caldevice table from the ASDM.</p>
</dd>
<dt>overwrite</dt><dd><p>Overwrite existing files on import; defaults to False.
When converting ASDM to MS, if overwrite=False and the MS
already exists in the output directory, then this existing
MS dataset will be used instead.</p>
<p>Example: overwrite=True</p>
</dd>
<dt>nocopy</dt><dd><p>Disable copying of MS to working directory; defaults to
False.</p>
<p>Example: nocopy=True</p>
</dd>
<dt>bdfflags</dt><dd><p>Apply BDF flags on import.</p>
</dd>
<dt>datacolumns</dt><dd><p>Dictionary defining the data types of existing columns.
The format is:</p>
<p>{‘data’: ‘data type 1’}</p>
<p>or</p>
<p>{‘data’: ‘data type 1’, ‘corrected’: ‘data type 2’}</p>
<p>For ASDMs the data type can only be RAW and one
can only specify it for the data column.</p>
<p>For MSes one can define two different data types
for the DATA and CORRECTED_DATA columns and they
can be any of the known data types (RAW,
REGCAL_CONTLINE_ALL, REGCAL_CONTLINE_SCIENCE,
SELFCAL_CONTLINE_SCIENCE, REGCAL_LINE_SCIENCE,
SELFCAL_LINE_SCIENCE, BASELINED, ATMCORR). The
intent selection strings _ALL or _SCIENCE can be
skipped. In that case the task determines this
automatically by inspecting the existing intents
in the dataset.</p>
<p>Usually, a single datacolumns dictionary is used
for all datasets. If necessary, one can define a
list of dictionaries, one for each EB, with
different setups per EB.</p>
<p>If no types are specified,
{‘data’:’raw’,’corrected’:’regcal_contline’}
or {‘data’:’raw’} will be assumed, depending on
whether the corrected column exists or not.</p>
</dd>
<dt>lazy</dt><dd><p>Use the lazy filler import.</p>
</dd>
<dt>dbservice</dt><dd><p>Use the online flux catalog.</p>
</dd>
<dt>ocorr_mode</dt><dd><p>ALMA default set to ca.</p>
</dd>
<dt>createmms</dt><dd><p>Create an MMS.</p>
</dd>
<dt>minparang</dt><dd><p>Minimum required parallactic angle range for polarisation
calibrator, in degrees. The default of 0.0 is used for
non-polarisation processing.</p>
</dd>
<dt>parallel</dt><dd><p>Execute using CASA HPC functionality, if available.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Load an ASDM list in the ../rawdata subdirectory into the context:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_importdata</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;../rawdata/uid___A002_X30a93d_X43e&#39;</span><span class="p">,</span> <span class="s1">&#39;../rawdata/uid_A002_x30a93d_X44e&#39;</span><span class="p">])</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Load an MS in the current directory into the context:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_importdata</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;uid___A002_X30a93d_X43e.ms&#39;</span><span class="p">])</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Load a tarred ASDM in ../rawdata into the context:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_importdata</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;../rawdata/uid___A002_X30a93d_X43e.tar.gz&#39;</span><span class="p">])</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Import a list of MeasurementSets:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">myvislist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;uid___A002_X30a93d_X43e.ms&#39;</span><span class="p">,</span> <span class="s1">&#39;uid_A002_x30a93d_X44e.ms&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_importdata</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="n">myvislist</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Run with explicit setting of data column types:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_importdata</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;uid___A002_X30a93d_X43e_targets.ms&#39;</span><span class="p">],</span> <span class="n">datacolumns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;regcal_contline&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_importdata</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;uid___A002_X30a93d_X43e_targets_line.ms&#39;</span><span class="p">],</span> <span class="n">datacolumns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;regcal_line&#39;</span><span class="p">,</span> <span class="s1">&#39;corrected&#39;</span><span class="p">:</span> <span class="s1">&#39;selfcal_line&#39;</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_lock_refant">
<span class="sig-name descname"><span class="pre">hifa_lock_refant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_lock_refant.html#hifa_lock_refant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_lock_refant" title="Link to this definition"></a></dt>
<dd><p>hifa_lock_refant —- Lock reference antenna list</p>
<p>hifa_lock_refant marks the reference antenna list as “locked” for specified
measurement sets, preventing modification of the refant list by subsequent
tasks.</p>
<p>After executing hifa_lock_refant, all subsequent gaincal calls will by
default be executed with refantmode=’strict’.</p>
<p>The refant list can be unlocked with the hifa_unlock_refant task.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Lock the refant list for all MSes in pipeline context:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_lock_refant</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_polcal">
<span class="sig-name descname"><span class="pre">hifa_polcal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minpacov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solint_chavg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_polcal.html#hifa_polcal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_polcal" title="Link to this definition"></a></dt>
<dd><p>hifa_polcal —- Derive instrumental polarization calibration for ALMA.</p>
<p>Derive the instrumental polarization calibrations for ALMA using the
polarization calibrators.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: [‘M32A.ms’, ‘M32B.ms’]</p>
</dd>
<dt>minpacov</dt><dd><p>Minimum Parallactic Angle Coverage (degrees) required for
Q, U estimation in task polfromgain. This enables avoiding
pathological cases of antennas with insufficient parallactic
angle coverage which can yield spurious source polarization
solutions or cause polfromgain to fail to find any
solutions.</p>
<p>Default: 30.0</p>
</dd>
<dt>solint_chavg</dt><dd><p>Channel averaging to include in solint for gaincal steps
producing cross-hand delay, cross-hand phase, and leakage
(D-terms) solutions.</p>
<p>Default: ‘5MHz’</p>
</dd>
<dt>vs_stats</dt><dd><p>List of visstat statistics to use for diagnostic comparison
between the concatenated session MS and individual MSes in
that session after applying polarization calibration tables.</p>
<p>Default: [‘min’,’max’,’mean’]</p>
</dd>
<dt>vs_thresh</dt><dd><p>Threshold to use in diagnostic comparison of visstat
statistics; relative differences larger than this threshold
are reported in the CASA log.</p>
<p>Default: 1e-3</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Compute the polarization calibrations:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_polcal</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_polcalflag">
<span class="sig-name descname"><span class="pre">hifa_polcalflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_polcalflag.html#hifa_polcalflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_polcalflag" title="Link to this definition"></a></dt>
<dd><p>hifa_polcalflag —- Flag polarization calibrators</p>
<p>This task flags corrected visibility outliers in the polarization calibrator
data using the hif_correctedampflag heuristics.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the h_init or hif_importdata task.
‘’: use all MeasurementSets in the context</p>
<p>Examples: ‘ngc5921.ms’, [‘ngc5921a.ms’, ngc5921b.ms’, ‘ngc5921c.ms’]</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Run with recommended settings to flag visibility outliers in the
polarization calibrator data:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_polcalflag</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_renorm">
<span class="sig-name descname"><span class="pre">hifa_renorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">createcaltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excludechan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atm_auto_exclude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bwthreshspw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_renorm.html#hifa_renorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_renorm" title="Link to this definition"></a></dt>
<dd><p>hifa_renorm —- ALMA renormalization task</p>
<p>This task makes an assessment, and optionally applies a correction, to data
suffering from incorrect amplitude normalization caused by bright
astronomical lines detected in the autocorrelations of some target sources.</p>
<p>For a full description of the effects of bright emission lines and the
correction heuristics used in this task, please see the Pipeline User Guide.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
<dt>createcaltable</dt><dd><p>Boolean to select whether to create the renormalization
correction cal table (True), or only run the assessment
(False, default).</p>
<p>Example: createcaltable=True</p>
</dd>
<dt>threshold</dt><dd><p>Apply correction if max correction is above this threshold
value and <code class="docutils literal notranslate"><span class="pre">apply</span></code> = True. Default is 1.02 (i.e. 2%).</p>
<p>Example: threshold=1.02</p>
</dd>
<dt>spw</dt><dd><p>The list of real (not virtual - i.e. the actual spwIDs in
the MS) spectral windows to evaluate.</p>
<p>Set to spw=’’ by default, which means the task will select
all relevant (science FDM) spectral windows.</p>
<p>Note that for data with multiple MSs, a list with the
correct spectral window selection for each MS can be
provided.</p>
<p>Examples:</p>
<p>spw=”11,13,15,17”</p>
<p>spw=[“11,13,15,17”, “5,7,11,13”]</p>
</dd>
<dt>excludechan</dt><dd><p>Channels to exclude in either channel or frequency space
(TOPO, GHz), specifying the real (not virtual) spectral
window per selection.</p>
<p>Note that for data with multiple MSs, a list of
dictionaries with the correct selection for each MS can be
provided.</p>
<p>Examples:</p>
<p>excludechan={‘22’:’100~150;800~850’, ‘24’:’100~200’}</p>
<p>excludechan={‘22’:’230.1GHz~230.2GHz’}</p>
<p>excludechan=[{‘22’:’100~150’}, {‘15’:’100~150’}]</p>
</dd>
<dt>atm_auto_exclude</dt><dd><p>Automatically find and exclude regions with atmospheric
features. Default is False</p>
</dd>
<dt>bwthreshspw</dt><dd><p>Bandwidth beyond which a SPW is split into chunks to fit
separately. The default value for all SPWs is 120e6, and
this parameter allows one to override it for specific SPWs,
due to needing potentially various ‘nsegments’ when EBs
have very different SPW bandwidths.</p>
<p>Example: bwthreshspw={‘16: 64e6, ‘22: 64e6}</p>
</dd>
<dt>parallel</dt><dd><p>Execute using CASA HPC functionality, if available.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Run with recommended settings to assess the need for an ALMA amplitude
renormalization correction.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_renorm</span><span class="p">()</span>
</pre></div>
</div>
<p>2. Run to assess the necessary ALMA amplitude renormalization correction,
and apply this correction if it exceeds a threshold of 3% (1.03).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_renorm</span><span class="p">(</span><span class="n">createcaltable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">1.03</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_restoredata">
<span class="sig-name descname"><span class="pre">hifa_restoredata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">products_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copytoraw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawdata_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bdfflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ocorr_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_restoredata.html#hifa_restoredata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_restoredata" title="Link to this definition"></a></dt>
<dd><p>hifa_restoredata —- Restore flagged and calibration interferometry data from a pipeline run</p>
<p>The hifa_restoredata task restores flagged and calibrated MeasurementSets
from archived ASDMs and pipeline flagging and calibration data products.</p>
<p>hifa_restoredata assumes that the ASDMs to be restored are present in the
directory specified by the <code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code> (default: ‘../rawdata’).</p>
<p>By default (<code class="docutils literal notranslate"><span class="pre">copytoraw</span></code> = True), hifa_restoredata assumes that for each
ASDM in the input list, the corresponding pipeline flagging and calibration
data products (in the format produced by the hifa_exportdata task) are
present in the directory specified by <code class="docutils literal notranslate"><span class="pre">products_dir</span></code> (default: ‘../products’).
At the start of the task, these products are copied from the <code class="docutils literal notranslate"><span class="pre">products_dir</span></code>
to the <code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">copytoraw</span></code> = False, hifa_restoredata assumes that these products are
to be found in <code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code> along with the ASDMs.</p>
<p>The expected flagging and calibration products (for each ASDM) include:</p>
<blockquote>
<div><ul class="simple">
<li><p>a compressed tar file of the final flagversions file, e.g.
uid___A002_X30a93d_X43e.ms.flagversions.tar.gz</p></li>
<li><p>a text file containing the applycal instructions, e.g.
uid___A002_X30a93d_X43e.ms.calapply.txt</p></li>
<li><p>a compressed tar file containing the caltables for the parent session,
e.g. uid___A001_X74_X29.session_3.caltables.tar.gz</p></li>
</ul>
</div></blockquote>
<p>hifa_restoredata performs the following operations:</p>
<ul class="simple">
<li><p>imports the ASDM(s)</p></li>
<li><p>removes the default MS.flagversions directory created by the filler</p></li>
<li><p>restores the final MS.flagversions directory stored by the pipeline</p></li>
<li><p>restores the final set of pipeline flags to the MS</p></li>
<li><p>restores the final calibration state of the MS</p></li>
<li><p>restores the final calibration tables for each MS</p></li>
<li><p>applies the calibration tables to each MS</p></li>
</ul>
<p>When importing the ASDM and converting it to a Measurement Set (MS), if the
output MS already exists in the output directory, then the importasdm
conversion step is skipped, and instead the existing MS will be imported.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of raw visibility data files to be restored.
Assumed to be in the directory specified by rawdata_dir.</p>
<p>Example: vis=[‘uid___A002_X30a93d_X43e’]</p>
</dd>
<dt>session</dt><dd><p>List of sessions one per visibility file.</p>
<p>Example: session=[‘session_3’]</p>
</dd>
<dt>products_dir</dt><dd><p>Name of the data products directory to copy calibration
products from.
Default: ‘../products’</p>
<p>The parameter is effective only when <code class="docutils literal notranslate"><span class="pre">copytoraw</span></code> = True.
When <code class="docutils literal notranslate"><span class="pre">copytoraw</span></code> = False, calibration products in
<code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code> will be used.</p>
<p>Example: products_dir=’myproductspath’</p>
</dd>
<dt>copytoraw</dt><dd><p>Copy calibration and flagging tables from <code class="docutils literal notranslate"><span class="pre">products_dir</span></code> to
<code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code> directory.
Default: True</p>
<p>Example: copytoraw=False</p>
</dd>
<dt>rawdata_dir</dt><dd><p>Name of the raw data directory.
Default: ‘../rawdata’</p>
<p>Example: rawdata_dir=’myrawdatapath’</p>
</dd>
<dt>lazy</dt><dd><p>Use the lazy filler option.
Default: False</p>
<p>Example: lazy=True</p>
</dd>
<dt>bdfflags</dt><dd><p>Set the BDF flags.
Default: True</p>
<p>Example: bdfflags=False</p>
</dd>
<dt>ocorr_mode</dt><dd><p>Set ocorr_mode.
Default: ‘ca’</p>
<p>Example: ocorr_mode=’ca’</p>
</dd>
<dt>asis</dt><dd><p>Creates verbatim copies of the ASDM tables in the output MS.
The value given to this option must be a string containing a
list of table names separated by whitespace characters.
Default: ‘SBSummary ExecBlock Antenna Annotation Station Receiver Source CalAtmosphere CalWVR CalPointing’</p>
<p>Example: asis=’Source Receiver’</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Restore the pipeline results for a single ASDM in a single session:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_restoredata</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;uid___A002_X30a93d_X43e&#39;</span><span class="p">],</span> <span class="n">session</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;session_1&#39;</span><span class="p">],</span> <span class="n">ocorr_mode</span><span class="o">=</span><span class="s1">&#39;ca&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_session_refant">
<span class="sig-name descname"><span class="pre">hifa_session_refant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_session_refant.html#hifa_session_refant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_session_refant" title="Link to this definition"></a></dt>
<dd><p>hifa_session_refant —- Select best reference antenna for session(s)</p>
<p>This task re-evaluates the reference antenna lists from all measurement sets
within a session and combines these to select a single common reference
antenna (per session) that is to be used by any subsequent pipeline stages.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
<dt>phase_threshold</dt><dd><p>Threshold (in degrees) used to identify absolute phase
solution outliers in caltables.</p>
<p>Example: phase_threshold=0.005</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Compute a single common reference antenna per session:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_session_refant</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_spwphaseup">
<span class="sig-name descname"><span class="pre">hifa_spwphaseup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_spwmapmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxnarrowbw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minfracmaxbw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samebb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phasesnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bwedgefrac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_nantennas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxfracflagged</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minblperant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unregister_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_spwphaseup.html#hifa_spwphaseup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_spwphaseup" title="Link to this definition"></a></dt>
<dd><p>hifa_spwphaseup —- Compute phase calibration spw map and per spw phase offsets</p>
<p>The spw map for phase calibration is computed. Phase offsets as a function of
spectral window are computed using high signal-to-noise calibration observations.</p>
<p>Previous calibrations are applied on the fly.</p>
<p>hifa_spwphaseup performs two functions:</p>
<ul class="simple">
<li><p>Determines the spectral window mapping or combination mode, for each phase
and check source, to use when solving for phase as a function of time
(gfluxscale and timegaincal), and when applying those solutions to
targets.</p></li>
<li><p>Computes the per-spectral-window phase offset table that will be applied
to the data to remove mean phase differences between the spectral windows.</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">hm_spwmapmode</span></code> = ‘auto’, then the spectral window map is computed for
each SpectralSpec and each source with phase or check intent, using the
following algorithm:</p>
<ul class="simple">
<li><p>Estimate the per-spectral-window (spw) per-scan signal-to-noise ratio for
each phase and check source based on catalog flux densities, Tsys, number
of antennas, and integration scan time.</p></li>
<li><p>If the signal-to-noise of all spws is greater than <code class="docutils literal notranslate"><span class="pre">phasesnr</span></code>, then
<code class="docutils literal notranslate"><span class="pre">hm_spwmapmode</span></code> = ‘default’ mapping is used in which each spw is used
to calibrate itself.</p></li>
<li><p>If the signal-to-noise of only some spws are greater than the value of
<code class="docutils literal notranslate"><span class="pre">phasesnr</span></code>, then each lower-SNR spw is mapped to the highest SNR spw
in the same SpectralSpec.</p></li>
<li><p>If all spws have low SNR, or SNR cannot be computed for any reason (for
example, there is no flux information), then <code class="docutils literal notranslate"><span class="pre">hm_spwmapmode</span></code> = ‘combine’.</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">hm_spwmapmode</span></code> = ‘combine’, hifa_spwphaseup maps all the science windows
to a single science spectral window. For example, if the list of science
spectral windows is [9, 11, 13, 15] then all the science spectral windows
in the data will be combined and mapped to the science window 9 in the
combined phase vs time calibration table.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">hm_spwmapmode</span></code> = ‘simple’, a mapping from narrow science to wider
science spectral windows is computed using the following algorithm:</p>
<ul class="simple">
<li><p>Construct a list of the bandwidths of all the science spectral windows.</p></li>
<li><p>Determine the maximum bandwidth in this list as ‘maxbandwidth’</p></li>
<li><p>For each science spectral window with bandwidth less than ‘maxbandwidth’
construct a list of spectral windows with bandwidths greater than
<code class="docutils literal notranslate"><span class="pre">minfracmaxbw</span></code> * ‘maxbandwidth’, then select the spectral window in this
list whose band center most closely matches the band center of the narrow
spectral window, and preferentially match within the same baseband if
<code class="docutils literal notranslate"><span class="pre">samebb</span></code> = True.</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">hm_spwmapmode</span></code> = ‘default’ the spw mapping is assumed to be one to one.</p>
<p>Phase offsets per spectral window are determined by computing a phase only gain
calibration on the selected data, normally the high signal-to-noise bandpass
calibrator observations, using the solution interval ‘inf’.</p>
<p>At the end of the task the spectral window map and the phase offset calibration
table in the pipeline are stored in the context for use by later tasks.</p>
<p>Finally, the SNR of the calibration solutions are inspected and if the median value
on a per-spw basis does not reach specific thresholds, then issue a warning and reduced
QA score, with thresholds at <code class="docutils literal notranslate"><span class="pre">phasesnr</span></code> <a href="#id11"><span class="problematic" id="id12">*</span></a>0.75 (blue), <a href="#id13"><span class="problematic" id="id14">*</span></a>0.5 (yellow) and <a href="#id15"><span class="problematic" id="id16">*</span></a>0.33 (red).</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘M82A.ms’, ‘M82B.ms’]</p>
</dd>
<dt>caltable</dt><dd><p>The list of output calibration tables. Defaults to the standard
pipeline naming convention.</p>
<p>Example: caltable=[‘M82.gcal’, ‘M82B.gcal’]</p>
</dd>
<dt>field</dt><dd><p>The list of field names or field ids for which phase offset solutions
are to be computed. Defaults to all fields with the default intent.</p>
<p>Example: field=’3C279’, field=’3C279, M82’</p>
</dd>
<dt>intent</dt><dd><p>A string containing a comma delimited list of intents against
which the selected fields are matched. Defaults to the BANDPASS
observations.</p>
<p>Example: intent=’PHASE’</p>
</dd>
<dt>spw</dt><dd><p>The list of spectral windows and channels for which gain solutions are
computed. Defaults to all the science spectral windows.</p>
<p>Example: spw=’13,15’</p>
</dd>
<dt>hm_spwmapmode</dt><dd><p>The spectral window mapping mode. The options are: ‘auto’,
‘combine’, ‘simple’, and ‘default’. In ‘auto’ mode hifa_spwphaseup
estimates the SNR of the phase calibrator observations and uses these
estimates to choose between ‘combine’ mode (low SNR) and ‘default’ mode
(high SNR). In combine mode all spectral windows are combined and mapped to
one spectral window. In ‘simple’ mode narrow spectral windows are mapped to
wider ones using an algorithm defined by ‘maxnarrowbw’, ‘minfracmaxbw’, and
‘samebb’. In ‘default’ mode the spectral window map defaults to the
standard one to one mapping.</p>
<p>Example: hm_spwmapmode=’combine’</p>
</dd>
<dt>maxnarrowbw</dt><dd><p>The maximum bandwidth defining narrow spectral windows. Values
must be in CASA compatible frequency units.</p>
<p>Example: maxnarrowbw=’’</p>
</dd>
<dt>minfracmaxbw</dt><dd><p>The minimum fraction of the maximum bandwidth in the set of
spws to use for matching.</p>
<p>Example: minfracmaxbw=0.75</p>
</dd>
<dt>samebb</dt><dd><p>Match within the same baseband if possible.</p>
<p>Example: samebb=False</p>
</dd>
<dt>phasesnr</dt><dd><p>The required gaincal solution signal-to-noise.</p>
<p>Example: phaseupsnr=20.0</p>
</dd>
<dt>bwedgefrac</dt><dd><p>The fraction of the bandwidth edges that is flagged.</p>
<p>Example: bwedgefrac=0.0</p>
</dd>
<dt>hm_nantennas</dt><dd><p>The heuristics for determines the number of antennas to use
in the signal-to-noise estimate. The options are ‘all’ and ‘unflagged’.
The ‘unflagged’ options is not currently supported.</p>
<p>Example: hm_nantennas=’unflagged’</p>
</dd>
<dt>maxfracflagged</dt><dd><p>The maximum fraction of an antenna that can be flagged
before it is excluded from the signal-to-noise estimate.</p>
<p>Example: maxfracflagged=0.80</p>
</dd>
<dt>combine</dt><dd><p>Data axes to combine for solving. Options are ‘’, ‘scan’, ‘spw’,
‘field’ or any comma-separated combination.</p>
<p>Example: combine=’’</p>
</dd>
<dt>refant</dt><dd><p>Reference antenna name(s) in priority order. Defaults to most recent
values set in the pipeline context.  If no reference antenna is defined in
the pipeline context the CASA defaults are used.</p>
<p>Example: refant=’DV01’, refant=’DV05,DV07’</p>
</dd>
<dt>minblperant</dt><dd><p>Minimum number of baselines required per antenna for each solve.
Antennas with fewer baselines are excluded from solutions.</p>
<p>Example: minblperant=2</p>
</dd>
<dt>minsnr</dt><dd><p>Solutions below this SNR are rejected.</p>
</dd>
<dt>unregister_existing</dt><dd><p>Unregister previous spwphaseup calibrations from the pipeline context
before registering the new calibrations from this task.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Compute the default spectral window map and the per spectral window phase
offsets:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_spwphaseup</span><span class="p">()</span>
</pre></div>
</div>
<p>2. Compute the default spectral window map and the per spectral window phase
offsets set the spectral window mapping mode to ‘simple’:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_spwphaseup</span><span class="p">(</span><span class="n">hm_spwmapmode</span><span class="o">=</span><span class="s1">&#39;simple&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_targetflag">
<span class="sig-name descname"><span class="pre">hifa_targetflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_targetflag.html#hifa_targetflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_targetflag" title="Link to this definition"></a></dt>
<dd><p>hifa_targetflag —- Flag target source outliers</p>
<p>This task flags very obvious target source outliers. The calibration tables and
flags accumulated in the cal library up to this point are pre-applied, then
hif_correctedampflag is called for just the TARGET intent. Any resulting
flags are applied and the calibration library is restored to the state before
calling this task.</p>
<p>Because science targets are generally not point sources, the flagging algorithm
needs to be more clever than for point source calibrators. The algorithm identifies
outliers by examining statistics within successive overlapping radial uv bins,
allowing it to adapt to an arbitrary uv structure. Outliers must appear to be a
potential outlier in two bins in order to be declared an outlier.  To further avoid
overflagging of good data, only the highest threshold levels are used (+12/-13 sigma).
This stage does can add significant processing time, particularly in making the plots.
So to save time, the amp vs. time plots are created only if flags are generated, and
the amp vs. uv distance plots are made for only those spws that generated flags.
Also, to avoid confusion in mosaics and single field surveys, the amp vs. uv distance
plots only show field IDs with new flags.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the h_init or hif_importdata task.
‘’: use all MeasurementSets in the context</p>
<p>Examples: ‘ngc5921.ms’, [‘ngc5921a.ms’, ngc5921b.ms’, ‘ngc5921c.ms’]</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Run with recommended settings to flag outliers in science target(s):</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_targetflag</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_timegaincal">
<span class="sig-name descname"><span class="pre">hifa_timegaincal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calamptable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calphasetable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsetstable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetphasetable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amptable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calsolint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetsolint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refantmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solnorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minblperant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calminsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetminsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smodel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_timegaincal.html#hifa_timegaincal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_timegaincal" title="Link to this definition"></a></dt>
<dd><p>hifa_timegaincal —- Determine temporal gains from calibrator observations</p>
<p>The time-dependent complex gains for each antenna/spwid are determined from
the raw data (DATA column) divided by the model (MODEL column), for the
specified fields. The gains are computed according to the spw-combination
model determined in hifa_spwphaseup.</p>
<p>Previous calibrations are applied on the fly.</p>
<p>The complex gains are derived from the data column (raw data) divided by the
model column (usually set with hif_setjy). The gains are obtained for the
specified solution intervals, spw combination and field combination. One
gain solution is computed for the science targets and one for the calibrator
targets.</p>
<p>Good candidate reference antennas can be determined using the hif_refant
task.</p>
<p>Previous calibrations that have been stored in the pipeline context are
applied on the fly. Users can interact with these calibrations via the
h_export_calstate and h_import_calstate tasks.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>The list of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘M82A.ms’, ‘M82B.ms’]</p>
</dd>
<dt>calamptable</dt><dd><p>The list of output diagnostic calibration amplitude tables for
the calibration targets. Defaults to the standard pipeline naming
convention.</p>
<p>Example: calamptable=[‘M82.gacal’, ‘M82B.gacal’]</p>
</dd>
<dt>offsetstable</dt><dd><p>The list of output diagnostic phase offset tables for the
calibration targets. Defaults to the standard pipeline naming convention.</p>
<p>Example: offsetstable=[‘M82.offsets.gacal’, ‘M82B.offsets.gacal’]</p>
</dd>
<dt>calphasetable</dt><dd><p>The list of output calibration phase tables for the
calibration targets. Defaults to the standard pipeline naming convention.</p>
<p>Example: calphasetable=[‘M82.gpcal’, ‘M82B.gpcal’]</p>
</dd>
<dt>targetphasetable</dt><dd><p>The list of output phase calibration tables for the science
targets. Defaults to the standard pipeline naming convention.</p>
<p>Example: targetphasetable=[‘M82.gpcal’, ‘M82B.gpcal’]</p>
</dd>
<dt>amptable</dt><dd><p>The list of output calibration amplitude tables for the
calibration and science targets.
Defaults to the standard pipeline naming convention.</p>
<p>Example: amptable=[‘M82.gacal’, ‘M82B.gacal’]</p>
</dd>
<dt>field</dt><dd><p>The list of field names or field ids for which gain solutions are to
be computed. Defaults to all fields with the standard intent.</p>
<p>Example: field=’3C279’, field=’3C279, M82’</p>
</dd>
<dt>spw</dt><dd><p>The list of spectral windows and channels for which gain solutions are
computed. Defaults to all science spectral windows.</p>
<p>Example: spw=’11’, spw=’11, 13’</p>
</dd>
<dt>antenna</dt><dd><p>The selection of antennas for which gains are computed. Defaults to all.</p>
</dd>
<dt>calsolint</dt><dd><p>Time solution interval in CASA syntax for calibrator source
solutions.</p>
<p>Example: calsolint=’inf’, calsolint=’int’, calsolint=’100sec’</p>
</dd>
<dt>targetsolint</dt><dd><p>Time solution interval in CASA syntax for target source
solutions.</p>
<p>Example: targetsolint=’inf’, targetsolint=’int’, targetsolint=’100sec’</p>
</dd>
<dt>refant</dt><dd><p>Reference antenna name(s) in priority order. Defaults to most recent
values set in the pipeline context. If no reference antenna is defined in
the pipeline context use the CASA defaults.</p>
<p>example: refant=’DV01’, refant=’DV05,DV07’</p>
</dd>
<dt>refantmode</dt><dd><p>Controls how the refant is applied. Currently available
choices are ‘flex’, ‘strict’, and the default value of ‘’.
Setting to ‘’ allows the pipeline to select the appropriate
mode based on the state of the reference antenna list.</p>
<p>Examples: refantmode=’strict’, refantmode=’’</p>
</dd>
<dt>solnorm</dt><dd><p>Normalise the gain solutions.</p>
</dd>
<dt>minblperant</dt><dd><p>Minimum number of baselines required per antenna for each solve.
Antennas with fewer baselines are excluded from solutions.</p>
<p>Example: minblperant=2</p>
</dd>
<dt>calminsnr</dt><dd><p>Solutions below this SNR are rejected for calibrator solutions.</p>
</dd>
<dt>targetminsnr</dt><dd><p>Solutions below this SNR are rejected for science target
solutions.</p>
</dd>
<dt>smodel</dt><dd><p>Point source Stokes parameters for source model (experimental)
Defaults to using standard MODEL_DATA column data.</p>
<p>Example: smodel=[1,0,0,0]  - (I=1, unpolarized)</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Compute standard per scan gain solutions that will be used to calibrate
the target:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_timegaincal</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_tsysflag">
<span class="sig-name descname"><span class="pre">hifa_tsysflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_nmedian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnm_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnm_byfield</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_derivative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fd_max_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_edgechans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fe_edge_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_fieldshape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff_refintent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff_max_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_birdies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fb_sharps_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_toomany</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmf1_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmef1_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_tsys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetemplate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_tsysflag.html#hifa_tsysflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_tsysflag" title="Link to this definition"></a></dt>
<dd><p>hifa_tsysflag —- Flag deviant system temperatures for ALMA interferometry measurements.</p>
<p>This task flags all deviant system temperature measurements in the system
temperature calibration table by running a sequence of flagging tests, each
designed to look for a different type of possible error.</p>
<p>If a file with manual Tsys flags is provided with the <code class="docutils literal notranslate"><span class="pre">filetemplate</span></code>
parameter, then these flags are applied prior to the evaluation of the
flagging heuristics listed below.</p>
<p>The tests are:</p>
<ol class="arabic simple">
<li><p>Flag Tsys spectra with high median values</p></li>
<li><p>Flag Tsys spectra with high median derivatives. This is meant to spot
spectra that are ‘ringing’.</p></li>
<li><p>Flag the edge channels of the Tsys spectra in each SpW.</p></li>
<li><p>Flag Tsys spectra whose shape is different from that associated with
the BANDPASS intent.</p></li>
<li><p>Flag ‘birdies’.</p></li>
<li><p>Flag the Tsys spectra of all antennas in a timestamp and spw if
proportion of antennas already flagged in this timestamp and spw exceeds
a threshold, and flag Tsys spectra for all antennas and all timestamps
in a spw, if proportion of antennas that are already entirely flagged
in all timestamps exceeds a threshold.</p></li>
</ol>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets (Not used).</p>
</dd>
<dt>caltable</dt><dd><p>List of input Tsys calibration tables.</p>
<p>Default: [] - Use the table currently stored in the pipeline context.</p>
<p>Example: caltable=[‘X132.ms.tsys.s2.tbl’]</p>
</dd>
<dt>flag_nmedian</dt><dd><p>True to flag Tsys spectra with high median value.</p>
</dd>
<dt>fnm_limit</dt><dd><p>Flag spectra with median value higher than fnm_limit * median
of this measure over all spectra.</p>
</dd>
<dt>fnm_byfield</dt><dd><p>Evaluate the nmedian metric separately for each field.</p>
</dd>
<dt>flag_derivative</dt><dd><p>True to flag Tsys spectra with high median derivative.</p>
</dd>
<dt>fd_max_limit</dt><dd><p>Flag spectra with median derivative higher than
fd_max_limit * median of this measure over all spectra.</p>
</dd>
<dt>flag_edgechans</dt><dd><p>True to flag edges of Tsys spectra.</p>
</dd>
<dt>fe_edge_limit</dt><dd><p>Flag channels whose channel to channel difference &gt;
fe_edge_limit * median across spectrum.</p>
</dd>
<dt>flag_fieldshape</dt><dd><p>True to flag Tsys spectra with a radically different
shape to those of the ff_refintent.</p>
</dd>
<dt>ff_refintent</dt><dd><p>Data intent that provides the reference shape for
‘flag_fieldshape’.</p>
</dd>
<dt>ff_max_limit</dt><dd><p>Flag Tsys spectra with ‘fieldshape’ metric values &gt;
ff_max_limit.</p>
</dd>
<dt>flag_birdies</dt><dd><p>True to flag channels covering sharp spectral features.</p>
</dd>
<dt>fb_sharps_limit</dt><dd><p>Flag channels bracketing a channel to channel
difference &gt; fb_sharps_limit.</p>
</dd>
<dt>flag_toomany</dt><dd><p>True to flag Tsys spectra for which a proportion of
antennas for given timestamp and/or proportion of antennas that are
entirely flagged in all timestamps exceeds their respective thresholds.</p>
</dd>
<dt>tmf1_limit</dt><dd><p>Flag Tsys spectra for all antennas in a timestamp and spw if
proportion of antennas already flagged in this timestamp and spw exceeds
tmf1_limit.</p>
</dd>
<dt>tmef1_limit</dt><dd><p>Flag Tsys spectra for all antennas and all timestamps
in a spw, if proportion of antennas that are already entirely flagged
in all timestamps exceeds tmef1_limit.</p>
</dd>
<dt>metric_order</dt><dd><p>Order in which to evaluate the flagging metrics that are
enabled. Disabled metrics are skipped.</p>
</dd>
<dt>normalize_tsys</dt><dd><p>True to create a normalized Tsys table that is used to
evaluate the Tsys flagging metrics. All newly found flags are also applied
to the original Tsys caltable that continues to be used for subsequent
calibration.</p>
</dd>
<dt>filetemplate</dt><dd><p>The name of a text file that contains the manual Tsys flagging
template. If the template flags file is undefined, a name of the form
‘msname.flagtsystemplate.txt’ is assumed.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Flag Tsys measurements using currently recommended tests:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_tsysflag</span><span class="p">()</span>
</pre></div>
</div>
<p>2. Flag Tsys measurements using all recommended tests apart from that
using the ‘fieldshape’ metric:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_tsysflag</span><span class="p">(</span><span class="n">flag_fieldshape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_tsysflagcontamination">
<span class="sig-name descname"><span class="pre">hifa_tsysflagcontamination</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetemplate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_n_extreme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_detection_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagnostic_plots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continue_on_failure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_tsysflagcontamination.html#hifa_tsysflagcontamination"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_tsysflagcontamination" title="Link to this definition"></a></dt>
<dd><p>hifa_tsysflagcontamination —- Flag line contamination in ALMA interferometric Tsys caltables</p>
<p>This task flags all line contamination detected through an analysis of the
Tsys and bandpass caltables.</p>
<p>The general idea for the detection algorithm is to discern features which
appear in the Tsys calibration tables of the scans taken in the vicinity
of the source field in comparison with the Tsys calibration tables of the
scans taken toward the bandpass. The bandpass scan should be clean of
astrophysical line features.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets (Not used).</p>
</dd>
<dt>caltable</dt><dd><p>List of input Tsys calibration tables.</p>
<p>Default: [] - Use the table currently stored in the pipeline context.</p>
<p>Example: caltable=[‘X132.ms.tsys.s2.tbl’]</p>
</dd>
<dt>filetemplate</dt><dd><p>output file to which regions to flag will be written</p>
</dd>
<dt>logpath</dt><dd><p>output file to which heuristic log statements will be
written</p>
</dd>
<dt>remove_n_extreme</dt><dd><p>expert parameter for contamination heuristic</p>
<p>Default: 2</p>
</dd>
<dt>relative_detection_factor</dt><dd><p>expert parameter for contamination detection heuristic</p>
<p>Default: 0.005</p>
</dd>
<dt>diagnostic_plots</dt><dd><p>create diagnostic plots for the line contamination heuristic</p>
<p>Default: True</p>
</dd>
<dt>continue_on_failure</dt><dd><p>controls whether pipeline execution continues if a failure
occurs in the underlying contamination detection heuristic.</p>
<p>Default: True</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Flag Tsys line contamination using currently recommended parameters:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_tsysflagcontamination</span><span class="p">()</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Halt pipeline execution if a failure occurs in the underlying heuristic:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_tsysflagcontamination</span><span class="p">(</span><span class="n">continue_on_failure</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_unlock_refant">
<span class="sig-name descname"><span class="pre">hifa_unlock_refant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_unlock_refant.html#hifa_unlock_refant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_unlock_refant" title="Link to this definition"></a></dt>
<dd><p>hifa_unlock_refant —- Unlock reference antenna list</p>
<p>hifa_unlock_refant marks the reference antenna list as “unlocked” for
specified measurement sets, allowing the list to be modified by subsequent
tasks.</p>
<p>After executing hifa_unlock_refant, all subsequent gaincal calls will by
default be executed with refantmode=’flex’.</p>
<p>The refant list can be locked with the hifa_lock_refant task.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input MeasurementSets. Defaults to the list of
MeasurementSets specified in the pipeline context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Unlock the refant list for all MSes in pipeline context:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_unlock_refant</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_wvrgcal">
<span class="sig-name descname"><span class="pre">hifa_wvrgcal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsetstable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_toffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segsource</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sourceflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_tie</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disperse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvrflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxdistm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minnumants</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mingoodfrac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa_intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa_bandpass_intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa_spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_wvrgcal.html#hifa_wvrgcal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_wvrgcal" title="Link to this definition"></a></dt>
<dd><p>hifa_wvrgcal —-
Generate a gain table based on Water Vapor Radiometer data, and calculate
a QA score based on its effect on the interferometric data.</p>
<p>Generate a gain table based on the Water Vapor Radiometer data in each vis
file. By applying the wvr calibration to the data specified by <code class="docutils literal notranslate"><span class="pre">qa_intent</span></code>
and <code class="docutils literal notranslate"><span class="pre">qa_spw</span></code>, calculate a QA score to indicate its effect on
interferometric data; a score &gt; 1 implies that the phase noise is improved,
a score &lt; 1 implies that it is made worse. If the score is less than
<code class="docutils literal notranslate"><span class="pre">accept_threshold</span></code> then the wvr gain table is not accepted into the
context for subsequent use.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input visibility files.</p>
<p>Default: none, in which case the vis files to be used
will be read from the context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
<dt>caltable</dt><dd><p>List of output gain calibration tables.</p>
<p>Default: none, in which case the names of the caltables
will be generated automatically.</p>
<p>Example: caltable=’ngc5921.wvr’</p>
</dd>
<dt>offsetstable</dt><dd><p>List of input temperature offsets table files to subtract
from WVR measurements before calculating phase corrections.</p>
<p>Default: none, in which case no offsets are applied.</p>
<p>Example: offsetstable=[‘ngc5921.cloud_offsets’]</p>
</dd>
<dt>hm_toffset</dt><dd><p>If ‘manual’, set the <code class="docutils literal notranslate"><span class="pre">toffset</span></code> parameter to the user-specified value.
If ‘automatic’, set the <code class="docutils literal notranslate"><span class="pre">toffset</span></code> parameter according to the
date of the MeasurementSet; toffset=-1 if before 2013-01-21T00:00:00
toffset=0 otherwise.</p>
</dd>
<dt>toffset</dt><dd><p>Time offset (sec) between interferometric and WVR data.</p>
</dd>
<dt>segsource</dt><dd><p>If True calculate new atmospheric phase correction coefficients
for each source, subject to the constraints of the <code class="docutils literal notranslate"><span class="pre">tie</span></code> parameter.
‘segsource’ is forced to be True if the <code class="docutils literal notranslate"><span class="pre">tie</span></code> parameter is set to a
non-empty value by the user or by the automatic heuristic.</p>
</dd>
<dt>sourceflag</dt><dd><p>Flag the WVR data for these source(s) as bad and do not
produce corrections for it. Requires <code class="docutils literal notranslate"><span class="pre">segsource</span></code> = True.</p>
<p>Example: [‘3C273’]</p>
</dd>
<dt>hm_tie</dt><dd><p>If ‘manual’, set the <code class="docutils literal notranslate"><span class="pre">tie</span></code> parameter to the
user-specified value. If ‘automatic’, set the <code class="docutils literal notranslate"><span class="pre">tie</span></code>
parameter to include with the target all calibrators
that are within 15 degrees of it: if no calibrators are
that close then <code class="docutils literal notranslate"><span class="pre">tie</span></code> is left empty.</p>
</dd>
<dt>tie</dt><dd><p>Use the same atmospheric phase correction coefficients
when calculating the WVR correction for all sources in
the <code class="docutils literal notranslate"><span class="pre">tie</span></code>. If <code class="docutils literal notranslate"><span class="pre">tie</span></code> is not empty then <code class="docutils literal notranslate"><span class="pre">segsource</span></code>
is forced to be True. Ignored unless <code class="docutils literal notranslate"><span class="pre">hm_tie</span></code> = ‘manual’.</p>
<p>Example: tie=[‘3C273,NGC253’, ‘IC433,3C279’]</p>
</dd>
<dt>nsol</dt><dd><p>Number of solutions for phase correction coefficients during this
observation, evenly distributed in time throughout the observation. It
is used only if segsource=False because if segsource=True then the
coefficients are recomputed whenever the telescope moves to a new
source (within the limits imposed by ‘tie’).</p>
</dd>
<dt>disperse</dt><dd><p>Apply correction for dispersion. (Deprecated; will be removed)</p>
</dd>
<dt>wvrflag</dt><dd><p>Flag the WVR data for the listed antennas as bad and replace
their data with values interpolated from the 3 nearest antennas with
unflagged data.</p>
<p>Example: [‘DV03’,’DA05’,’PM02’]</p>
</dd>
<dt>hm_smooth</dt><dd><p>If ‘manual’ set the <code class="docutils literal notranslate"><span class="pre">smooth</span></code> parameter to the user-specified value.
If ‘automatic’, run the wvrgcal task with the range of <code class="docutils literal notranslate"><span class="pre">smooth</span></code> parameters
required to match the integration time of the wvr data to that of the
interferometric data in each spectral window.</p>
</dd>
<dt>smooth</dt><dd><p>Smooth WVR data on this timescale before calculating the correction.
Ignored unless hm_smooth=’manual’.</p>
</dd>
<dt>scale</dt><dd><p>Scale the entire phase correction by this factor.</p>
</dd>
<dt>maxdistm</dt><dd><p>Maximum distance in meters of an antenna used for interpolation
from a flagged antenna.</p>
<p>Default: -1  (automatically set to 100m if &gt;50% of
antennas are 7m antennas without WVR and otherwise set to
500m).</p>
<p>Example: maxdistm=550</p>
</dd>
<dt>minnumants</dt><dd><p>Minimum number of nearby antennas (up to 3) used for
interpolation from a flagged antenna.</p>
<p>Example: minnumants=3</p>
</dd>
<dt>mingoodfrac</dt><dd><p>Minimum fraction of good data per antenna.</p>
</dd>
<dt>refant</dt><dd><p>Ranked comma delimited list of reference antennas.</p>
<p>Example: refant=’DV01,DV02’</p>
</dd>
<dt>qa_intent</dt><dd><p>The list of data intents on which the wvr correction is to be
tried as a means of estimating its effectiveness.</p>
<p>A QA ‘view’ will be calculated for each specified intent, in each spectral
window in each vis file.</p>
<p>Each QA ‘view’ will consist of a pair of 2-d images with dimensions
[‘ANTENNA’, ‘TIME’], one showing the data phase-noise before the
wvr application, the second showing the phase noise after (both ‘before’
and ‘after’ images have a bandpass calibration applied as well).</p>
<p>An overall QA score is calculated for each vis file, by dividing the
‘before’ images by the ‘after’ and taking the median of the result. An
overall score of 1 would correspond to no change in the phase noise,
a score &gt; 1 implies an improvement.</p>
<p>If the overall score for a vis file is less than the value in
‘accept_threshold’ then the wvr calibration file is not made available
for merging into the context for use in the subsequent reduction.</p>
<p>If you do not want any QA calculations then set qa_intent=’’.</p>
<p>example: qa_intent=’PHASE’</p>
</dd>
<dt>qa_bandpass_intent</dt><dd><p>The data intent to use for the bandpass calibration in
the qa calculation. The default is blank to allow the underlying bandpass
task to select a sensible intent if the dataset lacks BANDPASS data.</p>
</dd>
<dt>qa_spw</dt><dd><p>The SpW(s) to use for the qa calculation, in the order that they
should be tried. Input as a comma-separated list. The default is blank, in
which case the task will try SpWs in order of decreasing median sky
opacity.</p>
</dd>
<dt>accept_threshold</dt><dd><p>The phase-rms improvement ratio
(rms without wvr / rms with wvr) above which the wrvg file will be
accepted into the context for subsequent application.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Compute the WVR calibration for all the MeasurementSets:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_wvrgcal</span><span class="p">(</span><span class="n">hm_tie</span><span class="o">=</span><span class="s1">&#39;automatic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hifa.cli.hifa_wvrgcalflag">
<span class="sig-name descname"><span class="pre">hifa_wvrgcalflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsetstable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_toffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segsource</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sourceflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_tie</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tie</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disperse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvrflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxdistm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minnumants</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mingoodfrac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa_intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa_bandpass_intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_hi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fhi_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fhi_minsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ants_with_wvr_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hifa/cli/hifa_wvrgcalflag.html#hifa_wvrgcalflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hifa.cli.hifa_wvrgcalflag" title="Link to this definition"></a></dt>
<dd><p>hifa_wvrgcalflag —-
Generate a gain table based on Water Vapor Radiometer data, interpolating over
antennas with bad radiometers.</p>
<p>This task will first identify for each vis whether it includes at least 3
antennas with Water Vapor Radiometer (WVR) data, and that the fraction of
WVR antennas / all antennas exceeds the minimum threshold
(ants_with_wvr_thresh).</p>
<p>If there are not enough WVR antennas by number and/or fraction, then no WVR
caltable is created and no WVR calibration will be applied to the corresponding
vis. If there are enough WVR antennas, then the task proceeds as follows for
each valid vis:</p>
<p>First, generate a gain table based on the Water Vapor Radiometer data for
each vis.</p>
<p>Second, apply the WVR calibration to the data specified by ‘flag_intent’,
calculate flagging ‘views’ showing the ratio
‘phase-rms with WVR / phase-rms without WVR’ for each scan. A ratio &lt; 1
implies that the phase noise is improved, a ratio &gt; 1 implies that it
is made worse.</p>
<p>Third, search the flagging views for antennas with anomalous high values.
If any are found then recalculate the WVR calibration with the ‘wvrflag’
parameter set to ignore their data and interpolate results from other
antennas according to ‘maxdistm’ and ‘minnumants’.</p>
<p>Fourth, after flagging, if the remaining unflagged antennas with WVR number
fewer than 3, or represent a smaller fraction of antennas than the minimum
threshold (ants_with_wvr_thresh), then the WVR calibration file is rejected
and will not be merged into the context, i.e. not be used in subsequent
calibration.</p>
<p>Fifth, if the overall QA score for the final WVR correction of a vis file
is greater than the value in ‘accept_threshold’ then make available the
wvr calibration file for merging into the context and use in the
subsequent reduction.</p>
<p>Output:</p>
<blockquote>
<div><p>results – The results object for the pipeline task is returned.</p>
</div></blockquote>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis</dt><dd><p>List of input visibility files.</p>
<p>Default: none, in which case the vis files to be used
will be read from the context.</p>
<p>Example: vis=[‘ngc5921.ms’]</p>
</dd>
<dt>caltable</dt><dd><p>List of output gain calibration tables.</p>
<p>Default: none, in which case the names of the caltables
will be generated automatically.</p>
<p>Example: caltable=’ngc5921.wvr’</p>
</dd>
<dt>offsetstable</dt><dd><p>List of input temperature offsets table files to
subtract from WVR measurements before calculating phase
corrections.</p>
<p>Default: none, in which case no offsets are applied.</p>
<p>Example: offsetstable=[‘ngc5921.cloud_offsets’]</p>
</dd>
<dt>hm_toffset</dt><dd><p>If ‘manual’, set the ‘toffset’ parameter to the user-specified
value. If ‘automatic’, set the ‘toffset’ parameter according to the
date of the MeasurementSet; toffset=-1 if before 2013-01-21T00:00:00
toffset=0 otherwise.</p>
</dd>
<dt>toffset</dt><dd><p>Time offset (sec) between interferometric and WVR data.</p>
</dd>
<dt>segsource</dt><dd><p>If True calculate new atmospheric phase correction
coefficients for each source, subject to the
constraints of the <code class="docutils literal notranslate"><span class="pre">tie</span></code> parameter. <code class="docutils literal notranslate"><span class="pre">segsource</span></code> is
forced to be True if the <code class="docutils literal notranslate"><span class="pre">tie</span></code> parameter is set to a
non-empty value by the user or by the automatic
heuristic.</p>
</dd>
<dt>sourceflag</dt><dd><p>Flag the WVR data for these source(s) as bad and do not
produce corrections for it. Requires
<code class="docutils literal notranslate"><span class="pre">segsource</span></code> = True.</p>
<p>Example: sourceflag=[‘3C273’]</p>
</dd>
<dt>hm_tie</dt><dd><p>If ‘manual’, set the <code class="docutils literal notranslate"><span class="pre">tie</span></code> parameter to the
user-specified value. If ‘automatic’, set the <code class="docutils literal notranslate"><span class="pre">tie</span></code>
parameter to include with the target all calibrators
that are within 15 degrees of it: if no calibrators are
that close then <code class="docutils literal notranslate"><span class="pre">tie</span></code> is left empty.</p>
</dd>
<dt>tie</dt><dd><p>Use the same atmospheric phase correction coefficients
when calculating the WVR correction for all sources in
the <code class="docutils literal notranslate"><span class="pre">tie</span></code>. If <code class="docutils literal notranslate"><span class="pre">tie</span></code> is not empty then <code class="docutils literal notranslate"><span class="pre">segsource</span></code>
is forced to be True. Ignored unless <code class="docutils literal notranslate"><span class="pre">hm_tie</span></code> = ‘manual’.</p>
<p>Example: tie=[‘3C273,NGC253’, ‘IC433,3C279’]</p>
</dd>
<dt>nsol</dt><dd><p>Number of solutions for phase correction coefficients during this
observation, evenly distributed in time throughout the observation. It
is used only if segsource=False because if segsource=True then the
coefficients are recomputed whenever the telescope moves to a new
source (within the limits imposed by ‘tie’).</p>
</dd>
<dt>disperse</dt><dd><p>Apply correction for dispersion.
(Deprecated; will be removed)</p>
</dd>
<dt>wvrflag</dt><dd><p>Flag the WVR data for these antenna(s) as bad and replace its data
with interpolated values.</p>
<p>Example: wvrflag=[‘DV03’,’DA05’,’PM02’]</p>
</dd>
<dt>hm_smooth</dt><dd><p>If ‘manual’ set the ‘smooth’ parameter to the user-specified value.
If ‘automatic’, run the wvrgcal task with the range of ‘smooth’ parameters
required to match the integration time of the WVR data to that of the
interferometric data in each spectral window.</p>
</dd>
<dt>smooth</dt><dd><p>Smooth WVR data on this timescale before calculating the correction.
Ignored unless hm_smooth=’manual’.</p>
</dd>
<dt>scale</dt><dd><p>Scale the entire phase correction by this factor.</p>
</dd>
<dt>maxdistm</dt><dd><p>Distance in meters of an antenna used for interpolation
from a flagged antenna.</p>
<p>Default: -1 (automatically set to 100m if &gt;50% of
antennas are 7m antennas without WVR and otherwise set
to 500m).</p>
<p>Example: maxdistm=550</p>
</dd>
<dt>minnumants</dt><dd><p>Minimum number of nearby antennas (up to 3) used for
interpolation from a flagged antenna.</p>
<p>Example: minnumants=3</p>
</dd>
<dt>mingoodfrac</dt><dd><p>Minimum fraction of good data per antenna.</p>
<p>Example: mingoodfrac=0.7</p>
</dd>
<dt>refant</dt><dd><p>Ranked comma delimited list of reference antennas.</p>
<p>Example: refant=’DV02,DV06’</p>
</dd>
<dt>flag_intent</dt><dd><p>The data intent(s) on whose WVR correction results the
search for bad WVR antennas is to be based.</p>
<p>A ‘flagging view’ will be calculated for each specified
intent, in each spectral window in each vis file.</p>
<p>Each ‘flagging view’ will consist of a 2-d image with dimensions
[‘ANTENNA’, ‘TIME’], showing the phase noise after the WVR
correction has been applied.</p>
<p>If flag_intent is left blank, the default, the flagging views will be
derived from data with the default bandpass calibration intent i.e.
the first in the list BANDPASS, PHASE, AMPLITUDE for which the
MeasurementSet has data.</p>
</dd>
<dt>qa_intent</dt><dd><p>The list of data intents on which the WVR correction is to be
tried as a means of estimating its effectiveness.</p>
<p>A QA ‘view’ will be calculated for each specified intent, in each spectral
window in each vis file.</p>
<p>Each QA ‘view’ will consist of a pair of 2-d images with dimensions
[‘ANTENNA’, ‘TIME’], one showing the data phase-noise before the
WVR application, the second showing the phase noise after (both ‘before’
and ‘after’ images have a bandpass calibration applied as well).</p>
<p>An overall QA score is calculated for each vis file, by dividing the
‘before’ images by the ‘after’ and taking the median of the result. An
overall score of 1 would correspond to no change in the phase noise,
a score &gt; 1 implies an improvement.</p>
<p>If the overall score for a vis file is less than the value in
‘accept_threshold’ then the WVR calibration file is not made available for
merging into the context for use in the subsequent reduction.</p>
</dd>
<dt>qa_bandpass_intent</dt><dd><p>The data intent to use for the bandpass calibration in
the qa calculation. The default is blank to allow the underlying bandpass
task to select a sensible intent if the dataset lacks BANDPASS data.</p>
</dd>
<dt>accept_threshold</dt><dd><p>The phase-rms improvement ratio
(rms without WVR / rms with WVR) above which the wrvg file will be
accepted into the context for subsequent application.</p>
</dd>
<dt>flag_hi</dt><dd><p>True to flag high figure of merit outliers.</p>
</dd>
<dt>fhi_limit</dt><dd><p>Flag figure of merit values higher than limit * MAD.</p>
</dd>
<dt>fhi_minsample</dt><dd><p>Minimum number of samples for valid MAD estimate.</p>
</dd>
<dt>ants_with_wvr_thresh</dt><dd><p>This threshold sets the minimum fraction of antennas
that should have WVR data for WVR calibration and flagging to proceed; the
same threshold is used to determine, after flagging, whether there remain
enough unflagged antennas with WVR data for the WVR calibration to be
applied.</p>
<p>Example: ants_with_wvr_thresh=0.5</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Compute the WVR calibration for all the MeasurementSets:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hifa_wvrgcalflag</span><span class="p">(</span><span class="n">hm_tie</span><span class="o">=</span><span class="s1">&#39;automatic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020–2024, Pipeline Dev. Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>