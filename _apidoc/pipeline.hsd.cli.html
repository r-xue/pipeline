

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pipeline.hsd.cli package &mdash; Pipeline unknown documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/custom_theme.css?v=678032d9" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=3f1b9271"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Pipeline
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Pipeline Tasks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pipeline_tasks/pipeline_tasks.html">Pipeline Heuristics Tasks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Pipeline Task (sphinx-autosummary)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.h.cli.html">pipeline.h.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.hif.cli.html">pipeline.hif.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.hifa.cli.html">pipeline.hifa.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.hifv.cli.html">pipeline.hifv.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.hsd.cli.html">pipeline.hsd.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.hsdn.cli.html">pipeline.hsdn.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.domain.html">pipeline.domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.infrastructure.launcher.html">pipeline.infrastructure.launcher</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.domain.html">pipeline.domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.infrastructure.launcher.html">pipeline.infrastructure.launcher</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Pipeline Heuristics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../heuristics/field_parameter.html">Field parameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../heuristics/FlaggingTasks.html">Pipeline Flagging Tasks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Releases etc.</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Pipeline Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modular.html">Run the Pipeline in a Conda environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dependencies.html">Dependencies of <cite>Pipeline</cite></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Pipeline Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../basics.html">pipeline.domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics.html#module-pipeline.infrastructure.launcher">pipeline.infrastructure.launcher</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Task Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../task_classes.html">pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../task_classes.html#module-pipeline.hif.tasks">pipeline-l2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../task_classes.html#module-pipeline.hif">pipeline-l3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../task_classes.html#pipeline-diagram">pipeline-diagram</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/ways_to_run_the_pipeline.html">Ways to run the Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/comparing_pipeline_executions.html">Comparing pipeline executions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/building_the_pipeline.html">Building the pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/ALMA-Imaging-Workflow.html">ALMA interferometry imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/VLA-Imaging-Workflow.html">VLA interferometry imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/VLASS-SE-CONT-Imaging-Workflow.html">VLASS-SE-CONT imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/VLASS-SE-CUBE-Imaging-Workflow.html">VLASS-SE-CUBE imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/selfcal_workflow.html">VLASS Selfcal &amp; Restore workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/pipeline_tests.html">Pipeline testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/DataType_Testing.html">DataType Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/QA_scores.html">Pipeline Quality Assurance (QA) Score Class Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/DeveloperDocumentation.html">Pipeline developer documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/python3_conversion_notes.html">Python 3 conversion notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/recipes.html">Pipeline Recipes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples Notes (from Jupyter Notebooks)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/test1.html">test</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example Notes (from .rst)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/test2.html">Example 1</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Pipeline</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">pipeline.hsd.cli package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_apidoc/pipeline.hsd.cli.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pipeline-hsd-cli-package">
<h1>pipeline.hsd.cli package<a class="headerlink" href="#pipeline-hsd-cli-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-pipeline.hsd.cli.hsd_applycal">
<span id="pipeline-hsd-cli-hsd-applycal-module"></span><h2>pipeline.hsd.cli.hsd_applycal module<a class="headerlink" href="#module-pipeline.hsd.cli.hsd_applycal" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_applycal.hsd_applycal">
<span class="sig-name descname"><span class="pre">hsd_applycal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">applymode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calwt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flagbackup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_applycal.html#hsd_applycal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_applycal.hsd_applycal" title="Link to this definition"></a></dt>
<dd><p>hsd_applycal —- Apply the calibration(s) to the data</p>
<p>Apply the calibration to the data.</p>
<p>hsd_applycal applies the precomputed calibration tables stored in the pipeline
context to the set of visibility files using predetermined field and
spectral window maps and default values for the interpolation schemes.</p>
<p>Users can interact with the pipeline calibration state using the tasks
h_export_calstate and h_import_calstate.</p>
<p>Output:</p>
<p>results – The results object for the pipeline task is returned</p>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis           The list of input MeasurementSets. Defaults to the list of MeasurementSets</dt><dd><p>in the pipeline context.
example: [‘X227.ms’]</p>
</dd>
<dt>field         A string containing the list of field names or field ids to which</dt><dd><p>the calibration will be applied. Defaults to all fields in the pipeline context.
example: ‘3C279’, ‘3C279, M82’</p>
</dd>
<dt>intent        A string containing the list of intents against which the</dt><dd><p>selected fields will be matched. Defaults to all supported intents
in the pipeline context.
example: <cite>‘*TARGET*’</cite></p>
</dd>
<dt>spw           The list of spectral windows and channels to which the calibration</dt><dd><p>will be applied. Defaults to all science windows in the pipeline context.
example: ‘17’, ‘11, 15’</p>
</dd>
<dt>antenna       The selection of antennas to which the calibration will be applied.</dt><dd><p>Defaults to all antennas. Not currently supported.</p>
</dd>
<dt>applymode       Calibration apply mode</dt><dd><p>‘calflag’: calibrate data and apply flags from solutions
‘calflagstrict’: same as above except flag spws for which calibration is</p>
<blockquote>
<div><p>unavailable in one or more tables (instead of allowing them to pass
uncalibrated and unflagged)</p>
</div></blockquote>
<p>‘trial’: report on flags from solutions, dataset entirely unchanged
‘flagonly’: apply flags from solutions only, data not calibrated
‘flagonlystrict’: same as above except flag spws for which calibration is</p>
<blockquote>
<div><p>unavailable in one or more tables</p>
</div></blockquote>
<p>‘calonly’: calibrate data only, flags from solutions NOT applied</p>
</dd>
</dl>
<p>calwt         Calibrate the weights as well as the data.
flagbackup    Backup the flags before the apply.
parallel      Execute using CASA HPC functionality, if available.</p>
<blockquote>
<div><p>options: ‘automatic’, ‘true’, ‘false’, True, False
default: None (equivalent to ‘automatic’)</p>
</div></blockquote>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Apply the calibration to the target data</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_applycal</span> <span class="p">(</span><span class="n">intent</span><span class="o">=</span><span class="s1">&#39;TARGET&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Specify fields and spectral windows</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_applycal</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">&#39;3C279, M82&#39;</span><span class="p">,</span> <span class="n">spw</span><span class="o">=</span><span class="s1">&#39;17&#39;</span><span class="p">,</span> <span class="n">intent</span><span class="o">=</span><span class="s1">&#39;TARGET&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>——— issues ———————————————————–</p>
<p>There is some discussion about the appropriate values of calwt. Given
properly scaled data, the correct value should be the CASA default of True.
However at the current time ALMA is suggesting that calwt be set to True for
applying observatory calibrations, e.g. antenna positions, WVR, and system
temperature corrections, and to False for applying instrument calibrations,
e.g. bandpass, gain, and flux.</p>
</dd></dl>

</section>
<section id="module-pipeline.hsd.cli.hsd_atmcor">
<span id="pipeline-hsd-cli-hsd-atmcor-module"></span><h2>pipeline.hsd.cli.hsd_atmcor module<a class="headerlink" href="#module-pipeline.hsd.cli.hsd_atmcor" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_atmcor.hsd_atmcor">
<span class="sig-name descname"><span class="pre">hsd_atmcor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtem_dh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_atmcor.html#hsd_atmcor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_atmcor.hsd_atmcor" title="Link to this definition"></a></dt>
<dd><p>hsd_atmcor —- Apply offline ATM correction to the data.</p>
<p>The hsd_atmcor task provides the capability of offline correction of
residual atmospheric features in the calibrated single-dish spectra
originated from incomplete calibration mainly due to a difference of
elevation angles between ON_SOURCE and OFF_SOURCE measurements.</p>
<p>Optimal atmospheric model is automatically determined by default
(atmtype = ‘auto’). You may specify desired atmospheric model by giving
either single integer (apply to all EBs) or a list of integers (models
per EB) to atmtype parameter. Please see parameter description for the
meanings of integer values.</p>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>atmtype       Type of atmospheric transmission model represented as an integer.</dt><dd><p>Available options are as follows. Integer values can be given as
either integer or string, i.e. both 1 and ‘1’ are acceptable.</p>
<blockquote>
<div><dl class="simple">
<dt>‘auto’: perform heuristics to choose best model (default)</dt><dd><p>1: tropical
2: mid latitude summer
3: mid latitude winter
4: subarctic summer
5: subarctic winter</p>
</dd>
</dl>
</div></blockquote>
<p>If list of integer is given, it also performs heuristics using the
provided values instead of default, [1, 2, 3, 4], which is used
when ‘auto’ is provided. List input should not contain ‘auto’.</p>
<p>Default: ‘auto’</p>
</dd>
</dl>
<p>dtem_dh       Temperature gradient [K/km], e.g. -5.6. (”” = Tool default)</p>
<blockquote>
<div><p>The value is directly passed to initialization method for ATM model.
Float and string types are acceptable. Float value is interpreted as
the value in K/km. String value should be the numeric value with unit
such as ‘-5.6K/km’. When list of values are given, it will
trigger heuristics to choose best model from the provided value.</p>
<p>Default: ‘’ (tool default, -5.6K/km, is used)</p>
</div></blockquote>
<p>h0            Scale height for water [km], e.g. 2.0. (”” = Tool default)</p>
<blockquote>
<div><p>The value is directly passed to initialization method for ATM model.
Float and string types are acceptable. Float value is interpreted as
the value in kilometer. String value should be the numeric value with
unit compatible with length, such as ‘2km’ or ‘2000m’.
When list of values are given, it will trigger heuristics to
choose best model from the provided value.</p>
<p>Default: ‘’ (tool default, 2.0km, is used)</p>
</div></blockquote>
<dl class="simple">
<dt>infiles       ASDM or MS files to be processed. This parameter behaves</dt><dd><p>as data selection parameter. The name specified by
infiles must be registered to context before you run
hsd_atmcor.</p>
</dd>
<dt>antenna       Data selection by antenna names or ids.</dt><dd><dl class="simple">
<dt>example: ‘PM03,PM04’</dt><dd><p>‘’ (all antennas)</p>
</dd>
</dl>
</dd>
<dt>field         Data selection by field names or ids.</dt><dd><dl class="simple">
<dt>example: ‘<cite>*Sgr*,M100</cite>’</dt><dd><p>‘’ (all fields)</p>
</dd>
</dl>
</dd>
<dt>spw           Data selection by spw ids.</dt><dd><dl class="simple">
<dt>example: ‘3,4’ (spw 3 and 4)</dt><dd><p>‘’ (all spws)</p>
</dd>
</dl>
</dd>
<dt>pol           Data selection by polarizations.</dt><dd><dl class="simple">
<dt>example: ‘XX,YY’ (correlation XX and YY)</dt><dd><p>‘’ (all polarizations)</p>
</dd>
</dl>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Basic usage</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_atmcor</span><span class="p">()</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Specify atmospheric model and data selection</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_atmcor</span><span class="p">(</span><span class="n">atmtype</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">antenna</span><span class="o">=</span><span class="s1">&#39;PM03,PM04&#39;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;*Sgr*,M100&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Specify atmospheric model per EB (atmtype 1 for 1st EB, 2 for 2nd EB)</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_atmcor</span><span class="p">(</span><span class="n">atmtype</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hsd.cli.hsd_baseline">
<span id="pipeline-hsd-cli-hsd-baseline-module"></span><h2>pipeline.hsd.cli.hsd_baseline module<a class="headerlink" href="#module-pipeline.hsd.cli.hsd_baseline" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_baseline.hsd_baseline">
<span class="sig-name descname"><span class="pre">hsd_baseline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitfunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">switchpoly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewindow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewindowmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">broadline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clusteringalgorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deviationmask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_baseline.html#hsd_baseline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_baseline.hsd_baseline" title="Link to this definition"></a></dt>
<dd><p>hsd_baseline —- Detect and validate spectral lines, subtract baseline by masking detected lines</p>
<p>The hsd_baseline task subtracts baseline from calibrated spectra.
By default, the task tries to find spectral line feature using
line detection and validation algorithms. Then, the task puts a
mask on detected lines and perform baseline subtraction.
The user is able to turn off automatic line masking by setting
linewindow parameter, which specifies pre-defined line window.</p>
<p>Fitting order is automatically determined by default. It can be
disabled by specifying fitorder as non-negative value. In this
case, the value specified by fitorder will be used.</p>
<p><strong>*WARNING*</strong>
Currently, hsd_baseline overwrites the result obtained by the
previous run. Due to this behavior, users need to be careful
about an order of the task execution when they run hsd_baseline
multiple times with different data selection. Suppose there are
two spectral windows (0 and 1) and hsd_baseline is executed
separately for each spw as below,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_baseline</span><span class="p">(</span><span class="n">spw</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_baseline</span><span class="p">(</span><span class="n">spw</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_blflag</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_imaging</span><span class="p">()</span>
</pre></div>
</div>
<p>Since the second run of hsd_baseline overwrites the result for
spw 0 with the data before baseline subtraction, this will not
produce correct result for spw 0. Proper sequence for this use
case is to process each spw to the imaging stage separately,
which looks like as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_baseline</span><span class="p">(</span><span class="n">spw</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_blflag</span><span class="p">(</span><span class="n">spw</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_imaging</span><span class="p">(</span><span class="n">spw</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_baseline</span><span class="p">(</span><span class="n">spw</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_blflag</span><span class="p">(</span><span class="n">spw</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_imaging</span><span class="p">(</span><span class="n">spw</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:
results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>fitfunc             Fitting function for baseline subtraction. You can choose</dt><dd><p>either cubic spline (‘spline’ or ‘cspline’) or polynomial
(‘poly’ or ‘polynomial’). Default is ‘cspline’.</p>
</dd>
<dt>fitorder            Fitting order for polynomial. For cubic spline, it is used</dt><dd><p>to determine how much the spectrum is segmented into.
Default (-1) is to determine the order automatically.</p>
</dd>
<dt>switchpoly          Whether to fall back the fits from cubic spline to 1st or</dt><dd><p>2nd order polynomial when large masks exist at the edges
of the spw. Condition for switching is as follows:</p>
<blockquote>
<div><p>if nmask &gt; nchan/2      =&gt; 1st order polynomial
else if nmask &gt; nchan/4 =&gt; 2nd order polynomial
else                    =&gt; use fitfunc and fitorder</p>
</div></blockquote>
<p>where nmask is a number of channels for mask at edge while
nchan is a number of channels of entire spectral window.</p>
</dd>
<dt>linewindow          Pre-defined line window. If this is set, specified line</dt><dd><p>windows are used as a line mask for baseline subtraction
instead to determine masks based on line detection and
validation stage. Several types of format are acceptable.
One is channel-based window,</p>
<blockquote>
<div><p>[min_chan, max_chan]</p>
</div></blockquote>
<p>where min_chan and max_chan should be an integer. For
multiple  windows, nested list is also acceptable,</p>
<blockquote>
<div><p>[[min_chan0, max_chan0], [min_chan1, max_chan1], …]</p>
</div></blockquote>
<dl class="simple">
<dt>Another way is frequency-based window,</dt><dd><p>[min_freq, max_freq]</p>
</dd>
</dl>
<p>where min_freq and max_freq should be either a float or
a string. If float value is given, it is interpreted as
a frequency in Hz. String should be a quantity consisting
of “value” and “unit”,
e.g., ‘100GHz’. Multiple windows are also supported.</p>
<blockquote>
<div><p>[[min_freq0, max_freq0], [min_freq1, max_freq1], …]</p>
</div></blockquote>
<p>Note that the specified frequencies are assumed to be
the value in LSRK frame. Note also that there is a
limitation when multiple MSes are processed.
If native frequency frame of the data is not LSRK
(e.g. TOPO), frequencies need to be converted to that
frame. As a result, corresponding channel range may vary
between MSes. However, current implementation is not
able to handle such case. Frequencies are converted to
desired frame using representative MS (time, position,
direction).</p>
<p>In the above cases, specified line windows are applied
to all science spws. In case when line windows vary with
spw, line windows can be specified by a dictionary whose
key is spw id while value is line window.
For example, the following dictionary gives different
line windows to spws 17 and 19. Other spws, if available,
will have an empty line window.</p>
<blockquote>
<div><p>{17: [[100, 200], [1200, 1400]], 19: [‘112115MHz’, ‘112116MHz’]}</p>
</div></blockquote>
<p>Furthermore, linewindow accepts MS selection string.
The following string gives [[100,200],[1200,1400]] for
spw 17 while [1000,1500] for spw 21.</p>
<blockquote>
<div><p>“17:100~200;1200~1400,21:1000~1500”</p>
</div></blockquote>
<p>The string also accepts frequency with units. Note,
however, that frequency reference frame in this case is
not fixed to LSRK. Instead, the frame will be taken from
the MS (typically TOPO for ALMA).
Thus, the following two frequency-based line windows
result different channel selections.</p>
<blockquote>
<div><p>{19: [‘112115MHz’, ‘112116MHz’]} # frequency frame is LSRK
“19:11215MHz~11216MHz” # frequency frame is taken from the data</p>
<blockquote>
<div><p># (TOPO for ALMA)</p>
</div></blockquote>
</div></blockquote>
<p>None is allowed as a value of dictionary input to indicate that
no line detection/validation is required even if manually specified
line window does not exist. When None is given as a value and if
<code class="docutils literal notranslate"><span class="pre">linewindowmode</span></code> is ‘replace’, line detection/validation is not performed
for the corresponding spw. For example, suppose the following parameters
are given for the data with four science spws, 17, 19, 21, and 23.</p>
<blockquote>
<div><p>linewindow={17: [112.1e9, 112.2e9], 19: [113.1e9, 113.15e9], 21: None}
linewindowmode=’replace’</p>
</div></blockquote>
<p>The task will use given line window for 17 and 19 while the task performs
line deteciton/validation for spw 23 because no line window is set.
On the other hand, line detection/validation is skipped for spw 21 due to
the effect of None.</p>
<dl class="simple">
<dt>example: [100,200] (channel), [115e9, 115.1e9] (frequency in Hz)</dt><dd><p>[‘115GHz’, ‘115.1GHz’], see above for more examples</p>
</dd>
</dl>
</dd>
<dt>linewindowmode      Merge or replace given manual line window with line</dt><dd><p>detection/validation result. If ‘replace’ is given, line
detection and validation will not be performed.
On the other hand, when ‘merge’ is specified, line
detection/validation will be performed and manually
specified line windows are added to the result.</p>
<p>Note that this has no effect when linewindow for target
spw is an empty list. In that case, line detection/validation
will be performed regardless of the value of linewindowmode.
In case if no linewindow nor line detection/validation
are necessary, you should set linewindowmode to ‘replace’
and specify None as a value of the linewindow dictionary
for the spw to apply. See parameter description of <code class="docutils literal notranslate"><span class="pre">linewindow</span></code>
for detail.</p>
</dd>
<dt>edge                Number of edge channels to be dropped from baseline</dt><dd><p>subtraction. The value must be a list with length of 2,
whose values specify left and right edge channels,
respectively.</p>
<p>example: [10,10]</p>
</dd>
</dl>
<p>broadline           Try to detect broad component of spectral line if True.</p>
<dl>
<dt>clusteringalgorithm Selection of the algorithm used in the clustering</dt><dd><blockquote>
<div><p>analysis to check the validity of detected line features.</p>
</div></blockquote>
<p>‘kmean’ algorithm and hierarchical clustering algorithm
‘hierarchy’, and their combination (‘both’) are so far
implemented.</p>
</dd>
<dt>deviationmask       Apply deviation mask in addition to masks determined by</dt><dd><p>the automatic line detection.</p>
</dd>
<dt>parallel            Execute using CASA HPC functionality, if available.</dt><dd><p>options: ‘automatic’, ‘true’, ‘false’, True, False
default: None (equivalent to ‘automatic’)</p>
</dd>
<dt>infiles             List of data files. These must be a name of</dt><dd><p>MeasurementSets that are registered to context via
hsd_importdata task.</p>
<p>example: vis=[‘X227.ms’, ‘X228.ms’]</p>
</dd>
<dt>field               Data selection by field.</dt><dd><dl class="simple">
<dt>example: ‘1’ (select by FIELD_ID)</dt><dd><p>‘M100*’ (select by field name)
‘’ (all fields)</p>
</dd>
</dl>
</dd>
<dt>antenna             Data selection by antenna.</dt><dd><dl class="simple">
<dt>example: ‘1’ (select by ANTENNA_ID)</dt><dd><p>‘PM03’ (select by antenna name)
‘’ (all antennas)</p>
</dd>
</dl>
</dd>
<dt>spw                 Data selection by spw.</dt><dd><dl class="simple">
<dt>example: ‘3,4’ (generate caltable for spw 3 and 4)</dt><dd><p>[‘0’,’2’] (spw 0 for first data, 2 for second)
‘’ (all spws)</p>
</dd>
</dl>
</dd>
<dt>pol                 Data selection by polarizations.</dt><dd><dl class="simple">
<dt>example: ‘0’ (generate caltable for pol 0)</dt><dd><p>[‘0~1’,’0’] (pol 0 and 1 for first data, only 0 for second)
‘’ (all polarizations)</p>
</dd>
</dl>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Basic usage with automatic line detection and validation</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_baseline</span><span class="p">(</span><span class="n">antenna</span><span class="o">=</span><span class="s1">&#39;PM03&#39;</span><span class="p">,</span> <span class="n">spw</span><span class="o">=</span><span class="s1">&#39;17,19&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Using pre-defined line windows without automatic line detection
and edge channels</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_baseline</span><span class="p">(</span><span class="n">linewindow</span><span class="o">=</span><span class="p">[[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="p">[</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">1400</span><span class="p">]],</span>
<span class="go">                 linewindowmode=&#39;replace&#39;, edge=[10, 10])</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Using per spw pre-defined line windows with automatic line detection</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_baseline</span><span class="p">(</span><span class="n">linewindow</span><span class="o">=</span><span class="p">{</span><span class="mi">19</span><span class="p">:</span> <span class="p">[[</span><span class="mi">390</span><span class="p">,</span> <span class="mi">550</span><span class="p">]],</span> <span class="mi">23</span><span class="p">:</span> <span class="p">[[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="p">[</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">1400</span><span class="p">]]},</span>
<span class="go">                 linewindowmode=&#39;merge&#39;)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hsd.cli.hsd_blflag">
<span id="pipeline-hsd-cli-hsd-blflag-module"></span><h2>pipeline.hsd.cli.hsd_blflag module<a class="headerlink" href="#module-pipeline.hsd.cli.hsd_blflag" title="Link to this heading"></a></h2>
<p>Created on 2013/06/23</p>
<p>&#64;author: kana</p>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_blflag.hsd_blflag">
<span class="sig-name descname"><span class="pre">hsd_blflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_tsys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tsys_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_prfre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prfre_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_pofre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pofre_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_prfr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prfr_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_pofr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pofr_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_prfrm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prfrm_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prfrm_nmean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_pofrm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pofrm_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pofrm_nmean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_blflag.html#hsd_blflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_blflag.hsd_blflag" title="Link to this definition"></a></dt>
<dd><p>hsd_blflag —- Flag spectra based on predefined criteria of single dish pipeline</p>
<p>Data are flagged based on several flagging rules. Available rules are:
expected rms, calculated rms, and running mean of both pre-fit and
post-fit spectra. Tsys flagging is also available.</p>
<p>In addition, the heuristics script creates many plots for each stage.
Those plots are included in the weblog.</p>
<p>Output:</p>
<p>results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>iteration     Number of iterations to perform sigma clipping to</dt><dd><p>calculate threshold value of flagging.</p>
</dd>
<dt>edge          Number of channels to be dropped from the edge.</dt><dd><dl class="simple">
<dt>The value must be a list of integer with length of one or</dt><dd><p>two. If list length is one, same number will be applied</p>
</dd>
</dl>
<p>both side of the band.</p>
<p>example: [10,20], [10]</p>
</dd>
</dl>
<p>flag_tsys     Activate (True) or deactivate (False) Tsys flag.
tsys_thresh   Threshold value for Tsys flag.
flag_prfre    Activate (True) or deactivate (False) flag by expected</p>
<blockquote>
<div><p>rms of pre-fit spectra.</p>
</div></blockquote>
<dl class="simple">
<dt>prfre_thresh  Threshold value for flag by expected rms of pre-fit</dt><dd><p>spectra.</p>
</dd>
<dt>flag_pofre    Activate (True) or deactivate (False) flag by expected</dt><dd><p>rms of post-fit spectra.</p>
</dd>
<dt>pofre_thresh  Threshold value for flag by expected rms of post-fit</dt><dd><p>spectra.</p>
</dd>
<dt>flag_prfr     Activate (True) or deactivate (False) flag by rms of</dt><dd><p>pre-fit spectra.</p>
</dd>
</dl>
<p>prfr_thresh   Threshold value for flag by rms of pre-fit spectra.
flag_pofr     Activate (True) or deactivate (False) flag by rms of</p>
<blockquote>
<div><p>post-fit spectra.</p>
</div></blockquote>
<p>pofr_thresh   Threshold value for flag by rms of post-fit spectra.
flag_prfrm    Activate (True) or deactivate (False) flag by running</p>
<blockquote>
<div><p>mean of pre-fit spectra.</p>
</div></blockquote>
<dl class="simple">
<dt>prfrm_thresh  Threshold value for flag by running mean of pre-fit</dt><dd><p>spectra.</p>
</dd>
</dl>
<p>prfrm_nmean   Number of channels for running mean of pre-fit spectra.
flag_pofrm    Activate (True) or deactivate (False) flag by running</p>
<blockquote>
<div><p>mean of post-fit spectra.</p>
</div></blockquote>
<dl class="simple">
<dt>pofrm_thresh  Threshold value for flag by running mean of post-fit</dt><dd><p>spectra.</p>
</dd>
</dl>
<p>pofrm_nmean   Number of channels for running mean of post-fit spectra.
plotflag      True to plot result of data flagging.
parallel      Execute using CASA HPC functionality, if available.</p>
<blockquote>
<div><p>options: ‘automatic’, ‘true’, ‘false’, True, False
default: None (equivalent to ‘automatic’)</p>
</div></blockquote>
<dl class="simple">
<dt>infiles       ASDM or MS files to be processed. This parameter behaves</dt><dd><p>as data selection parameter. The name specified by
infiles must be registered to context before you run
hsd_blflag.</p>
</dd>
<dt>antenna       Data selection by antenna names or ids.</dt><dd><dl class="simple">
<dt>example: ‘PM03,PM04’</dt><dd><p>‘’ (all antennas)</p>
</dd>
</dl>
</dd>
<dt>field         Data selection by field names or ids.</dt><dd><dl class="simple">
<dt>example: ‘<cite>*Sgr*,M100</cite>’</dt><dd><p>‘’ (all fields)</p>
</dd>
</dl>
</dd>
<dt>spw           Data selection by spw ids.</dt><dd><dl class="simple">
<dt>example: ‘3,4’ (spw 3 and 4)</dt><dd><p>‘’ (all spws)</p>
</dd>
</dl>
</dd>
<dt>pol           Data selection by polarizations.</dt><dd><dl class="simple">
<dt>example: ‘XX,YY’ (correlation XX and YY)</dt><dd><p>‘’ (all polarizations)</p>
</dd>
</dl>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>flagging with all rules</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_blflag</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hsd.cli.hsd_exportdata">
<span id="pipeline-hsd-cli-hsd-exportdata-module"></span><h2>pipeline.hsd.cli.hsd_exportdata module<a class="headerlink" href="#module-pipeline.hsd.cli.hsd_exportdata" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_exportdata.hsd_exportdata">
<span class="sig-name descname"><span class="pre">hsd_exportdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pprfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetimages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">products_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_exportdata.html#hsd_exportdata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_exportdata.hsd_exportdata" title="Link to this definition"></a></dt>
<dd><p>hsd_exportdata —- Prepare single dish data for export</p>
<p>The hsd_exportdata task exports the data defined in the pipeline context
and exports it to the data products directory, converting and or packing
it as necessary.</p>
<p>The current version of the task exports the following products</p>
<ul class="simple">
<li><p>a FITS image for each selected science target source image</p></li>
<li><p>a tar file per ASDM containing the final flags version and blparam</p></li>
<li><p>a tar file containing the file web log</p></li>
</ul>
<p>Output:</p>
<p>results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<dl class="simple">
<dt>pprfile       Name of the pipeline processing request to be exported. Defaults</dt><dd><p>to a file matching the template ‘PPR_*.xml’.
example: pprfile=[‘PPR_GRB021004.xml’]</p>
</dd>
<dt>targetimages  List of science target images to be exported. Defaults to all</dt><dd><p>science target images recorded in the pipeline context.
example: targetimages=[‘r_aqr.CM02.spw5.line0.XXYY.sd.im’, ‘r_aqr.CM02.spw5.XXYY.sd.cont.im’]</p>
</dd>
<dt>products_dir  Name of the data products subdirectory. Defaults to ‘./’</dt><dd><p>example: products_dir=’../products’</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Export the pipeline results for a single session to the data products
directory</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; !mkdir ../products
&gt;&gt;&gt; hsd_exportdata (products_dir=&#39;../products&#39;)
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hsd.cli.hsd_flagdata">
<span id="pipeline-hsd-cli-hsd-flagdata-module"></span><h2>pipeline.hsd.cli.hsd_flagdata module<a class="headerlink" href="#module-pipeline.hsd.cli.hsd_flagdata" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_flagdata.hsd_flagdata">
<span class="sig-name descname"><span class="pre">hsd_flagdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autocorr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shadow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scannumber</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgespw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracspw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracspwfps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">online</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fileonline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetemplate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepointing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incompleteraster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_tbuff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tbuff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flagbackup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_flagdata.html#hsd_flagdata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_flagdata.hsd_flagdata" title="Link to this definition"></a></dt>
<dd><p>hsd_flagdata —- Do basic flagging of a list of MeasurementSets</p>
<p>The hsd_flagdata data performs basic flagging operations on a list of
MeasurementSets including:</p>
<ul class="simple">
<li><p>applying online flags</p></li>
<li><p>applying a flagging template</p></li>
<li><p>shadowed antenna data flagging</p></li>
<li><p>scan-based flagging by intent or scan number</p></li>
<li><p>edge channel flagging</p></li>
</ul>
<p>Output:</p>
<p>results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<dl class="simple">
<dt>vis              The list of input MeasurementSets. Defaults to the list of MeasurementSets</dt><dd><p>defined in the pipeline context.</p>
</dd>
</dl>
<p>autocorr         Flag autocorrelation data.
shadow           Flag shadowed antennas.
scan             Flag a list of scans and intents specified by scannumber and intents.
scannumber       A string containing a comma delimited list of scans to be</p>
<blockquote>
<div><p>flagged.</p>
</div></blockquote>
<dl>
<dt>intents          A string containing a comma delimited list of intents against</dt><dd><p>which the scans to be flagged are matched.</p>
<p>example: <cite>‘*BANDPASS*’</cite></p>
</dd>
</dl>
<p>edgespw          Flag the edge spectral window channels.
fracspw          Fraction of the baseline correlator TDM edge channels to be flagged.
fracspwfps       Fraction of the ACS correlator TDM edge channels to be flagged.
online           Apply the online flags.
fileonline       File containing the online flags. These are computed by the</p>
<blockquote>
<div><p>h_init or hif_importdata data tasks. If the online flags files
are undefined a name of the form ‘msname.flagonline.txt’ is assumed.</p>
</div></blockquote>
<p>template         Apply a flagging template.
filetemplate     The name of a text file that contains the flagging template</p>
<blockquote>
<div><p>for RFI, birdies, telluric lines, etc.  If the template flags files
is undefined a name of the form ‘msname.flagtemplate.txt’ is assumed.</p>
</div></blockquote>
<p>pointing         Apply a flagging template for pointing flag.
filepointing     The name of a text file that contains the flagging template</p>
<blockquote>
<div><p>for pointing flag. If the template flags files is undefined a name of
the form ‘msname.flagpointing.txt’ is assumed.</p>
</div></blockquote>
<dl class="simple">
<dt>incompleteraster Apply commands to flag incomplete raster sequence.</dt><dd><p>If this is False, relevant commands in filepointing are
simply commented out.</p>
</dd>
<dt>hm_tbuff         The heuristic for computing the default time interval padding parameter.</dt><dd><p>The options are ‘halfint’ and ‘manual’. In ‘halfint’ mode tbuff is set to
half the maximum of the median integration time of the science and calibrator target
observations.</p>
</dd>
<dt>tbuff            The time in seconds used to pad flagging command time intervals if</dt><dd><p>hm_tbuff=’manual’.</p>
</dd>
</dl>
<p>qa0              QA0 flags
qa2              QA2 flags
parallel         Execute using CASA HPC functionality, if available.</p>
<blockquote>
<div><p>options: ‘automatic’, ‘true’, ‘false’, True, False
default: None (equivalent to ‘automatic’)</p>
</div></blockquote>
<p>flagbackup       Back up any pre-existing flags before applying new ones.</p>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Do basic flagging on a MeasurementSet</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_flagdata</span><span class="p">()</span>
</pre></div>
</div>
<p>2. Do basic flagging on a MeasurementSet flagging additional scans selected
by number as well.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_flagdata</span><span class="p">(</span><span class="n">scannumber</span><span class="o">=</span><span class="s1">&#39;13,18&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hsd.cli.hsd_imaging">
<span id="pipeline-hsd-cli-hsd-imaging-module"></span><h2>pipeline.hsd.cli.hsd_imaging module<a class="headerlink" href="#module-pipeline.hsd.cli.hsd_imaging" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_imaging.hsd_imaging">
<span class="sig-name descname"><span class="pre">hsd_imaging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restfreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_imaging.html#hsd_imaging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_imaging.hsd_imaging" title="Link to this definition"></a></dt>
<dd><p>hsd_imaging —- Generate single dish images</p>
<p>The hsd_imaging task generates single dish images per antenna as
well as combined image over whole antennas for each field and
spectral window. Image configuration (grid size, number of pixels,
etc.) is automatically determined based on meta data such as
antenna diameter, map extent, etc.</p>
<p>Note that generated images are always in LSRK frame.</p>
<p>Output:
results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<dl class="simple">
<dt>mode          Imaging mode controls imaging parameters in the task.</dt><dd><p>Accepts either “line” (spectral line imaging) or “ampcal”
(image settings for amplitude calibrator)</p>
</dd>
</dl>
<p>restfreq      Rest frequency
infiles       List of data files. These must be a name of</p>
<blockquote>
<div><p>MeasurementSets that are registered to context via
hsd_importdata task.
example: vis=[‘uid___A002_X85c183_X36f.ms’,</p>
<blockquote>
<div><p>‘uid___A002_X85c183_X60b.ms’]</p>
</div></blockquote>
</div></blockquote>
<dl class="simple">
<dt>field         Data selection by field names or ids.</dt><dd><p>example: “<cite>*Sgr*,M100</cite>”</p>
</dd>
<dt>spw           Data selection by spw ids.</dt><dd><p>example: “3,4” (generate images for spw 3 and 4)</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Generate images with default settings and context</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_imaging</span><span class="p">()</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Generate images with amplitude calibrator and specific parameters</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_imaging</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;ampcal&#39;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;*Sgr*,M100&#39;</span><span class="p">,</span> <span class="n">spw</span><span class="o">=</span><span class="s1">&#39;17,19&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hsd.cli.hsd_importdata">
<span id="pipeline-hsd-cli-hsd-importdata-module"></span><h2>pipeline.hsd.cli.hsd_importdata module<a class="headerlink" href="#module-pipeline.hsd.cli.hsd_importdata" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_importdata.hsd_importdata">
<span class="sig-name descname"><span class="pre">hsd_importdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_rasterscan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_caldevice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bdfflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datacolumns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_pointing_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">createmms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_importdata.html#hsd_importdata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_importdata.hsd_importdata" title="Link to this definition"></a></dt>
<dd><p>hsd_importdata —- Imports data into the single dish pipeline</p>
<p>The hsd_importdata task loads the specified visibility data into the pipeline
context unpacking and / or converting it as necessary.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> input parameter is set to False and the task is asked to
convert an input ASDM input to an MS, then when the output MS already exists in
the output directory, the importasdm conversion step is skipped, and the
existing MS will be imported instead.</p>
<p>Output:</p>
<p>results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<dl class="simple">
<dt>vis                      List of visibility data files. These may be ASDMs, tar files of ASDMs,</dt><dd><p>MSes, or tar files of MSes, If ASDM files are specified, they will be
converted to MS format.
example: vis=[‘X227.ms’, ‘asdms.tar.gz’]</p>
</dd>
<dt>session                  List of sessions to which the visibility files belong. Defaults</dt><dd><p>to a single session containing all the visibility files, otherwise
a session must be assigned to each vis file.
example: session=[‘Session_1’, ‘Sessions_2’]</p>
</dd>
<dt>hm_rasterscan            Heuristics method for raster scan analysis. Two analysis modes,</dt><dd><p>time-domain analysis (‘time’) and direction analysis (‘direction’), are available.
Default is ‘time’.</p>
</dd>
<dt>parallel                 Execute using CASA HPC functionality, if available.</dt><dd><p>options: ‘automatic’, ‘true’, ‘false’, True, False
default: None (equivalent to ‘automatic’)</p>
</dd>
<dt>asis                     Creates verbatim copies of the ASDM tables in the output MS.</dt><dd><p>The value given to this option must be a list of table names
separated by space characters.
example: ‘Receiver’, ‘’</p>
</dd>
<dt>process_caldevice        Ingest the ASDM caldevice table.</dt><dd><p>example: True</p>
</dd>
<dt>overwrite                Overwrite existing files on import.</dt><dd><p>When converting ASDM to MS, if overwrite=False and the MS already
exists in output directory, then this existing MS dataset will be used
instead.</p>
</dd>
</dl>
<p>nocopy                   Disable copying of MS to working directory
bdfflags                 Apply BDF flags on import.
datacolumns              Dictionary defining the data types of</p>
<blockquote>
<div><p>existing columns. The format is:</p>
<p>{‘data’: ‘data type 1’}
or
{‘data’: ‘data type 1’, ‘corrected’: ‘data type 2’}</p>
<p>For ASDMs the data type can only be RAW and one
can only specify it for the data column.</p>
<p>For MSes one can define two different data types
for the DATA and CORRECTED_DATA columns and they
can be any of the known data types (RAW,
REGCAL_CONTLINE_ALL, REGCAL_CONTLINE_SCIENCE,
SELFCAL_CONTLINE_SCIENCE, REGCAL_LINE_SCIENCE,
SELFCAL_LINE_SCIENCE, BASELINED, ATMCORR). The
intent selection strings _ALL or _SCIENCE can be
skipped. In that case the task determines this
automatically by inspecting the existing intents
in the dataset.</p>
<p>Usually, a single datacolumns dictionary is used
for all datasets. If necessary, one can define a
list of dictionaries, one for each EB, with
different setups per EB.</p>
<p>If no type is specified, {‘data’:’raw’} will
be assumed.</p>
</div></blockquote>
<p>lazy                     Use the lazy filter import
with_pointing_correction add (ASDM::Pointing::encoder - ASDM::Pointing::pointingDirection)</p>
<blockquote>
<div><p>to the value to be written in MS::Pointing::direction</p>
</div></blockquote>
<p>createmms                Create an MMS</p>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Load an ASDM list in the ../rawdata subdirectory into the context.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_importdata</span> <span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;../rawdata/uid___A002_X30a93d_X43e&#39;</span><span class="p">,</span> <span class="s1">&#39;../rawdata/uid_A002_x30a93d_X44e&#39;</span><span class="p">])</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Load an MS in the current directory into the context.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_importdata</span> <span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;uid___A002_X30a93d_X43e.ms&#39;</span><span class="p">])</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Load a tarred ASDM in ../rawdata into the context.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_importdata</span> <span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;../rawdata/uid___A002_X30a93d_X43e.tar.gz&#39;</span><span class="p">])</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Import a list of MeasurementSets.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">myvislist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;uid___A002_X30a93d_X43e.ms&#39;</span><span class="p">,</span> <span class="s1">&#39;uid_A002_x30a93d_X44e.ms&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_importdata</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="n">myvislist</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hsd.cli.hsd_k2jycal">
<span id="pipeline-hsd-cli-hsd-k2jycal-module"></span><h2>pipeline.hsd.cli.hsd_k2jycal module<a class="headerlink" href="#module-pipeline.hsd.cli.hsd_k2jycal" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_k2jycal.hsd_k2jycal">
<span class="sig-name descname"><span class="pre">hsd_k2jycal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbservice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reffile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_k2jycal.html#hsd_k2jycal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_k2jycal.hsd_k2jycal" title="Link to this definition"></a></dt>
<dd><p>hsd_k2jycal —- Derive Kelvin to Jy calibration tables</p>
<p>Derive the Kelvin to Jy calibration for list of MeasurementSets.</p>
<p>results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<p>dbservice     Whether or not accessing Jy/K DB to retrieve conversion factors.
endpoint      Which endpoints to use for query</p>
<blockquote>
<div><p>options: ‘asdm’, ‘model-fit’, ‘interpolation’</p>
</div></blockquote>
<dl>
<dt>reffile       Path to a file containing Jy/K factors for science data, which</dt><dd><p>must be provided by associating calibrator reduction or the observatory
measurements. Jy/K factor must take into account all efficiencies, i.e.,
it must be a direct conversion factor from Ta* to Jy. The file must be
in either MS-based or session-based format. The MS-based format must
be in an CSV format with five fields: MS name, antenna name, spectral
window id, polarization string, and Jy/K conversion factor. Example for
the file is as follows:</p>
<blockquote>
<div><p>MS,Antenna,Spwid,Polarization,Factor
uid___A002_X316307_X6f.ms,CM03,5,XX,10.0
uid___A002_X316307_X6f.ms,CM03,5,YY,12.0
uid___A002_X316307_X6f.ms,PM04,5,XX,2.0
uid___A002_X316307_X6f.ms,PM04,5,YY,5.0</p>
</div></blockquote>
<p>The first line in the above example is a header which may or may not
exist. Example for the session-based format is as follows:</p>
<blockquote>
<div><p>#OUSID=XXXXXX
#OBJECT=Uranus
#FLUXJY=yy,zz,aa
#FLUXFREQ=YY,ZZ,AA
#sessionID,ObservationStartDate(UTC),ObservationEndDate(UTC),
Antenna,BandCenter(MHz),BandWidth(MHz),POL,Factor
1,2011-11-11 01:00:00,2011-11-11 01:30:00,CM02,86243.0,500.0,I,10.0
1,2011-11-11 01:00:00,2011-11-11 01:30:00,CM02,86243.0,1000.0,I,30.0
1,2011-11-11 01:00:00,2011-11-11 01:30:00,CM03,86243.0,500.0,I,50.0
1,2011-11-11 01:00:00,2011-11-11 01:30:00,CM03,86243.0,1000.0,I,70.0
1,2011-11-11 01:00:00,2011-11-11 01:30:00,ANONYMOUS,86243.0,500.0,I,30.0
1,2011-11-11 01:00:00,2011-11-11 01:30:00,ANONYMOUS,86243.0,1000.0,I,50.0
2,2011-11-13 01:45:00,2011-11-13 02:15:00,PM04,86243.0,500.0,I,90.0
2,2011-11-13 01:45:00,2011-11-13 02:15:00,PM04,86243.0,1000.0,I,110.0
2,2011-11-13 01:45:00,2011-11-13 02:15:00,ANONYMOUS,86243.0,500.0,I,90.0
2,2011-11-13 01:45:00,2011-11-13 02:15:00,ANONYMOUS,86243.0,1000.0,I,110.0</p>
</div></blockquote>
<p>Lines starting with ‘#’ are meta data and header.
The header must exist. The factor to apply is identified by matching the
session ID, antenna name, frequency and polarization of data in each line of
the file. Note the observation date is supplementary information and not used
for the matching so far. The lines whose antenna name is ‘ANONYMOUS’ are used
when there is no measurement for specific antenna in the session. In the above
example, if science observation of session 1 contains the antenna PM04, Jy/K
factor for ANONYMOUS antenna will be applied since there is no measurement for
PM04 in session 1.
If no file name is specified or specified file doesn’t exist, all Jy/K factors
are set to 1.0.</p>
<p>example: reffile=’’, reffile=’working/jyperk.csv’</p>
</dd>
</dl>
<p>infiles       List of input MeasurementSets.</p>
<blockquote>
<div><p>example: vis=’ngc5921.ms’</p>
</div></blockquote>
<p>caltable      Name of output gain calibration tables.</p>
<blockquote>
<div><p>example: caltable=’ngc5921.gcal’</p>
</div></blockquote>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Compute the Kevin to Jy calibration tables for a list of MeasurementSets:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_k2jycal</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hsd.cli.hsd_restoredata">
<span id="pipeline-hsd-cli-hsd-restoredata-module"></span><h2>pipeline.hsd.cli.hsd_restoredata module<a class="headerlink" href="#module-pipeline.hsd.cli.hsd_restoredata" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_restoredata.hsd_restoredata">
<span class="sig-name descname"><span class="pre">hsd_restoredata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">products_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copytoraw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawdata_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bdfflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ocorr_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_rasterscan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_restoredata.html#hsd_restoredata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_restoredata.hsd_restoredata" title="Link to this definition"></a></dt>
<dd><p>hsd_restoredata —- Restore flagged and calibration single dish data from a pipeline run</p>
<p>The hsd_restoredata task restores flagged and calibrated MeasurementSets
from archived ASDMs and pipeline flagging and calibration data products.</p>
<p>hsd_restoredata assumes that the ASDMs to be restored are present in the
directory specified by the <code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code> (default: ‘../rawdata’).</p>
<p>By default (<code class="docutils literal notranslate"><span class="pre">copytoraw</span></code> = True), hsd_restoredata assumes that for each
ASDM in the input list, the corresponding pipeline flagging and calibration
data products (in the format produced by the hsd_exportdata task) are
present in the directory specified by <code class="docutils literal notranslate"><span class="pre">products_dir</span></code> (default: ‘../products’).
At the start of the task, these products are copied from the <code class="docutils literal notranslate"><span class="pre">products_dir</span></code>
to the <code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">copytoraw</span></code> = False, hsd_restoredata assumes that these products are
to be found in <code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code> along with the ASDMs.</p>
<p>The expected flagging and calibration products (for each ASDM) include:</p>
<blockquote>
<div><ul class="simple">
<li><p>a compressed tar file of the final flagversions file, e.g.
uid___A002_X30a93d_X43e.ms.flagversions.tar.gz</p></li>
<li><p>a text file containing the applycal instructions, e.g.
uid___A002_X30a93d_X43e.ms.calapply.txt</p></li>
<li><p>a compressed tar file containing the caltables for the parent session,
e.g. uid___A001_X74_X29.session_3.caltables.tar.gz</p></li>
</ul>
</div></blockquote>
<p>hsd_restoredata performs the following operations:</p>
<ul class="simple">
<li><p>imports the ASDM(s)</p></li>
<li><p>removes the default MS.flagversions directory created by the filler</p></li>
<li><p>restores the final MS.flagversions directory stored by the pipeline</p></li>
<li><p>restores the final set of pipeline flags to the MS</p></li>
<li><p>restores the final calibration state of the MS</p></li>
<li><p>restores the final calibration tables for each MS</p></li>
<li><p>applies the calibration tables to each MS</p></li>
</ul>
<p>When importing the ASDM and converting it to a Measurement Set (MS), if the
output MS already exists in the output directory, then the importasdm
conversion step is skipped, and the existing MS will be imported instead.</p>
<p>Output:</p>
<p>results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis           List of raw visibility data files to be restored. Assumed to be</dt><dd><p>in the directory specified by rawdata_dir.</p>
<p>example: vis=[‘uid___A002_X30a93d_X43e’]</p>
</dd>
</dl>
<p>session       List of sessions one per visibility file.</p>
<blockquote>
<div><p>example: session=[‘session_3’]</p>
</div></blockquote>
<dl>
<dt>products_dir  Name of the data products directory to copy calibration</dt><dd><p>products from.
Default: ‘../products’</p>
<p>The parameter is effective only when <code class="docutils literal notranslate"><span class="pre">copytoraw</span></code> = True.
When <code class="docutils literal notranslate"><span class="pre">copytoraw</span></code> = False, calibration products in
<code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code> will be used.</p>
<p>example: products_dir=’myproductspath’</p>
</dd>
<dt>copytoraw     Copy calibration and flagging tables from <code class="docutils literal notranslate"><span class="pre">products_dir</span></code> to</dt><dd><p><code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code> directory.
Default: True</p>
<p>example: copytoraw=False</p>
</dd>
<dt>rawdata_dir   Name of the raw data directory.</dt><dd><p>Default: ‘../rawdata’</p>
<p>example: rawdata_dir=’myrawdatapath’</p>
</dd>
<dt>lazy          Use the lazy filler option</dt><dd><p>Default: False</p>
<p>example: lazy=True</p>
</dd>
<dt>bdfflags      Set the BDF flags</dt><dd><p>Default: True</p>
<p>example: bdfflags=False</p>
</dd>
<dt>ocorr_mode    Set ocorr_mode</dt><dd><p>Default: ‘ao’</p>
<p>example: ocorr_mode=’ca’</p>
</dd>
<dt>asis          Creates verbatim copies of the ASDM tables in the output MS.</dt><dd><p>The value given to this option must be a list of table names separated by space characters.
Default: ‘SBSummary ExecBlock Annotation Antenna Station Receiver Source CalAtmosphere CalWVR’</p>
<p>example: asis=’Source Receiver’</p>
</dd>
<dt>hm_rasterscan Heuristics method for raster scan analysis. Two analysis modes,</dt><dd><p>time-domain analysis (‘time’) and direction analysis (‘direction’), are available.
Default: ‘time’</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Restore the pipeline results for a single ASDM in a single session</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_restoredata</span> <span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;uid___A002_X30a93d_X43e&#39;</span><span class="p">],</span> <span class="n">session</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;session_1&#39;</span><span class="p">],</span> <span class="n">ocorr_mode</span><span class="o">=</span><span class="s1">&#39;ao&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hsd.cli.hsd_skycal">
<span id="pipeline-hsd-cli-hsd-skycal-module"></span><h2>pipeline.hsd.cli.hsd_skycal module<a class="headerlink" href="#module-pipeline.hsd.cli.hsd_skycal" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_skycal.hsd_skycal">
<span class="sig-name descname"><span class="pre">hsd_skycal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elongated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_skycal.html#hsd_skycal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_skycal.hsd_skycal" title="Link to this definition"></a></dt>
<dd><p>hsd_skycal —- Calibrate data</p>
<p>The hsd_skycal generates a caltable for sky calibration that stores
reference spectra, which is to be subtracted from on-source spectra to filter
out non-source contribution.</p>
<p>Output:</p>
<p>results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>calmode       Calibration mode. Available options are ‘auto’ (default),</dt><dd><p>‘ps’, ‘otf’, and ‘otfraster’. When ‘auto’ is set, the task will
use preset calibration mode that is determined by inspecting data.
‘ps’ mode is simple position switching using explicit reference
scans. Other two modes, ‘otf’ and ‘otfraster’, will generate
reference data from scans at the edge of the map. Those modes
are intended for OTF observation and the former is defined for
generic scanning pattern such as Lissajous, while the latter is
specific use for raster scan.</p>
<p>options: ‘auto’, ‘ps’, ‘otf’, ‘otfraster’</p>
</dd>
<dt>fraction      Sub-parameter for calmode. Edge marking parameter for</dt><dd><p>‘otf’ and ‘otfraster’ mode. It specifies a number of OFF scans
as a fraction of total number of data points.</p>
<p>options: String style like ‘20%’, or float value less than 1.0.
For ‘otfraster’ mode, you can also specify ‘auto’.</p>
</dd>
<dt>noff          Sub-parameter for calmode. Edge marking parameter for ‘otfraster’</dt><dd><p>mode. It is used to specify a number of OFF scans near edge directly
instead to specify it by fractional number by ‘fraction’. If it is
set, the value will come before setting by ‘fraction’.</p>
<p>options: any positive integer value</p>
</dd>
<dt>width         Sub-parameter for calmode. Edge marking parameter for ‘otf’</dt><dd><p>mode. It specifies pixel width with respect to a median spatial
separation between neighboring two data in time. Default will
be fine in most cases.</p>
<p>options: any float value</p>
</dd>
<dt>elongated     Sub-parameter for calmode. Edge marking parameter for</dt><dd><p>‘otf’ mode. Please set True only if observed area is elongated
in one direction.</p>
</dd>
<dt>parallel      Execute using CASA HPC functionality, if available.</dt><dd><p>options: ‘automatic’, ‘true’, ‘false’, True, False
default: None (equivalent to ‘automatic’)</p>
</dd>
<dt>infiles       List of data files. These must be a name of MeasurementSets that</dt><dd><p>are registered to context via hsd_importdata task.</p>
<p>example: vis=[‘X227.ms’, ‘X228.ms’]</p>
</dd>
</dl>
<p>field         Data selection by field name.
spw           Data selection by spw. (defalut all spws)</p>
<blockquote>
<div><dl class="simple">
<dt>example: ‘3,4’ (generate caltable for spw 3 and 4)</dt><dd><p>[‘0’,’2’] (spw 0 for first data, 2 for second)</p>
</dd>
</dl>
</div></blockquote>
<p>scan          Data selection by scan number. (default all scans)</p>
<blockquote>
<div><dl class="simple">
<dt>example: ‘22,23’ (use scan 22 and 23 for calibration)</dt><dd><p>[‘22’,’24’] (scan 22 for first data, 24 for second)</p>
</dd>
</dl>
</div></blockquote>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Generate caltables for all data managed by context.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">default</span><span class="p">(</span><span class="n">hsd_skycal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_skycal</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hsd.cli.hsd_tsysflag">
<span id="pipeline-hsd-cli-hsd-tsysflag-module"></span><h2>pipeline.hsd.cli.hsd_tsysflag module<a class="headerlink" href="#module-pipeline.hsd.cli.hsd_tsysflag" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_tsysflag.hsd_tsysflag">
<span class="sig-name descname"><span class="pre">hsd_tsysflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_nmedian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnm_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnm_byfield</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_derivative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fd_max_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_edgechans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fe_edge_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_fieldshape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff_refintent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff_max_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_birdies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fb_sharps_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_toomany</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmf1_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmef1_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_tsys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetemplate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_tsysflag.html#hsd_tsysflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_tsysflag.hsd_tsysflag" title="Link to this definition"></a></dt>
<dd><p>hsd_tsysflag —- Flag deviant system temperature measurements</p>
<p>Flag deviant system temperature measurements for single dish measurements. This is done by running a
sequence of flagging sub-tasks (tests), each looking for a different type of possible error.</p>
<p>If a file with manual Tsys flags is provided with the ‘filetemplate’
parameter, then these flags are applied prior to the evaluation of the
flagging heuristics listed below.</p>
<p>The tests are:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Flag Tsys spectra with high median values</p></li>
<li><p>Flag Tsys spectra with high median derivatives. This is meant to spot</p></li>
</ol>
<blockquote>
<div><p>spectra that are ‘ringing’.</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Flag the edge channels of the Tsys spectra in each SpW.</p></li>
<li><p>Flag Tsys spectra whose shape is different from that associated with</p></li>
</ol>
<blockquote>
<div><p>the BANDPASS intent.</p>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Flag ‘birdies’.</p></li>
<li><p>Flag the Tsys spectra of all antennas in a timestamp and spw if</p></li>
</ol>
<blockquote>
<div><p>proportion of antennas already flagged in this timestamp and spw exceeds
a threshold, and flag Tsys spectra for all antennas and all timestamps
in a spw, if proportion of antennas that are already entirely flagged
in all timestamps exceeds a threshold.</p>
</div></blockquote>
</div></blockquote>
<p>Output</p>
<p>results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<p>vis             List of input MeasurementSets (Not used)
caltable        List of input Tsys calibration tables.</p>
<blockquote>
<div><p>default: [] - Use the table currently stored in the pipeline context.
example: caltable=[‘X132.ms.tsys.s2.tbl’]</p>
</div></blockquote>
<p>flag_nmedian    True to flag Tsys spectra with high median value.
fnm_limit       Flag spectra with median value higher than fnm_limit * median</p>
<blockquote>
<div><p>of this measure over all spectra.</p>
</div></blockquote>
<p>fnm_byfield     Evaluate the nmedian metric separately for each field.
flag_derivative True to flag Tsys spectra with high median derivative.
fd_max_limit    Flag spectra with median derivative higher than</p>
<blockquote>
<div><p>fd_max_limit * median of this measure over all spectra.</p>
</div></blockquote>
<p>flag_edgechans  True to flag edges of Tsys spectra.
fe_edge_limit   Flag channels whose channel to channel difference &gt;</p>
<blockquote>
<div><p>fe_edge_limit * median across spectrum.</p>
</div></blockquote>
<dl class="simple">
<dt>flag_fieldshape True to flag Tsys spectra with a radically different</dt><dd><p>shape to those of the ff_refintent.</p>
</dd>
</dl>
<p>ff_refintent    Data intent that provides the reference shape for ‘flag_fieldshape’.
ff_max_limit    Flag Tsys spectra with ‘fieldshape’ metric values &gt;</p>
<blockquote>
<div><p>ff_max_limit.</p>
</div></blockquote>
<p>flag_birdies    True to flag channels covering sharp spectral features.
fb_sharps_limit Flag channels bracketing a channel to channel</p>
<blockquote>
<div><p>difference &gt; fb_sharps_limit.</p>
</div></blockquote>
<dl class="simple">
<dt>flag_toomany    True to flag Tsys spectra for which a proportion of</dt><dd><p>antennas for given timestamp and/or proportion of antennas that are
entirely flagged in all timestamps exceeds their respective thresholds.</p>
</dd>
<dt>tmf1_limit      Flag Tsys spectra for all antennas in a timestamp and spw if</dt><dd><p>proportion of antennas already flagged in this timestamp and spw exceeds
tmf1_limit.</p>
</dd>
<dt>tmef1_limit     Flag Tsys spectra for all antennas and all timestamps</dt><dd><p>in a spw, if proportion of antennas that are already entirely flagged
in all timestamps exceeds tmef1_limit.</p>
</dd>
<dt>metric_order    Order in which to evaluate the flagging metrics that are</dt><dd><p>enabled. Disabled metrics are skipped.</p>
</dd>
<dt>normalize_tsys  True to create a normalized Tsys table that is used to</dt><dd><p>evaluate the Tsys flagging metrics. All newly found flags are also applied
to the original Tsys caltable that continues to be used for subsequent
calibration.</p>
</dd>
<dt>filetemplate    The name of a text file that contains the manual Tsys flagging</dt><dd><p>template. If the template flags file is undefined, a name of the form
‘msname.flagtsystemplate.txt’ is assumed.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Flag Tsys measurements using currently recommended tests:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_tsysflag</span><span class="p">()</span>
</pre></div>
</div>
<p>2. Flag Tsys measurements using all recommended tests apart from that
using the ‘fieldshape’ metric:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_tsysflag</span><span class="p">(</span><span class="n">flag_fieldshape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pipeline.hsd.cli">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pipeline.hsd.cli" title="Link to this heading"></a></h2>
<p>ALMA Single Dish Tasks</p>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_applycal">
<span class="sig-name descname"><span class="pre">hsd_applycal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">applymode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calwt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flagbackup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_applycal.html#hsd_applycal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_applycal" title="Link to this definition"></a></dt>
<dd><p>hsd_applycal —- Apply the calibration(s) to the data</p>
<p>Apply the calibration to the data.</p>
<p>hsd_applycal applies the precomputed calibration tables stored in the pipeline
context to the set of visibility files using predetermined field and
spectral window maps and default values for the interpolation schemes.</p>
<p>Users can interact with the pipeline calibration state using the tasks
h_export_calstate and h_import_calstate.</p>
<p>Output:</p>
<p>results – The results object for the pipeline task is returned</p>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis           The list of input MeasurementSets. Defaults to the list of MeasurementSets</dt><dd><p>in the pipeline context.
example: [‘X227.ms’]</p>
</dd>
<dt>field         A string containing the list of field names or field ids to which</dt><dd><p>the calibration will be applied. Defaults to all fields in the pipeline context.
example: ‘3C279’, ‘3C279, M82’</p>
</dd>
<dt>intent        A string containing the list of intents against which the</dt><dd><p>selected fields will be matched. Defaults to all supported intents
in the pipeline context.
example: <cite>‘*TARGET*’</cite></p>
</dd>
<dt>spw           The list of spectral windows and channels to which the calibration</dt><dd><p>will be applied. Defaults to all science windows in the pipeline context.
example: ‘17’, ‘11, 15’</p>
</dd>
<dt>antenna       The selection of antennas to which the calibration will be applied.</dt><dd><p>Defaults to all antennas. Not currently supported.</p>
</dd>
<dt>applymode       Calibration apply mode</dt><dd><p>‘calflag’: calibrate data and apply flags from solutions
‘calflagstrict’: same as above except flag spws for which calibration is</p>
<blockquote>
<div><p>unavailable in one or more tables (instead of allowing them to pass
uncalibrated and unflagged)</p>
</div></blockquote>
<p>‘trial’: report on flags from solutions, dataset entirely unchanged
‘flagonly’: apply flags from solutions only, data not calibrated
‘flagonlystrict’: same as above except flag spws for which calibration is</p>
<blockquote>
<div><p>unavailable in one or more tables</p>
</div></blockquote>
<p>‘calonly’: calibrate data only, flags from solutions NOT applied</p>
</dd>
</dl>
<p>calwt         Calibrate the weights as well as the data.
flagbackup    Backup the flags before the apply.
parallel      Execute using CASA HPC functionality, if available.</p>
<blockquote>
<div><p>options: ‘automatic’, ‘true’, ‘false’, True, False
default: None (equivalent to ‘automatic’)</p>
</div></blockquote>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Apply the calibration to the target data</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_applycal</span> <span class="p">(</span><span class="n">intent</span><span class="o">=</span><span class="s1">&#39;TARGET&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Specify fields and spectral windows</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_applycal</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">&#39;3C279, M82&#39;</span><span class="p">,</span> <span class="n">spw</span><span class="o">=</span><span class="s1">&#39;17&#39;</span><span class="p">,</span> <span class="n">intent</span><span class="o">=</span><span class="s1">&#39;TARGET&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>——— issues ———————————————————–</p>
<p>There is some discussion about the appropriate values of calwt. Given
properly scaled data, the correct value should be the CASA default of True.
However at the current time ALMA is suggesting that calwt be set to True for
applying observatory calibrations, e.g. antenna positions, WVR, and system
temperature corrections, and to False for applying instrument calibrations,
e.g. bandpass, gain, and flux.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_atmcor">
<span class="sig-name descname"><span class="pre">hsd_atmcor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atmtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtem_dh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_atmcor.html#hsd_atmcor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_atmcor" title="Link to this definition"></a></dt>
<dd><p>hsd_atmcor —- Apply offline ATM correction to the data.</p>
<p>The hsd_atmcor task provides the capability of offline correction of
residual atmospheric features in the calibrated single-dish spectra
originated from incomplete calibration mainly due to a difference of
elevation angles between ON_SOURCE and OFF_SOURCE measurements.</p>
<p>Optimal atmospheric model is automatically determined by default
(atmtype = ‘auto’). You may specify desired atmospheric model by giving
either single integer (apply to all EBs) or a list of integers (models
per EB) to atmtype parameter. Please see parameter description for the
meanings of integer values.</p>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>atmtype       Type of atmospheric transmission model represented as an integer.</dt><dd><p>Available options are as follows. Integer values can be given as
either integer or string, i.e. both 1 and ‘1’ are acceptable.</p>
<blockquote>
<div><dl class="simple">
<dt>‘auto’: perform heuristics to choose best model (default)</dt><dd><p>1: tropical
2: mid latitude summer
3: mid latitude winter
4: subarctic summer
5: subarctic winter</p>
</dd>
</dl>
</div></blockquote>
<p>If list of integer is given, it also performs heuristics using the
provided values instead of default, [1, 2, 3, 4], which is used
when ‘auto’ is provided. List input should not contain ‘auto’.</p>
<p>Default: ‘auto’</p>
</dd>
</dl>
<p>dtem_dh       Temperature gradient [K/km], e.g. -5.6. (”” = Tool default)</p>
<blockquote>
<div><p>The value is directly passed to initialization method for ATM model.
Float and string types are acceptable. Float value is interpreted as
the value in K/km. String value should be the numeric value with unit
such as ‘-5.6K/km’. When list of values are given, it will
trigger heuristics to choose best model from the provided value.</p>
<p>Default: ‘’ (tool default, -5.6K/km, is used)</p>
</div></blockquote>
<p>h0            Scale height for water [km], e.g. 2.0. (”” = Tool default)</p>
<blockquote>
<div><p>The value is directly passed to initialization method for ATM model.
Float and string types are acceptable. Float value is interpreted as
the value in kilometer. String value should be the numeric value with
unit compatible with length, such as ‘2km’ or ‘2000m’.
When list of values are given, it will trigger heuristics to
choose best model from the provided value.</p>
<p>Default: ‘’ (tool default, 2.0km, is used)</p>
</div></blockquote>
<dl class="simple">
<dt>infiles       ASDM or MS files to be processed. This parameter behaves</dt><dd><p>as data selection parameter. The name specified by
infiles must be registered to context before you run
hsd_atmcor.</p>
</dd>
<dt>antenna       Data selection by antenna names or ids.</dt><dd><dl class="simple">
<dt>example: ‘PM03,PM04’</dt><dd><p>‘’ (all antennas)</p>
</dd>
</dl>
</dd>
<dt>field         Data selection by field names or ids.</dt><dd><dl class="simple">
<dt>example: ‘<cite>*Sgr*,M100</cite>’</dt><dd><p>‘’ (all fields)</p>
</dd>
</dl>
</dd>
<dt>spw           Data selection by spw ids.</dt><dd><dl class="simple">
<dt>example: ‘3,4’ (spw 3 and 4)</dt><dd><p>‘’ (all spws)</p>
</dd>
</dl>
</dd>
<dt>pol           Data selection by polarizations.</dt><dd><dl class="simple">
<dt>example: ‘XX,YY’ (correlation XX and YY)</dt><dd><p>‘’ (all polarizations)</p>
</dd>
</dl>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Basic usage</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_atmcor</span><span class="p">()</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Specify atmospheric model and data selection</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_atmcor</span><span class="p">(</span><span class="n">atmtype</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">antenna</span><span class="o">=</span><span class="s1">&#39;PM03,PM04&#39;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;*Sgr*,M100&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Specify atmospheric model per EB (atmtype 1 for 1st EB, 2 for 2nd EB)</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_atmcor</span><span class="p">(</span><span class="n">atmtype</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_baseline">
<span class="sig-name descname"><span class="pre">hsd_baseline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitfunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">switchpoly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewindow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewindowmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">broadline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clusteringalgorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deviationmask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_baseline.html#hsd_baseline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_baseline" title="Link to this definition"></a></dt>
<dd><p>hsd_baseline —- Detect and validate spectral lines, subtract baseline by masking detected lines</p>
<p>The hsd_baseline task subtracts baseline from calibrated spectra.
By default, the task tries to find spectral line feature using
line detection and validation algorithms. Then, the task puts a
mask on detected lines and perform baseline subtraction.
The user is able to turn off automatic line masking by setting
linewindow parameter, which specifies pre-defined line window.</p>
<p>Fitting order is automatically determined by default. It can be
disabled by specifying fitorder as non-negative value. In this
case, the value specified by fitorder will be used.</p>
<p><strong>*WARNING*</strong>
Currently, hsd_baseline overwrites the result obtained by the
previous run. Due to this behavior, users need to be careful
about an order of the task execution when they run hsd_baseline
multiple times with different data selection. Suppose there are
two spectral windows (0 and 1) and hsd_baseline is executed
separately for each spw as below,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_baseline</span><span class="p">(</span><span class="n">spw</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_baseline</span><span class="p">(</span><span class="n">spw</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_blflag</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_imaging</span><span class="p">()</span>
</pre></div>
</div>
<p>Since the second run of hsd_baseline overwrites the result for
spw 0 with the data before baseline subtraction, this will not
produce correct result for spw 0. Proper sequence for this use
case is to process each spw to the imaging stage separately,
which looks like as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_baseline</span><span class="p">(</span><span class="n">spw</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_blflag</span><span class="p">(</span><span class="n">spw</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_imaging</span><span class="p">(</span><span class="n">spw</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_baseline</span><span class="p">(</span><span class="n">spw</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_blflag</span><span class="p">(</span><span class="n">spw</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_imaging</span><span class="p">(</span><span class="n">spw</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:
results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>fitfunc             Fitting function for baseline subtraction. You can choose</dt><dd><p>either cubic spline (‘spline’ or ‘cspline’) or polynomial
(‘poly’ or ‘polynomial’). Default is ‘cspline’.</p>
</dd>
<dt>fitorder            Fitting order for polynomial. For cubic spline, it is used</dt><dd><p>to determine how much the spectrum is segmented into.
Default (-1) is to determine the order automatically.</p>
</dd>
<dt>switchpoly          Whether to fall back the fits from cubic spline to 1st or</dt><dd><p>2nd order polynomial when large masks exist at the edges
of the spw. Condition for switching is as follows:</p>
<blockquote>
<div><p>if nmask &gt; nchan/2      =&gt; 1st order polynomial
else if nmask &gt; nchan/4 =&gt; 2nd order polynomial
else                    =&gt; use fitfunc and fitorder</p>
</div></blockquote>
<p>where nmask is a number of channels for mask at edge while
nchan is a number of channels of entire spectral window.</p>
</dd>
<dt>linewindow          Pre-defined line window. If this is set, specified line</dt><dd><p>windows are used as a line mask for baseline subtraction
instead to determine masks based on line detection and
validation stage. Several types of format are acceptable.
One is channel-based window,</p>
<blockquote>
<div><p>[min_chan, max_chan]</p>
</div></blockquote>
<p>where min_chan and max_chan should be an integer. For
multiple  windows, nested list is also acceptable,</p>
<blockquote>
<div><p>[[min_chan0, max_chan0], [min_chan1, max_chan1], …]</p>
</div></blockquote>
<dl class="simple">
<dt>Another way is frequency-based window,</dt><dd><p>[min_freq, max_freq]</p>
</dd>
</dl>
<p>where min_freq and max_freq should be either a float or
a string. If float value is given, it is interpreted as
a frequency in Hz. String should be a quantity consisting
of “value” and “unit”,
e.g., ‘100GHz’. Multiple windows are also supported.</p>
<blockquote>
<div><p>[[min_freq0, max_freq0], [min_freq1, max_freq1], …]</p>
</div></blockquote>
<p>Note that the specified frequencies are assumed to be
the value in LSRK frame. Note also that there is a
limitation when multiple MSes are processed.
If native frequency frame of the data is not LSRK
(e.g. TOPO), frequencies need to be converted to that
frame. As a result, corresponding channel range may vary
between MSes. However, current implementation is not
able to handle such case. Frequencies are converted to
desired frame using representative MS (time, position,
direction).</p>
<p>In the above cases, specified line windows are applied
to all science spws. In case when line windows vary with
spw, line windows can be specified by a dictionary whose
key is spw id while value is line window.
For example, the following dictionary gives different
line windows to spws 17 and 19. Other spws, if available,
will have an empty line window.</p>
<blockquote>
<div><p>{17: [[100, 200], [1200, 1400]], 19: [‘112115MHz’, ‘112116MHz’]}</p>
</div></blockquote>
<p>Furthermore, linewindow accepts MS selection string.
The following string gives [[100,200],[1200,1400]] for
spw 17 while [1000,1500] for spw 21.</p>
<blockquote>
<div><p>“17:100~200;1200~1400,21:1000~1500”</p>
</div></blockquote>
<p>The string also accepts frequency with units. Note,
however, that frequency reference frame in this case is
not fixed to LSRK. Instead, the frame will be taken from
the MS (typically TOPO for ALMA).
Thus, the following two frequency-based line windows
result different channel selections.</p>
<blockquote>
<div><p>{19: [‘112115MHz’, ‘112116MHz’]} # frequency frame is LSRK
“19:11215MHz~11216MHz” # frequency frame is taken from the data</p>
<blockquote>
<div><p># (TOPO for ALMA)</p>
</div></blockquote>
</div></blockquote>
<p>None is allowed as a value of dictionary input to indicate that
no line detection/validation is required even if manually specified
line window does not exist. When None is given as a value and if
<code class="docutils literal notranslate"><span class="pre">linewindowmode</span></code> is ‘replace’, line detection/validation is not performed
for the corresponding spw. For example, suppose the following parameters
are given for the data with four science spws, 17, 19, 21, and 23.</p>
<blockquote>
<div><p>linewindow={17: [112.1e9, 112.2e9], 19: [113.1e9, 113.15e9], 21: None}
linewindowmode=’replace’</p>
</div></blockquote>
<p>The task will use given line window for 17 and 19 while the task performs
line deteciton/validation for spw 23 because no line window is set.
On the other hand, line detection/validation is skipped for spw 21 due to
the effect of None.</p>
<dl class="simple">
<dt>example: [100,200] (channel), [115e9, 115.1e9] (frequency in Hz)</dt><dd><p>[‘115GHz’, ‘115.1GHz’], see above for more examples</p>
</dd>
</dl>
</dd>
<dt>linewindowmode      Merge or replace given manual line window with line</dt><dd><p>detection/validation result. If ‘replace’ is given, line
detection and validation will not be performed.
On the other hand, when ‘merge’ is specified, line
detection/validation will be performed and manually
specified line windows are added to the result.</p>
<p>Note that this has no effect when linewindow for target
spw is an empty list. In that case, line detection/validation
will be performed regardless of the value of linewindowmode.
In case if no linewindow nor line detection/validation
are necessary, you should set linewindowmode to ‘replace’
and specify None as a value of the linewindow dictionary
for the spw to apply. See parameter description of <code class="docutils literal notranslate"><span class="pre">linewindow</span></code>
for detail.</p>
</dd>
<dt>edge                Number of edge channels to be dropped from baseline</dt><dd><p>subtraction. The value must be a list with length of 2,
whose values specify left and right edge channels,
respectively.</p>
<p>example: [10,10]</p>
</dd>
</dl>
<p>broadline           Try to detect broad component of spectral line if True.</p>
<dl>
<dt>clusteringalgorithm Selection of the algorithm used in the clustering</dt><dd><blockquote>
<div><p>analysis to check the validity of detected line features.</p>
</div></blockquote>
<p>‘kmean’ algorithm and hierarchical clustering algorithm
‘hierarchy’, and their combination (‘both’) are so far
implemented.</p>
</dd>
<dt>deviationmask       Apply deviation mask in addition to masks determined by</dt><dd><p>the automatic line detection.</p>
</dd>
<dt>parallel            Execute using CASA HPC functionality, if available.</dt><dd><p>options: ‘automatic’, ‘true’, ‘false’, True, False
default: None (equivalent to ‘automatic’)</p>
</dd>
<dt>infiles             List of data files. These must be a name of</dt><dd><p>MeasurementSets that are registered to context via
hsd_importdata task.</p>
<p>example: vis=[‘X227.ms’, ‘X228.ms’]</p>
</dd>
<dt>field               Data selection by field.</dt><dd><dl class="simple">
<dt>example: ‘1’ (select by FIELD_ID)</dt><dd><p>‘M100*’ (select by field name)
‘’ (all fields)</p>
</dd>
</dl>
</dd>
<dt>antenna             Data selection by antenna.</dt><dd><dl class="simple">
<dt>example: ‘1’ (select by ANTENNA_ID)</dt><dd><p>‘PM03’ (select by antenna name)
‘’ (all antennas)</p>
</dd>
</dl>
</dd>
<dt>spw                 Data selection by spw.</dt><dd><dl class="simple">
<dt>example: ‘3,4’ (generate caltable for spw 3 and 4)</dt><dd><p>[‘0’,’2’] (spw 0 for first data, 2 for second)
‘’ (all spws)</p>
</dd>
</dl>
</dd>
<dt>pol                 Data selection by polarizations.</dt><dd><dl class="simple">
<dt>example: ‘0’ (generate caltable for pol 0)</dt><dd><p>[‘0~1’,’0’] (pol 0 and 1 for first data, only 0 for second)
‘’ (all polarizations)</p>
</dd>
</dl>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Basic usage with automatic line detection and validation</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_baseline</span><span class="p">(</span><span class="n">antenna</span><span class="o">=</span><span class="s1">&#39;PM03&#39;</span><span class="p">,</span> <span class="n">spw</span><span class="o">=</span><span class="s1">&#39;17,19&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Using pre-defined line windows without automatic line detection
and edge channels</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_baseline</span><span class="p">(</span><span class="n">linewindow</span><span class="o">=</span><span class="p">[[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="p">[</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">1400</span><span class="p">]],</span>
<span class="go">                 linewindowmode=&#39;replace&#39;, edge=[10, 10])</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Using per spw pre-defined line windows with automatic line detection</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_baseline</span><span class="p">(</span><span class="n">linewindow</span><span class="o">=</span><span class="p">{</span><span class="mi">19</span><span class="p">:</span> <span class="p">[[</span><span class="mi">390</span><span class="p">,</span> <span class="mi">550</span><span class="p">]],</span> <span class="mi">23</span><span class="p">:</span> <span class="p">[[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="p">[</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">1400</span><span class="p">]]},</span>
<span class="go">                 linewindowmode=&#39;merge&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_blflag">
<span class="sig-name descname"><span class="pre">hsd_blflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_tsys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tsys_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_prfre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prfre_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_pofre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pofre_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_prfr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prfr_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_pofr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pofr_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_prfrm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prfrm_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prfrm_nmean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_pofrm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pofrm_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pofrm_nmean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_blflag.html#hsd_blflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_blflag" title="Link to this definition"></a></dt>
<dd><p>hsd_blflag —- Flag spectra based on predefined criteria of single dish pipeline</p>
<p>Data are flagged based on several flagging rules. Available rules are:
expected rms, calculated rms, and running mean of both pre-fit and
post-fit spectra. Tsys flagging is also available.</p>
<p>In addition, the heuristics script creates many plots for each stage.
Those plots are included in the weblog.</p>
<p>Output:</p>
<p>results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>iteration     Number of iterations to perform sigma clipping to</dt><dd><p>calculate threshold value of flagging.</p>
</dd>
<dt>edge          Number of channels to be dropped from the edge.</dt><dd><dl class="simple">
<dt>The value must be a list of integer with length of one or</dt><dd><p>two. If list length is one, same number will be applied</p>
</dd>
</dl>
<p>both side of the band.</p>
<p>example: [10,20], [10]</p>
</dd>
</dl>
<p>flag_tsys     Activate (True) or deactivate (False) Tsys flag.
tsys_thresh   Threshold value for Tsys flag.
flag_prfre    Activate (True) or deactivate (False) flag by expected</p>
<blockquote>
<div><p>rms of pre-fit spectra.</p>
</div></blockquote>
<dl class="simple">
<dt>prfre_thresh  Threshold value for flag by expected rms of pre-fit</dt><dd><p>spectra.</p>
</dd>
<dt>flag_pofre    Activate (True) or deactivate (False) flag by expected</dt><dd><p>rms of post-fit spectra.</p>
</dd>
<dt>pofre_thresh  Threshold value for flag by expected rms of post-fit</dt><dd><p>spectra.</p>
</dd>
<dt>flag_prfr     Activate (True) or deactivate (False) flag by rms of</dt><dd><p>pre-fit spectra.</p>
</dd>
</dl>
<p>prfr_thresh   Threshold value for flag by rms of pre-fit spectra.
flag_pofr     Activate (True) or deactivate (False) flag by rms of</p>
<blockquote>
<div><p>post-fit spectra.</p>
</div></blockquote>
<p>pofr_thresh   Threshold value for flag by rms of post-fit spectra.
flag_prfrm    Activate (True) or deactivate (False) flag by running</p>
<blockquote>
<div><p>mean of pre-fit spectra.</p>
</div></blockquote>
<dl class="simple">
<dt>prfrm_thresh  Threshold value for flag by running mean of pre-fit</dt><dd><p>spectra.</p>
</dd>
</dl>
<p>prfrm_nmean   Number of channels for running mean of pre-fit spectra.
flag_pofrm    Activate (True) or deactivate (False) flag by running</p>
<blockquote>
<div><p>mean of post-fit spectra.</p>
</div></blockquote>
<dl class="simple">
<dt>pofrm_thresh  Threshold value for flag by running mean of post-fit</dt><dd><p>spectra.</p>
</dd>
</dl>
<p>pofrm_nmean   Number of channels for running mean of post-fit spectra.
plotflag      True to plot result of data flagging.
parallel      Execute using CASA HPC functionality, if available.</p>
<blockquote>
<div><p>options: ‘automatic’, ‘true’, ‘false’, True, False
default: None (equivalent to ‘automatic’)</p>
</div></blockquote>
<dl class="simple">
<dt>infiles       ASDM or MS files to be processed. This parameter behaves</dt><dd><p>as data selection parameter. The name specified by
infiles must be registered to context before you run
hsd_blflag.</p>
</dd>
<dt>antenna       Data selection by antenna names or ids.</dt><dd><dl class="simple">
<dt>example: ‘PM03,PM04’</dt><dd><p>‘’ (all antennas)</p>
</dd>
</dl>
</dd>
<dt>field         Data selection by field names or ids.</dt><dd><dl class="simple">
<dt>example: ‘<cite>*Sgr*,M100</cite>’</dt><dd><p>‘’ (all fields)</p>
</dd>
</dl>
</dd>
<dt>spw           Data selection by spw ids.</dt><dd><dl class="simple">
<dt>example: ‘3,4’ (spw 3 and 4)</dt><dd><p>‘’ (all spws)</p>
</dd>
</dl>
</dd>
<dt>pol           Data selection by polarizations.</dt><dd><dl class="simple">
<dt>example: ‘XX,YY’ (correlation XX and YY)</dt><dd><p>‘’ (all polarizations)</p>
</dd>
</dl>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>flagging with all rules</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_blflag</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_exportdata">
<span class="sig-name descname"><span class="pre">hsd_exportdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pprfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetimages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">products_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_exportdata.html#hsd_exportdata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_exportdata" title="Link to this definition"></a></dt>
<dd><p>hsd_exportdata —- Prepare single dish data for export</p>
<p>The hsd_exportdata task exports the data defined in the pipeline context
and exports it to the data products directory, converting and or packing
it as necessary.</p>
<p>The current version of the task exports the following products</p>
<ul class="simple">
<li><p>a FITS image for each selected science target source image</p></li>
<li><p>a tar file per ASDM containing the final flags version and blparam</p></li>
<li><p>a tar file containing the file web log</p></li>
</ul>
<p>Output:</p>
<p>results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<dl class="simple">
<dt>pprfile       Name of the pipeline processing request to be exported. Defaults</dt><dd><p>to a file matching the template ‘PPR_*.xml’.
example: pprfile=[‘PPR_GRB021004.xml’]</p>
</dd>
<dt>targetimages  List of science target images to be exported. Defaults to all</dt><dd><p>science target images recorded in the pipeline context.
example: targetimages=[‘r_aqr.CM02.spw5.line0.XXYY.sd.im’, ‘r_aqr.CM02.spw5.XXYY.sd.cont.im’]</p>
</dd>
<dt>products_dir  Name of the data products subdirectory. Defaults to ‘./’</dt><dd><p>example: products_dir=’../products’</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<p>1. Export the pipeline results for a single session to the data products
directory</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; !mkdir ../products
&gt;&gt;&gt; hsd_exportdata (products_dir=&#39;../products&#39;)
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_flagdata">
<span class="sig-name descname"><span class="pre">hsd_flagdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autocorr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shadow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scannumber</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgespw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracspw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fracspwfps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">online</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fileonline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetemplate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepointing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incompleteraster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_tbuff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tbuff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qa2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flagbackup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_flagdata.html#hsd_flagdata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_flagdata" title="Link to this definition"></a></dt>
<dd><p>hsd_flagdata —- Do basic flagging of a list of MeasurementSets</p>
<p>The hsd_flagdata data performs basic flagging operations on a list of
MeasurementSets including:</p>
<ul class="simple">
<li><p>applying online flags</p></li>
<li><p>applying a flagging template</p></li>
<li><p>shadowed antenna data flagging</p></li>
<li><p>scan-based flagging by intent or scan number</p></li>
<li><p>edge channel flagging</p></li>
</ul>
<p>Output:</p>
<p>results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<dl class="simple">
<dt>vis              The list of input MeasurementSets. Defaults to the list of MeasurementSets</dt><dd><p>defined in the pipeline context.</p>
</dd>
</dl>
<p>autocorr         Flag autocorrelation data.
shadow           Flag shadowed antennas.
scan             Flag a list of scans and intents specified by scannumber and intents.
scannumber       A string containing a comma delimited list of scans to be</p>
<blockquote>
<div><p>flagged.</p>
</div></blockquote>
<dl>
<dt>intents          A string containing a comma delimited list of intents against</dt><dd><p>which the scans to be flagged are matched.</p>
<p>example: <cite>‘*BANDPASS*’</cite></p>
</dd>
</dl>
<p>edgespw          Flag the edge spectral window channels.
fracspw          Fraction of the baseline correlator TDM edge channels to be flagged.
fracspwfps       Fraction of the ACS correlator TDM edge channels to be flagged.
online           Apply the online flags.
fileonline       File containing the online flags. These are computed by the</p>
<blockquote>
<div><p>h_init or hif_importdata data tasks. If the online flags files
are undefined a name of the form ‘msname.flagonline.txt’ is assumed.</p>
</div></blockquote>
<p>template         Apply a flagging template.
filetemplate     The name of a text file that contains the flagging template</p>
<blockquote>
<div><p>for RFI, birdies, telluric lines, etc.  If the template flags files
is undefined a name of the form ‘msname.flagtemplate.txt’ is assumed.</p>
</div></blockquote>
<p>pointing         Apply a flagging template for pointing flag.
filepointing     The name of a text file that contains the flagging template</p>
<blockquote>
<div><p>for pointing flag. If the template flags files is undefined a name of
the form ‘msname.flagpointing.txt’ is assumed.</p>
</div></blockquote>
<dl class="simple">
<dt>incompleteraster Apply commands to flag incomplete raster sequence.</dt><dd><p>If this is False, relevant commands in filepointing are
simply commented out.</p>
</dd>
<dt>hm_tbuff         The heuristic for computing the default time interval padding parameter.</dt><dd><p>The options are ‘halfint’ and ‘manual’. In ‘halfint’ mode tbuff is set to
half the maximum of the median integration time of the science and calibrator target
observations.</p>
</dd>
<dt>tbuff            The time in seconds used to pad flagging command time intervals if</dt><dd><p>hm_tbuff=’manual’.</p>
</dd>
</dl>
<p>qa0              QA0 flags
qa2              QA2 flags
parallel         Execute using CASA HPC functionality, if available.</p>
<blockquote>
<div><p>options: ‘automatic’, ‘true’, ‘false’, True, False
default: None (equivalent to ‘automatic’)</p>
</div></blockquote>
<p>flagbackup       Back up any pre-existing flags before applying new ones.</p>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Do basic flagging on a MeasurementSet</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_flagdata</span><span class="p">()</span>
</pre></div>
</div>
<p>2. Do basic flagging on a MeasurementSet flagging additional scans selected
by number as well.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_flagdata</span><span class="p">(</span><span class="n">scannumber</span><span class="o">=</span><span class="s1">&#39;13,18&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_imaging">
<span class="sig-name descname"><span class="pre">hsd_imaging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restfreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_imaging.html#hsd_imaging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_imaging" title="Link to this definition"></a></dt>
<dd><p>hsd_imaging —- Generate single dish images</p>
<p>The hsd_imaging task generates single dish images per antenna as
well as combined image over whole antennas for each field and
spectral window. Image configuration (grid size, number of pixels,
etc.) is automatically determined based on meta data such as
antenna diameter, map extent, etc.</p>
<p>Note that generated images are always in LSRK frame.</p>
<p>Output:
results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<dl class="simple">
<dt>mode          Imaging mode controls imaging parameters in the task.</dt><dd><p>Accepts either “line” (spectral line imaging) or “ampcal”
(image settings for amplitude calibrator)</p>
</dd>
</dl>
<p>restfreq      Rest frequency
infiles       List of data files. These must be a name of</p>
<blockquote>
<div><p>MeasurementSets that are registered to context via
hsd_importdata task.
example: vis=[‘uid___A002_X85c183_X36f.ms’,</p>
<blockquote>
<div><p>‘uid___A002_X85c183_X60b.ms’]</p>
</div></blockquote>
</div></blockquote>
<dl class="simple">
<dt>field         Data selection by field names or ids.</dt><dd><p>example: “<cite>*Sgr*,M100</cite>”</p>
</dd>
<dt>spw           Data selection by spw ids.</dt><dd><p>example: “3,4” (generate images for spw 3 and 4)</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Generate images with default settings and context</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_imaging</span><span class="p">()</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Generate images with amplitude calibrator and specific parameters</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_imaging</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;ampcal&#39;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;*Sgr*,M100&#39;</span><span class="p">,</span> <span class="n">spw</span><span class="o">=</span><span class="s1">&#39;17,19&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_importdata">
<span class="sig-name descname"><span class="pre">hsd_importdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_rasterscan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_caldevice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocopy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bdfflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datacolumns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_pointing_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">createmms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_importdata.html#hsd_importdata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_importdata" title="Link to this definition"></a></dt>
<dd><p>hsd_importdata —- Imports data into the single dish pipeline</p>
<p>The hsd_importdata task loads the specified visibility data into the pipeline
context unpacking and / or converting it as necessary.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> input parameter is set to False and the task is asked to
convert an input ASDM input to an MS, then when the output MS already exists in
the output directory, the importasdm conversion step is skipped, and the
existing MS will be imported instead.</p>
<p>Output:</p>
<p>results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<dl class="simple">
<dt>vis                      List of visibility data files. These may be ASDMs, tar files of ASDMs,</dt><dd><p>MSes, or tar files of MSes, If ASDM files are specified, they will be
converted to MS format.
example: vis=[‘X227.ms’, ‘asdms.tar.gz’]</p>
</dd>
<dt>session                  List of sessions to which the visibility files belong. Defaults</dt><dd><p>to a single session containing all the visibility files, otherwise
a session must be assigned to each vis file.
example: session=[‘Session_1’, ‘Sessions_2’]</p>
</dd>
<dt>hm_rasterscan            Heuristics method for raster scan analysis. Two analysis modes,</dt><dd><p>time-domain analysis (‘time’) and direction analysis (‘direction’), are available.
Default is ‘time’.</p>
</dd>
<dt>parallel                 Execute using CASA HPC functionality, if available.</dt><dd><p>options: ‘automatic’, ‘true’, ‘false’, True, False
default: None (equivalent to ‘automatic’)</p>
</dd>
<dt>asis                     Creates verbatim copies of the ASDM tables in the output MS.</dt><dd><p>The value given to this option must be a list of table names
separated by space characters.
example: ‘Receiver’, ‘’</p>
</dd>
<dt>process_caldevice        Ingest the ASDM caldevice table.</dt><dd><p>example: True</p>
</dd>
<dt>overwrite                Overwrite existing files on import.</dt><dd><p>When converting ASDM to MS, if overwrite=False and the MS already
exists in output directory, then this existing MS dataset will be used
instead.</p>
</dd>
</dl>
<p>nocopy                   Disable copying of MS to working directory
bdfflags                 Apply BDF flags on import.
datacolumns              Dictionary defining the data types of</p>
<blockquote>
<div><p>existing columns. The format is:</p>
<p>{‘data’: ‘data type 1’}
or
{‘data’: ‘data type 1’, ‘corrected’: ‘data type 2’}</p>
<p>For ASDMs the data type can only be RAW and one
can only specify it for the data column.</p>
<p>For MSes one can define two different data types
for the DATA and CORRECTED_DATA columns and they
can be any of the known data types (RAW,
REGCAL_CONTLINE_ALL, REGCAL_CONTLINE_SCIENCE,
SELFCAL_CONTLINE_SCIENCE, REGCAL_LINE_SCIENCE,
SELFCAL_LINE_SCIENCE, BASELINED, ATMCORR). The
intent selection strings _ALL or _SCIENCE can be
skipped. In that case the task determines this
automatically by inspecting the existing intents
in the dataset.</p>
<p>Usually, a single datacolumns dictionary is used
for all datasets. If necessary, one can define a
list of dictionaries, one for each EB, with
different setups per EB.</p>
<p>If no type is specified, {‘data’:’raw’} will
be assumed.</p>
</div></blockquote>
<p>lazy                     Use the lazy filter import
with_pointing_correction add (ASDM::Pointing::encoder - ASDM::Pointing::pointingDirection)</p>
<blockquote>
<div><p>to the value to be written in MS::Pointing::direction</p>
</div></blockquote>
<p>createmms                Create an MMS</p>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Load an ASDM list in the ../rawdata subdirectory into the context.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_importdata</span> <span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;../rawdata/uid___A002_X30a93d_X43e&#39;</span><span class="p">,</span> <span class="s1">&#39;../rawdata/uid_A002_x30a93d_X44e&#39;</span><span class="p">])</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Load an MS in the current directory into the context.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_importdata</span> <span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;uid___A002_X30a93d_X43e.ms&#39;</span><span class="p">])</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Load a tarred ASDM in ../rawdata into the context.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_importdata</span> <span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;../rawdata/uid___A002_X30a93d_X43e.tar.gz&#39;</span><span class="p">])</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Import a list of MeasurementSets.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">myvislist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;uid___A002_X30a93d_X43e.ms&#39;</span><span class="p">,</span> <span class="s1">&#39;uid_A002_x30a93d_X44e.ms&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_importdata</span><span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="n">myvislist</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_k2jycal">
<span class="sig-name descname"><span class="pre">hsd_k2jycal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbservice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reffile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_k2jycal.html#hsd_k2jycal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_k2jycal" title="Link to this definition"></a></dt>
<dd><p>hsd_k2jycal —- Derive Kelvin to Jy calibration tables</p>
<p>Derive the Kelvin to Jy calibration for list of MeasurementSets.</p>
<p>results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<p>dbservice     Whether or not accessing Jy/K DB to retrieve conversion factors.
endpoint      Which endpoints to use for query</p>
<blockquote>
<div><p>options: ‘asdm’, ‘model-fit’, ‘interpolation’</p>
</div></blockquote>
<dl>
<dt>reffile       Path to a file containing Jy/K factors for science data, which</dt><dd><p>must be provided by associating calibrator reduction or the observatory
measurements. Jy/K factor must take into account all efficiencies, i.e.,
it must be a direct conversion factor from Ta* to Jy. The file must be
in either MS-based or session-based format. The MS-based format must
be in an CSV format with five fields: MS name, antenna name, spectral
window id, polarization string, and Jy/K conversion factor. Example for
the file is as follows:</p>
<blockquote>
<div><p>MS,Antenna,Spwid,Polarization,Factor
uid___A002_X316307_X6f.ms,CM03,5,XX,10.0
uid___A002_X316307_X6f.ms,CM03,5,YY,12.0
uid___A002_X316307_X6f.ms,PM04,5,XX,2.0
uid___A002_X316307_X6f.ms,PM04,5,YY,5.0</p>
</div></blockquote>
<p>The first line in the above example is a header which may or may not
exist. Example for the session-based format is as follows:</p>
<blockquote>
<div><p>#OUSID=XXXXXX
#OBJECT=Uranus
#FLUXJY=yy,zz,aa
#FLUXFREQ=YY,ZZ,AA
#sessionID,ObservationStartDate(UTC),ObservationEndDate(UTC),
Antenna,BandCenter(MHz),BandWidth(MHz),POL,Factor
1,2011-11-11 01:00:00,2011-11-11 01:30:00,CM02,86243.0,500.0,I,10.0
1,2011-11-11 01:00:00,2011-11-11 01:30:00,CM02,86243.0,1000.0,I,30.0
1,2011-11-11 01:00:00,2011-11-11 01:30:00,CM03,86243.0,500.0,I,50.0
1,2011-11-11 01:00:00,2011-11-11 01:30:00,CM03,86243.0,1000.0,I,70.0
1,2011-11-11 01:00:00,2011-11-11 01:30:00,ANONYMOUS,86243.0,500.0,I,30.0
1,2011-11-11 01:00:00,2011-11-11 01:30:00,ANONYMOUS,86243.0,1000.0,I,50.0
2,2011-11-13 01:45:00,2011-11-13 02:15:00,PM04,86243.0,500.0,I,90.0
2,2011-11-13 01:45:00,2011-11-13 02:15:00,PM04,86243.0,1000.0,I,110.0
2,2011-11-13 01:45:00,2011-11-13 02:15:00,ANONYMOUS,86243.0,500.0,I,90.0
2,2011-11-13 01:45:00,2011-11-13 02:15:00,ANONYMOUS,86243.0,1000.0,I,110.0</p>
</div></blockquote>
<p>Lines starting with ‘#’ are meta data and header.
The header must exist. The factor to apply is identified by matching the
session ID, antenna name, frequency and polarization of data in each line of
the file. Note the observation date is supplementary information and not used
for the matching so far. The lines whose antenna name is ‘ANONYMOUS’ are used
when there is no measurement for specific antenna in the session. In the above
example, if science observation of session 1 contains the antenna PM04, Jy/K
factor for ANONYMOUS antenna will be applied since there is no measurement for
PM04 in session 1.
If no file name is specified or specified file doesn’t exist, all Jy/K factors
are set to 1.0.</p>
<p>example: reffile=’’, reffile=’working/jyperk.csv’</p>
</dd>
</dl>
<p>infiles       List of input MeasurementSets.</p>
<blockquote>
<div><p>example: vis=’ngc5921.ms’</p>
</div></blockquote>
<p>caltable      Name of output gain calibration tables.</p>
<blockquote>
<div><p>example: caltable=’ngc5921.gcal’</p>
</div></blockquote>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Compute the Kevin to Jy calibration tables for a list of MeasurementSets:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_k2jycal</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_restoredata">
<span class="sig-name descname"><span class="pre">hsd_restoredata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">products_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copytoraw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawdata_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bdfflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ocorr_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hm_rasterscan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_restoredata.html#hsd_restoredata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_restoredata" title="Link to this definition"></a></dt>
<dd><p>hsd_restoredata —- Restore flagged and calibration single dish data from a pipeline run</p>
<p>The hsd_restoredata task restores flagged and calibrated MeasurementSets
from archived ASDMs and pipeline flagging and calibration data products.</p>
<p>hsd_restoredata assumes that the ASDMs to be restored are present in the
directory specified by the <code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code> (default: ‘../rawdata’).</p>
<p>By default (<code class="docutils literal notranslate"><span class="pre">copytoraw</span></code> = True), hsd_restoredata assumes that for each
ASDM in the input list, the corresponding pipeline flagging and calibration
data products (in the format produced by the hsd_exportdata task) are
present in the directory specified by <code class="docutils literal notranslate"><span class="pre">products_dir</span></code> (default: ‘../products’).
At the start of the task, these products are copied from the <code class="docutils literal notranslate"><span class="pre">products_dir</span></code>
to the <code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">copytoraw</span></code> = False, hsd_restoredata assumes that these products are
to be found in <code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code> along with the ASDMs.</p>
<p>The expected flagging and calibration products (for each ASDM) include:</p>
<blockquote>
<div><ul class="simple">
<li><p>a compressed tar file of the final flagversions file, e.g.
uid___A002_X30a93d_X43e.ms.flagversions.tar.gz</p></li>
<li><p>a text file containing the applycal instructions, e.g.
uid___A002_X30a93d_X43e.ms.calapply.txt</p></li>
<li><p>a compressed tar file containing the caltables for the parent session,
e.g. uid___A001_X74_X29.session_3.caltables.tar.gz</p></li>
</ul>
</div></blockquote>
<p>hsd_restoredata performs the following operations:</p>
<ul class="simple">
<li><p>imports the ASDM(s)</p></li>
<li><p>removes the default MS.flagversions directory created by the filler</p></li>
<li><p>restores the final MS.flagversions directory stored by the pipeline</p></li>
<li><p>restores the final set of pipeline flags to the MS</p></li>
<li><p>restores the final calibration state of the MS</p></li>
<li><p>restores the final calibration tables for each MS</p></li>
<li><p>applies the calibration tables to each MS</p></li>
</ul>
<p>When importing the ASDM and converting it to a Measurement Set (MS), if the
output MS already exists in the output directory, then the importasdm
conversion step is skipped, and the existing MS will be imported instead.</p>
<p>Output:</p>
<p>results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>vis           List of raw visibility data files to be restored. Assumed to be</dt><dd><p>in the directory specified by rawdata_dir.</p>
<p>example: vis=[‘uid___A002_X30a93d_X43e’]</p>
</dd>
</dl>
<p>session       List of sessions one per visibility file.</p>
<blockquote>
<div><p>example: session=[‘session_3’]</p>
</div></blockquote>
<dl>
<dt>products_dir  Name of the data products directory to copy calibration</dt><dd><p>products from.
Default: ‘../products’</p>
<p>The parameter is effective only when <code class="docutils literal notranslate"><span class="pre">copytoraw</span></code> = True.
When <code class="docutils literal notranslate"><span class="pre">copytoraw</span></code> = False, calibration products in
<code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code> will be used.</p>
<p>example: products_dir=’myproductspath’</p>
</dd>
<dt>copytoraw     Copy calibration and flagging tables from <code class="docutils literal notranslate"><span class="pre">products_dir</span></code> to</dt><dd><p><code class="docutils literal notranslate"><span class="pre">rawdata_dir</span></code> directory.
Default: True</p>
<p>example: copytoraw=False</p>
</dd>
<dt>rawdata_dir   Name of the raw data directory.</dt><dd><p>Default: ‘../rawdata’</p>
<p>example: rawdata_dir=’myrawdatapath’</p>
</dd>
<dt>lazy          Use the lazy filler option</dt><dd><p>Default: False</p>
<p>example: lazy=True</p>
</dd>
<dt>bdfflags      Set the BDF flags</dt><dd><p>Default: True</p>
<p>example: bdfflags=False</p>
</dd>
<dt>ocorr_mode    Set ocorr_mode</dt><dd><p>Default: ‘ao’</p>
<p>example: ocorr_mode=’ca’</p>
</dd>
<dt>asis          Creates verbatim copies of the ASDM tables in the output MS.</dt><dd><p>The value given to this option must be a list of table names separated by space characters.
Default: ‘SBSummary ExecBlock Annotation Antenna Station Receiver Source CalAtmosphere CalWVR’</p>
<p>example: asis=’Source Receiver’</p>
</dd>
<dt>hm_rasterscan Heuristics method for raster scan analysis. Two analysis modes,</dt><dd><p>time-domain analysis (‘time’) and direction analysis (‘direction’), are available.
Default: ‘time’</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Restore the pipeline results for a single ASDM in a single session</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_restoredata</span> <span class="p">(</span><span class="n">vis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;uid___A002_X30a93d_X43e&#39;</span><span class="p">],</span> <span class="n">session</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;session_1&#39;</span><span class="p">],</span> <span class="n">ocorr_mode</span><span class="o">=</span><span class="s1">&#39;ao&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_skycal">
<span class="sig-name descname"><span class="pre">hsd_skycal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elongated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_skycal.html#hsd_skycal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_skycal" title="Link to this definition"></a></dt>
<dd><p>hsd_skycal —- Calibrate data</p>
<p>The hsd_skycal generates a caltable for sky calibration that stores
reference spectra, which is to be subtracted from on-source spectra to filter
out non-source contribution.</p>
<p>Output:</p>
<p>results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<dl>
<dt>calmode       Calibration mode. Available options are ‘auto’ (default),</dt><dd><p>‘ps’, ‘otf’, and ‘otfraster’. When ‘auto’ is set, the task will
use preset calibration mode that is determined by inspecting data.
‘ps’ mode is simple position switching using explicit reference
scans. Other two modes, ‘otf’ and ‘otfraster’, will generate
reference data from scans at the edge of the map. Those modes
are intended for OTF observation and the former is defined for
generic scanning pattern such as Lissajous, while the latter is
specific use for raster scan.</p>
<p>options: ‘auto’, ‘ps’, ‘otf’, ‘otfraster’</p>
</dd>
<dt>fraction      Sub-parameter for calmode. Edge marking parameter for</dt><dd><p>‘otf’ and ‘otfraster’ mode. It specifies a number of OFF scans
as a fraction of total number of data points.</p>
<p>options: String style like ‘20%’, or float value less than 1.0.
For ‘otfraster’ mode, you can also specify ‘auto’.</p>
</dd>
<dt>noff          Sub-parameter for calmode. Edge marking parameter for ‘otfraster’</dt><dd><p>mode. It is used to specify a number of OFF scans near edge directly
instead to specify it by fractional number by ‘fraction’. If it is
set, the value will come before setting by ‘fraction’.</p>
<p>options: any positive integer value</p>
</dd>
<dt>width         Sub-parameter for calmode. Edge marking parameter for ‘otf’</dt><dd><p>mode. It specifies pixel width with respect to a median spatial
separation between neighboring two data in time. Default will
be fine in most cases.</p>
<p>options: any float value</p>
</dd>
<dt>elongated     Sub-parameter for calmode. Edge marking parameter for</dt><dd><p>‘otf’ mode. Please set True only if observed area is elongated
in one direction.</p>
</dd>
<dt>parallel      Execute using CASA HPC functionality, if available.</dt><dd><p>options: ‘automatic’, ‘true’, ‘false’, True, False
default: None (equivalent to ‘automatic’)</p>
</dd>
<dt>infiles       List of data files. These must be a name of MeasurementSets that</dt><dd><p>are registered to context via hsd_importdata task.</p>
<p>example: vis=[‘X227.ms’, ‘X228.ms’]</p>
</dd>
</dl>
<p>field         Data selection by field name.
spw           Data selection by spw. (defalut all spws)</p>
<blockquote>
<div><dl class="simple">
<dt>example: ‘3,4’ (generate caltable for spw 3 and 4)</dt><dd><p>[‘0’,’2’] (spw 0 for first data, 2 for second)</p>
</dd>
</dl>
</div></blockquote>
<p>scan          Data selection by scan number. (default all scans)</p>
<blockquote>
<div><dl class="simple">
<dt>example: ‘22,23’ (use scan 22 and 23 for calibration)</dt><dd><p>[‘22’,’24’] (scan 22 for first data, 24 for second)</p>
</dd>
</dl>
</div></blockquote>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Generate caltables for all data managed by context.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">default</span><span class="p">(</span><span class="n">hsd_skycal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_skycal</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.hsd.cli.hsd_tsysflag">
<span class="sig-name descname"><span class="pre">hsd_tsysflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_nmedian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnm_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnm_byfield</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_derivative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fd_max_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_edgechans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fe_edge_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_fieldshape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff_refintent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff_max_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_birdies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fb_sharps_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_toomany</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmf1_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmef1_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_tsys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetemplate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/cli/hsd_tsysflag.html#hsd_tsysflag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.cli.hsd_tsysflag" title="Link to this definition"></a></dt>
<dd><p>hsd_tsysflag —- Flag deviant system temperature measurements</p>
<p>Flag deviant system temperature measurements for single dish measurements. This is done by running a
sequence of flagging sub-tasks (tests), each looking for a different type of possible error.</p>
<p>If a file with manual Tsys flags is provided with the ‘filetemplate’
parameter, then these flags are applied prior to the evaluation of the
flagging heuristics listed below.</p>
<p>The tests are:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Flag Tsys spectra with high median values</p></li>
<li><p>Flag Tsys spectra with high median derivatives. This is meant to spot</p></li>
</ol>
<blockquote>
<div><p>spectra that are ‘ringing’.</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Flag the edge channels of the Tsys spectra in each SpW.</p></li>
<li><p>Flag Tsys spectra whose shape is different from that associated with</p></li>
</ol>
<blockquote>
<div><p>the BANDPASS intent.</p>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Flag ‘birdies’.</p></li>
<li><p>Flag the Tsys spectra of all antennas in a timestamp and spw if</p></li>
</ol>
<blockquote>
<div><p>proportion of antennas already flagged in this timestamp and spw exceeds
a threshold, and flag Tsys spectra for all antennas and all timestamps
in a spw, if proportion of antennas that are already entirely flagged
in all timestamps exceeds a threshold.</p>
</div></blockquote>
</div></blockquote>
<p>Output</p>
<p>results – The results object for the pipeline task is returned.</p>
<p>——— parameter descriptions ———————————————</p>
<p>vis             List of input MeasurementSets (Not used)
caltable        List of input Tsys calibration tables.</p>
<blockquote>
<div><p>default: [] - Use the table currently stored in the pipeline context.
example: caltable=[‘X132.ms.tsys.s2.tbl’]</p>
</div></blockquote>
<p>flag_nmedian    True to flag Tsys spectra with high median value.
fnm_limit       Flag spectra with median value higher than fnm_limit * median</p>
<blockquote>
<div><p>of this measure over all spectra.</p>
</div></blockquote>
<p>fnm_byfield     Evaluate the nmedian metric separately for each field.
flag_derivative True to flag Tsys spectra with high median derivative.
fd_max_limit    Flag spectra with median derivative higher than</p>
<blockquote>
<div><p>fd_max_limit * median of this measure over all spectra.</p>
</div></blockquote>
<p>flag_edgechans  True to flag edges of Tsys spectra.
fe_edge_limit   Flag channels whose channel to channel difference &gt;</p>
<blockquote>
<div><p>fe_edge_limit * median across spectrum.</p>
</div></blockquote>
<dl class="simple">
<dt>flag_fieldshape True to flag Tsys spectra with a radically different</dt><dd><p>shape to those of the ff_refintent.</p>
</dd>
</dl>
<p>ff_refintent    Data intent that provides the reference shape for ‘flag_fieldshape’.
ff_max_limit    Flag Tsys spectra with ‘fieldshape’ metric values &gt;</p>
<blockquote>
<div><p>ff_max_limit.</p>
</div></blockquote>
<p>flag_birdies    True to flag channels covering sharp spectral features.
fb_sharps_limit Flag channels bracketing a channel to channel</p>
<blockquote>
<div><p>difference &gt; fb_sharps_limit.</p>
</div></blockquote>
<dl class="simple">
<dt>flag_toomany    True to flag Tsys spectra for which a proportion of</dt><dd><p>antennas for given timestamp and/or proportion of antennas that are
entirely flagged in all timestamps exceeds their respective thresholds.</p>
</dd>
<dt>tmf1_limit      Flag Tsys spectra for all antennas in a timestamp and spw if</dt><dd><p>proportion of antennas already flagged in this timestamp and spw exceeds
tmf1_limit.</p>
</dd>
<dt>tmef1_limit     Flag Tsys spectra for all antennas and all timestamps</dt><dd><p>in a spw, if proportion of antennas that are already entirely flagged
in all timestamps exceeds tmef1_limit.</p>
</dd>
<dt>metric_order    Order in which to evaluate the flagging metrics that are</dt><dd><p>enabled. Disabled metrics are skipped.</p>
</dd>
<dt>normalize_tsys  True to create a normalized Tsys table that is used to</dt><dd><p>evaluate the Tsys flagging metrics. All newly found flags are also applied
to the original Tsys caltable that continues to be used for subsequent
calibration.</p>
</dd>
<dt>filetemplate    The name of a text file that contains the manual Tsys flagging</dt><dd><p>template. If the template flags file is undefined, a name of the form
‘msname.flagtsystemplate.txt’ is assumed.</p>
</dd>
</dl>
<p>——— examples ———————————————————–</p>
<ol class="arabic simple">
<li><p>Flag Tsys measurements using currently recommended tests:</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_tsysflag</span><span class="p">()</span>
</pre></div>
</div>
<p>2. Flag Tsys measurements using all recommended tests apart from that
using the ‘fieldshape’ metric:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hsd_tsysflag</span><span class="p">(</span><span class="n">flag_fieldshape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020–2024, Pipeline Dev. Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>