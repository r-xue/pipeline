

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pipeline.infrastructure.utils package &mdash; Pipeline unknown documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/custom_theme.css?v=678032d9" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=3f1b9271"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Pipeline
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Pipeline Tasks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pipeline_tasks/pipeline_tasks.html">Pipeline Heuristics Tasks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Pipeline Task (sphinx-autosummary)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.h.cli.html">pipeline.h.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.hif.cli.html">pipeline.hif.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.hifa.cli.html">pipeline.hifa.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.hifv.cli.html">pipeline.hifv.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.hsd.cli.html">pipeline.hsd.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.hsdn.cli.html">pipeline.hsdn.cli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.domain.html">pipeline.domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.infrastructure.launcher.html">pipeline.infrastructure.launcher</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.domain.html">pipeline.domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/pipeline.infrastructure.launcher.html">pipeline.infrastructure.launcher</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Pipeline Heuristics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../heuristics/field_parameter.html">Field parameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../heuristics/FlaggingTasks.html">Pipeline Flagging Tasks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Releases etc.</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Pipeline Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modular.html">Run the Pipeline in a Conda environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dependencies.html">Dependencies of <cite>Pipeline</cite></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Pipeline Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../basics.html">pipeline.domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics.html#module-pipeline.infrastructure.launcher">pipeline.infrastructure.launcher</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Task Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../task_classes.html">pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../task_classes.html#module-pipeline.hif.tasks">pipeline-l2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../task_classes.html#module-pipeline.hif">pipeline-l3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../task_classes.html#pipeline-diagram">pipeline-diagram</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/ways_to_run_the_pipeline.html">Ways to run the Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/comparing_pipeline_executions.html">Comparing pipeline executions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/building_the_pipeline.html">Building the pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/ALMA-Imaging-Workflow.html">ALMA interferometry imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/VLA-Imaging-Workflow.html">VLA interferometry imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/VLASS-SE-CONT-Imaging-Workflow.html">VLASS-SE-CONT imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/VLASS-SE-CUBE-Imaging-Workflow.html">VLASS-SE-CUBE imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/selfcal_workflow.html">VLASS Selfcal &amp; Restore workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/pipeline_tests.html">Pipeline testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/DataType_Testing.html">DataType Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/QA_scores.html">Pipeline Quality Assurance (QA) Score Class Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/DeveloperDocumentation.html">Pipeline developer documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/python3_conversion_notes.html">Python 3 conversion notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/recipes.html">Pipeline Recipes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples Notes (from Jupyter Notebooks)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/test1.html">test</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example Notes (from .rst)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/test2.html">Example 1</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Pipeline</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">pipeline.infrastructure.utils package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_apidoc/pipeline.infrastructure.utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pipeline-infrastructure-utils-package">
<h1>pipeline.infrastructure.utils package<a class="headerlink" href="#pipeline-infrastructure-utils-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-pipeline.infrastructure.utils.casa_data">
<span id="pipeline-infrastructure-utils-casa-data-module"></span><h2>pipeline.infrastructure.utils.casa_data module<a class="headerlink" href="#module-pipeline.infrastructure.utils.casa_data" title="Link to this heading"></a></h2>
<p>Utilities to work with the CASA data files</p>
<dl class="py class">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.casa_data.IERSInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IERSInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iers_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'/home/runner/.casa/data/geodetic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_on_creation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/casa_data.html#IERSInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.casa_data.IERSInfo" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to store, retrieve and process the information from the IERS geodetic tables</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>IERS_tables</strong> (<em>tuple</em>) – Class attribute with the name of the relevant tables</p></li>
<li><p><strong>iers_path</strong> (<em>str</em>) – Path to the location of the geodetic tables</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Dictionary with the information retrieved</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.casa_data.IERSInfo.IERS_tables">
<span class="sig-name descname"><span class="pre">IERS_tables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('IERSpredict',</span> <span class="pre">'IERSeop2000')</span></em><a class="headerlink" href="#pipeline.infrastructure.utils.casa_data.IERSInfo.IERS_tables" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.casa_data.IERSInfo.date_message_type">
<span class="sig-name descname"><span class="pre">date_message_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">datetime</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/casa_data.html#IERSInfo.date_message_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.casa_data.IERSInfo.date_message_type" title="Link to this definition"></a></dt>
<dd><p>Check if and where a date falls within the time ranges covered by the IERSeop2000 table and the IERSpredict table, and return a string indicating what kind of message should be displayed about this.
See PIPE-734 and PIPE-1231 for more information.</p>
<p>GOOD: Date is lower than or equal to the last entry of the IERSeop2000 table
INFO: Date is greater than the last entry of the IERSeop2000 table but less than three months after that entry (the normal maximum delay between table updates,) so the predicted IERS table will be used.
WARN: Date is greater than the last entry of the IERSeop2000 table + 3 months, but less than the last entry of the IERSpredict table, so WARN and use the predicted table
CRITICAL: Date is greater than the last entry of the IERSpredicted table, or one or both of the IERS tables are missing, so issue a critical ALERT</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.casa_data.IERSInfo.get_IERS_last_entry">
<span class="sig-name descname"><span class="pre">get_IERS_last_entry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'IERSeop2000'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/casa_data.html#IERSInfo.get_IERS_last_entry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.casa_data.IERSInfo.get_IERS_last_entry" title="Link to this definition"></a></dt>
<dd><p>Get the last entry in the MJD column of the specified IERS table. Defaults to IERSeop2000.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.casa_data.IERSInfo.get_IERS_version">
<span class="sig-name descname"><span class="pre">get_IERS_version</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IERS_tablename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/casa_data.html#IERSInfo.get_IERS_version"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.casa_data.IERSInfo.get_IERS_version" title="Link to this definition"></a></dt>
<dd><p>Get the VS_VERSION header of the IERSpredict table</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>IERS_tablename</strong> (<em>str</em>) – Name of the table to be loaded (“IERSpredict” or “IERSeop2000”)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.casa_data.IERSInfo.load_info">
<span class="sig-name descname"><span class="pre">load_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/casa_data.html#IERSInfo.load_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.casa_data.IERSInfo.load_info" title="Link to this definition"></a></dt>
<dd><p>Get the following data from the casa geodetic tables:
* IERSpredict version
* IERSeop2000 version
* IERSeop2000 last MJD entry
* IERSeop2000 last datetime entry
* IERSpredict last datetime entry</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.casa_data.IERSInfo.validate_date">
<span class="sig-name descname"><span class="pre">validate_date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">datetime</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/casa_data.html#IERSInfo.validate_date"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.casa_data.IERSInfo.validate_date" title="Link to this definition"></a></dt>
<dd><p>Check if a date is lower or equal than the last entry of the IERSeop2000 table.
The end date of the MS should be lower (see PIPE-734).
If the geodetic tables could not be loaded correctly it always return False.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.casa_data.from_mjd_to_datetime">
<span class="sig-name descname"><span class="pre">from_mjd_to_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mjd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">datetime</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/casa_data.html#from_mjd_to_datetime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.casa_data.from_mjd_to_datetime" title="Link to this definition"></a></dt>
<dd><p>Convert a MJD float into a datetime</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.casa_data.get_file_md5">
<span class="sig-name descname"><span class="pre">get_file_md5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/casa_data.html#get_file_md5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.casa_data.get_file_md5" title="Link to this definition"></a></dt>
<dd><p>Return a readable hex string of the MD5 hash of a given file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.casa_data.get_filename_info">
<span class="sig-name descname"><span class="pre">get_filename_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/casa_data.html#get_filename_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.casa_data.get_filename_info" title="Link to this definition"></a></dt>
<dd><p>Get a string with information about the modification date and MD5 hash of a file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.casa_data.get_iso_mtime">
<span class="sig-name descname"><span class="pre">get_iso_mtime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/casa_data.html#get_iso_mtime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.casa_data.get_iso_mtime" title="Link to this definition"></a></dt>
<dd><p>Return the ISO 8601 datetime string corresponding to the
modification time of a given file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.casa_data.get_object_info_string">
<span class="sig-name descname"><span class="pre">get_object_info_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ss_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'/home/runner/.casa/data/alma/SolarSystemModels'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/casa_data.html#get_object_info_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.casa_data.get_object_info_string" title="Link to this definition"></a></dt>
<dd><p>Get the file information (MD5 hash and modification date) for a given
Solar System object.</p>
<p>At the moment the function returns all the matching model files corresponding
to an object.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.casa_data.get_solar_system_model_files">
<span class="sig-name descname"><span class="pre">get_solar_system_model_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ss_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'/home/runner/.casa/data/alma/SolarSystemModels'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/casa_data.html#get_solar_system_model_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.casa_data.get_solar_system_model_files" title="Link to this definition"></a></dt>
<dd><p>Return the data files corresponding to a Solar System object</p>
</dd></dl>

</section>
<section id="pipeline-infrastructure-utils-casa-data-test-module">
<h2>pipeline.infrastructure.utils.casa_data_test module<a class="headerlink" href="#pipeline-infrastructure-utils-casa-data-test-module" title="Link to this heading"></a></h2>
</section>
<section id="module-pipeline.infrastructure.utils.compatibility">
<span id="pipeline-infrastructure-utils-compatibility-module"></span><h2>pipeline.infrastructure.utils.compatibility module<a class="headerlink" href="#module-pipeline.infrastructure.utils.compatibility" title="Link to this heading"></a></h2>
<p>Compatibility management.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.compatibility.get_scipy_function_for_mad">
<span class="sig-name descname"><span class="pre">get_scipy_function_for_mad</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/compatibility.html#get_scipy_function_for_mad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.compatibility.get_scipy_function_for_mad" title="Link to this definition"></a></dt>
<dd><p>Return function to compute median absolute deviation (MAD).</p>
<p>This absorbs the API difference bewteen SciPy versions including
function name and scale parameter value.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – SciPy version is too old (lower than 1.3.0)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>function to compute MAD</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pipeline.infrastructure.utils.compatibility_test">
<span id="pipeline-infrastructure-utils-compatibility-test-module"></span><h2>pipeline.infrastructure.utils.compatibility_test module<a class="headerlink" href="#module-pipeline.infrastructure.utils.compatibility_test" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.compatibility_test.test_get_func_compute_mad">
<span class="sig-name descname"><span class="pre">test_get_func_compute_mad</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/compatibility_test.html#test_get_func_compute_mad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.compatibility_test.test_get_func_compute_mad" title="Link to this definition"></a></dt>
<dd><p>Test scipy.stats.median_abs(olute)_deviation to ensure compatibility between py3.6 and py3.8.</p>
</dd></dl>

</section>
<section id="module-pipeline.infrastructure.utils.conversion">
<span id="pipeline-infrastructure-utils-conversion-module"></span><h2>pipeline.infrastructure.utils.conversion module<a class="headerlink" href="#module-pipeline.infrastructure.utils.conversion" title="Link to this heading"></a></h2>
<p>The conversion module contains utility functions.</p>
<p>The conversion module contains utility functions that convert between data
types and assist in formatting objects as strings for presentation to the
user.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.conversion.ant_arg_to_id">
<span class="sig-name descname"><span class="pre">ant_arg_to_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ms_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ant_arg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_antennas</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/conversion.html#ant_arg_to_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.conversion.ant_arg_to_id" title="Link to this definition"></a></dt>
<dd><p>Convert a string to the corresponding antenna IDs.</p>
<dl class="simple">
<dt>Args</dt><dd><p>ms_path: A path to the measurement set.
ant_arg: A antenna selection in CASA format.
all_antennas: All antenna domain objects for use when CASA msselect is disabled.</p>
</dd>
<dt>Returns</dt><dd><p>A list of antenna IDs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.conversion.commafy">
<span class="sig-name descname"><span class="pre">commafy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quotes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">',</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conjunction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'and'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/conversion.html#commafy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.conversion.commafy" title="Link to this definition"></a></dt>
<dd><p>Convert the string list into the textual description.</p>
<p>Example:
&gt;&gt;&gt; commafy([‘a’,’b’,’c’])
“‘a’, ‘b’ and ‘c’”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l</strong> – Python string list.</p></li>
<li><p><strong>quotes</strong> – If quote is True, ‘l’ arg elements are enclosed in quotes by each.</p></li>
<li><p><strong>multi_prefix</strong> – If the ‘l’ arg has three or more elements, the ‘multi_prefix’
attach to the head.</p></li>
<li><p><strong>separator</strong> – The ‘separator’ arg is used as separator instead of ‘,’.</p></li>
<li><p><strong>conjunction</strong> – The ‘conjunction’ arg is used as conjunction instead of ‘and’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The textual description of the given list.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.conversion.dequote">
<span class="sig-name descname"><span class="pre">dequote</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/conversion.html#dequote"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.conversion.dequote" title="Link to this definition"></a></dt>
<dd><p>Remove any kind of quotes from a string to facilitate comparisons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>s</strong> – A string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>String removed any kind of quotes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.conversion.field_arg_to_id">
<span class="sig-name descname"><span class="pre">field_arg_to_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ms_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_arg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_fields</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/conversion.html#field_arg_to_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.conversion.field_arg_to_id" title="Link to this definition"></a></dt>
<dd><p>Convert a string to the corresponding field IDs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ms_path</strong> – A path to the measurement set.</p></li>
<li><p><strong>field_arg</strong> – A field selection in CASA format.</p></li>
<li><p><strong>all_fields</strong> – All Field objects, for use when CASA msselect is not used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of field IDs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.conversion.flatten">
<span class="sig-name descname"><span class="pre">flatten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/conversion.html#flatten"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.conversion.flatten" title="Link to this definition"></a></dt>
<dd><p>Flatten a list of lists into a single list without pipelineaq.QAScore.</p>
<p>Example:
&gt;&gt;&gt; obj = flatten([1,2,[3,4,[5,6]],7])
&gt;&gt;&gt; obj.__next__()
1
&gt;&gt;&gt; obj.__next__()
2
&gt;&gt;&gt; obj.__next__()
3</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="mi">7</span><span class="p">]))</span>
<span class="go">[1, 2, &#39;c&#39;, 4, &#39;e&#39;, 6, 7]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>l</strong> – A list with list or any object.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p>Single list.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.conversion.format_datetime">
<span class="sig-name descname"><span class="pre">format_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">datetime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/conversion.html#format_datetime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.conversion.format_datetime" title="Link to this definition"></a></dt>
<dd><p>Convert a datetime to a formatted string representation.</p>
<p>Convert a Python datetime object into a string representation, including
microseconds to the requested precision.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> – Python datetime.</p></li>
<li><p><strong>dp</strong> – A number of decimal places for microseconds (0=do not show).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Formatted string representation of datetime.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.conversion.format_timedelta">
<span class="sig-name descname"><span class="pre">format_timedelta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">td</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">timedelta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/conversion.html#format_timedelta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.conversion.format_timedelta" title="Link to this definition"></a></dt>
<dd><p>Convert a timedelta to a formatted string representation.</p>
<p>Convert a Python timedelta object into a string representation, including
microseconds to the requested precision.</p>
<dl>
<dt>Args</dt><dd><p>td: A timedelta object.
dp: A number of decimal places for microseconds (0=do not show).</p>
<blockquote>
<div><p>The number should be natural number with 0.</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Formatted string representation of timedelta.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.conversion.get_epoch_as_datetime">
<span class="sig-name descname"><span class="pre">get_epoch_as_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Number</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">datetime</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/conversion.html#get_epoch_as_datetime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.conversion.get_epoch_as_datetime" title="Link to this definition"></a></dt>
<dd><p>Convert a CASA epoch measure into a Python datetime.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>epoch</strong> – CASA epoch measure.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The equivalent Python datetime.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.conversion.mjd_seconds_to_datetime">
<span class="sig-name descname"><span class="pre">mjd_seconds_to_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mjd_secs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Number</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">datetime</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/conversion.html#mjd_seconds_to_datetime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.conversion.mjd_seconds_to_datetime" title="Link to this definition"></a></dt>
<dd><p>Convert list of MJD seconds to a list of equivalent datetime objects.</p>
<p>Convert the input list of elapsed seconds since MJD epoch to the
equivalent Python datetime objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mjd_secs</strong> – list of elapsed seconds since MJD epoch.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of equivalent Python datetime objects.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.conversion.range_to_list">
<span class="sig-name descname"><span class="pre">range_to_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/conversion.html#range_to_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.conversion.range_to_list" title="Link to this definition"></a></dt>
<dd><p>Expand a numeric range expressed in CASA syntax to the list of integer.</p>
<p>Expand a numeric range expressed in CASA syntax to the equivalent Python
list of integers.</p>
<p>Example:
&gt;&gt;&gt; range_to_list(‘1~5,7~9’)
[1, 2, 3, 4, 5, 7, 8, 9]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arg</strong> – The numeric range expressed in CASA syntax.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The equivalent Python list of integers.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.conversion.record_to_quantity">
<span class="sig-name descname"><span class="pre">record_to_quantity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Quantity</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Quantity</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Quantity</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/conversion.html#record_to_quantity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.conversion.record_to_quantity" title="Link to this definition"></a></dt>
<dd><p>Convert a CASA record to an Astropy quantity.</p>
<p>Optionally, the input can be a list/tuple in which each element is a CASA record.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.conversion.safe_split">
<span class="sig-name descname"><span class="pre">safe_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/conversion.html#safe_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.conversion.safe_split" title="Link to this definition"></a></dt>
<dd><p>Split a string containing field names into a list.</p>
<p>Split a string containing field names into a list, taking account of field
names within quotes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fields</strong> – A string containing field names.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list, taking account of field names within quotes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.conversion.spw_arg_to_id">
<span class="sig-name descname"><span class="pre">spw_arg_to_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ms_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw_arg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_spws</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/conversion.html#spw_arg_to_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.conversion.spw_arg_to_id" title="Link to this definition"></a></dt>
<dd><p>Convert a string to spectral window IDs and channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ms_path</strong> – A path to the measurement set.</p></li>
<li><p><strong>spw_arg</strong> – A spw selection in CASA format.</p></li>
<li><p><strong>all_spws</strong> – List of all SpectralWindow objects, for use when CASA msselect
is not used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of (spw, chan_start, chan_end, step) lists.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.conversion.to_CASA_intent">
<span class="sig-name descname"><span class="pre">to_CASA_intent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intents</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/conversion.html#to_CASA_intent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.conversion.to_CASA_intent" title="Link to this definition"></a></dt>
<dd><p>Convert pipeline intents back to the equivalent intents recorded in the measurement set.</p>
<p>Example:
&gt; to_CASA_intent(ms, ‘PHASE,BANDPASS’)
‘CALIBRATE_PHASE_ON_SOURCE,CALIBRATE_BANDPASS_ON_SOURCE’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ms</strong> – MeasurementSet object.</p></li>
<li><p><strong>intents</strong> – pipeline intents to convert.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The CASA intents recorded.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.conversion.to_pipeline_intent">
<span class="sig-name descname"><span class="pre">to_pipeline_intent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intents</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/conversion.html#to_pipeline_intent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.conversion.to_pipeline_intent" title="Link to this definition"></a></dt>
<dd><p>Convert CASA intents to pipeline intents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ms</strong> – MeasurementSet object.</p></li>
<li><p><strong>intents</strong> – CASA intents to convert.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The pipeline intents.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="pipeline-infrastructure-utils-conversion-test-module">
<h2>pipeline.infrastructure.utils.conversion_test module<a class="headerlink" href="#pipeline-infrastructure-utils-conversion-test-module" title="Link to this heading"></a></h2>
</section>
<section id="module-pipeline.infrastructure.utils.debugwrapper">
<span id="pipeline-infrastructure-utils-debugwrapper-module"></span><h2>pipeline.infrastructure.utils.debugwrapper module<a class="headerlink" href="#module-pipeline.infrastructure.utils.debugwrapper" title="Link to this heading"></a></h2>
<p>Debug wrapper decorator class.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.debugwrapper.debugwrapper">
<span class="sig-name descname"><span class="pre">debugwrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/debugwrapper.html#debugwrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.debugwrapper.debugwrapper" title="Link to this definition"></a></dt>
<dd><p>Decorate methods to debug</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> – description string to output to log</p></li>
<li><p><strong>pp</strong> – pretty-print flag of argument objects</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pipeline.infrastructure.utils.diagnostics">
<span id="pipeline-infrastructure-utils-diagnostics-module"></span><h2>pipeline.infrastructure.utils.diagnostics module<a class="headerlink" href="#module-pipeline.infrastructure.utils.diagnostics" title="Link to this heading"></a></h2>
<p>The diagnostics module contains utility functions used to help profile the
pipeline.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.diagnostics.enable_fd_logs">
<span class="sig-name descname"><span class="pre">enable_fd_logs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interval_secs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/diagnostics.html#enable_fd_logs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.diagnostics.enable_fd_logs" title="Link to this definition"></a></dt>
<dd><p>Log file descriptors to the CASA log every n seconds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>interval_secs</strong> – logging cadence in seconds (default=60)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.diagnostics.enable_memstats">
<span class="sig-name descname"><span class="pre">enable_memstats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/diagnostics.html#enable_memstats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.diagnostics.enable_memstats" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pipeline.infrastructure.utils.framework">
<span id="pipeline-infrastructure-utils-framework-module"></span><h2>pipeline.infrastructure.utils.framework module<a class="headerlink" href="#module-pipeline.infrastructure.utils.framework" title="Link to this heading"></a></h2>
<p>The framework module contains:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>utility functions used by the pipeline framework;</p></li>
<li><p>utility functions used by pipeline tasks to help process framework
objects (Results, CalLibrary objects, etc.).</p></li>
</ol>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.framework.collect_properties">
<span class="sig-name descname"><span class="pre">collect_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/framework.html#collect_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.framework.collect_properties" title="Link to this definition"></a></dt>
<dd><p>Return the public properties of an object as a dictionary</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.framework.contains_single_dish">
<span class="sig-name descname"><span class="pre">contains_single_dish</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/framework.html#contains_single_dish"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.framework.contains_single_dish" title="Link to this definition"></a></dt>
<dd><p>Return True if the context contains single-dish data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>context</strong> – the pipeline context</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if SD data is present</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.framework.flatten_dict">
<span class="sig-name descname"><span class="pre">flatten_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">join=&lt;built-in</span> <span class="pre">function</span> <span class="pre">add&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lift=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/framework.html#flatten_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.framework.flatten_dict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.framework.gen_hash">
<span class="sig-name descname"><span class="pre">gen_hash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">o</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/framework.html#gen_hash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.framework.gen_hash" title="Link to this definition"></a></dt>
<dd><p>Makes a hash from a dictionary, list, tuple or set to any level, that
contains only other hashable types (including any lists, tuples, sets,
and dictionaries).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.framework.get_calfroms">
<span class="sig-name descname"><span class="pre">get_calfroms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caltypes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/framework.html#get_calfroms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.framework.get_calfroms" title="Link to this definition"></a></dt>
<dd><p>Get the CalFroms of the requested type from the callibrary.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.framework.get_origin_input_arg">
<span class="sig-name descname"><span class="pre">get_origin_input_arg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calapp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/framework.html#get_origin_input_arg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.framework.get_origin_input_arg" title="Link to this definition"></a></dt>
<dd><p>Get a single-valued task input argument from a CalApp.</p>
<p>If more than one value is present, for instance, asking for solint
when the originating jobs have different solint arguments, an
assertion error will be raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>calapp</strong> (<a class="reference internal" href="pipeline.infrastructure.html#pipeline.infrastructure.callibrary.CalApplication" title="pipeline.infrastructure.callibrary.CalApplication"><em>callibrary.CalApplication</em></a>) – CalApplication to inspect</p></li>
<li><p><strong>attr</strong> (<em>str</em>) – name of input argument</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.framework.get_qascores">
<span class="sig-name descname"><span class="pre">get_qascores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/framework.html#get_qascores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.framework.get_qascores" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.framework.get_tracebacks">
<span class="sig-name descname"><span class="pre">get_tracebacks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/framework.html#get_tracebacks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.framework.get_tracebacks" title="Link to this definition"></a></dt>
<dd><p>Get the tracebacks for the result, from any failures that may have
occurred during the task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>result</strong> – a result or result list.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of tracebacks as strings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.framework.is_top_level_task">
<span class="sig-name descname"><span class="pre">is_top_level_task</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/framework.html#is_top_level_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.framework.is_top_level_task" title="Link to this definition"></a></dt>
<dd><p>Return True if the callee if executing as part of a top-level task.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.framework.merge_jobs">
<span class="sig-name descname"><span class="pre">merge_jobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/framework.html#merge_jobs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.framework.merge_jobs" title="Link to this definition"></a></dt>
<dd><p>Merge jobs that are identical apart from the arguments named in
ignore. These jobs will be recreated with</p>
<p>Identical tasks are identified by creating a hash of the dictionary
of task keyword arguments, ignoring keywords specified in the
‘ignore’ argument. Jobs with the same hash can be merged; this is done
by appending the spw argument of job X to the spw argument of memoed
job Y, whereafter job X can be discarded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jobs</strong> (a list of        <a class="reference internal" href="pipeline.infrastructure.html#pipeline.infrastructure.jobrequest.JobRequest" title="pipeline.infrastructure.jobrequest.JobRequest"><code class="xref py py-class docutils literal notranslate"><span class="pre">JobRequest</span></code></a>) – the job requests to merge</p></li>
<li><p><strong>task</strong> (a reference to a function on         :class:<a href="#id1"><span class="problematic" id="id2">`</span></a>~pipeline.infrastructure.jobrequest.casa_tasks’) – the CASA task to recreate</p></li>
<li><p><strong>ignore</strong> (<em>an iterable containing strings</em>) – the task arguments to ignore during hash creation</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of         <a class="reference internal" href="pipeline.infrastructure.html#pipeline.infrastructure.jobrequest.JobRequest" title="pipeline.infrastructure.jobrequest.JobRequest"><code class="xref py py-class docutils literal notranslate"><span class="pre">JobRequest</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.framework.mkdir_p">
<span class="sig-name descname"><span class="pre">mkdir_p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/framework.html#mkdir_p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.framework.mkdir_p" title="Link to this definition"></a></dt>
<dd><p>Emulate mkdir -p functionality.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.framework.pickle_copy">
<span class="sig-name descname"><span class="pre">pickle_copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/framework.html#pickle_copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.framework.pickle_copy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.framework.pickle_load">
<span class="sig-name descname"><span class="pre">pickle_load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fileobj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/framework.html#pickle_load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.framework.pickle_load" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.framework.plotms_iterate">
<span class="sig-name descname"><span class="pre">plotms_iterate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jobs_and_wrappers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="pipeline.infrastructure.html#pipeline.infrastructure.jobrequest.JobRequest" title="pipeline.infrastructure.jobrequest.JobRequest"><span class="pre">JobRequest</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="pipeline.infrastructure.renderer.html#pipeline.infrastructure.renderer.logger.Plot" title="pipeline.infrastructure.renderer.logger.Plot"><span class="pre">Plot</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteraxis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">singledish</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="pipeline.infrastructure.renderer.html#pipeline.infrastructure.renderer.logger.Plot" title="pipeline.infrastructure.renderer.logger.Plot"><span class="pre">Plot</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/framework.html#plotms_iterate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.framework.plotms_iterate" title="Link to this definition"></a></dt>
<dd><p>Iterate multiple plotms job requests</p>
<p>Iterate multiple plotms job requests
:Parameters: * <strong>jobs_and_wrappers</strong> – JobRequest and Plot</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>iteraxis</strong> – iteraxis parameter for plotms</p></li>
<li><p><strong>singledish</strong> – True for singledish (adds &amp;&amp;&amp; to ‘antenna’)
False for others (default, ‘antenna’ remains unchanged )</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of plots</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.framework.task_depth">
<span class="sig-name descname"><span class="pre">task_depth</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/framework.html#task_depth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.framework.task_depth" title="Link to this definition"></a></dt>
<dd><p>Get the number of executing tasks currently on the stack. If the depth is
1, the calling function is the top-level task.</p>
</dd></dl>

</section>
<section id="module-pipeline.infrastructure.utils.imaging">
<span id="pipeline-infrastructure-utils-imaging-module"></span><h2>pipeline.infrastructure.utils.imaging module<a class="headerlink" href="#module-pipeline.infrastructure.utils.imaging" title="Link to this heading"></a></h2>
<p>The imaging module contains utility functions used by the imaging tasks.</p>
<p>TODO These utility functions should migrate to hif.tasks.common</p>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.imaging.chan_selection_to_frequencies">
<span class="sig-name descname"><span class="pre">chan_selection_to_frequencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'GHz'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/imaging.html#chan_selection_to_frequencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.imaging.chan_selection_to_frequencies" title="Link to this definition"></a></dt>
<dd><p>Convert channel selection to frequency tuples for a given CASA cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> – CASA cube name</p></li>
<li><p><strong>selection</strong> – Channel selection string using CASA selection syntax</p></li>
<li><p><strong>unit</strong> – Frequency unit</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of pairs of frequency values (float) in the desired units</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.imaging.equal_to_n_digits">
<span class="sig-name descname"><span class="pre">equal_to_n_digits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numdigits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/imaging.html#equal_to_n_digits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.imaging.equal_to_n_digits" title="Link to this definition"></a></dt>
<dd><p>Approximate equality check up to a given number of digits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – First floating point number</p></li>
<li><p><strong>y</strong> – Second floating point number</p></li>
<li><p><strong>numdigits</strong> – Number of digits to check</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.imaging.freq_selection_to_channels">
<span class="sig-name descname"><span class="pre">freq_selection_to_channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/imaging.html#freq_selection_to_channels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.imaging.freq_selection_to_channels" title="Link to this definition"></a></dt>
<dd><p>Convert frequency selection to channel tuples for a given CASA cube.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> – CASA cube name</p></li>
<li><p><strong>selection</strong> – Frequency selection string using CASA syntax</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of pairs of channel values (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.imaging.frequency_to_velocity">
<span class="sig-name descname"><span class="pre">frequency_to_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restfreq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/imaging.html#frequency_to_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.imaging.frequency_to_velocity" title="Link to this definition"></a></dt>
<dd><p>Convert frequency to radial velocity using radio convention.</p>
<p>v = c * (f_rest - f) / f_rest</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frequency</strong> – frequency quantity</p></li>
<li><p><strong>restfreq</strong> – rest frequency quantity</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Velocity quantity in units of km/s</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.imaging.intersect_ranges">
<span class="sig-name descname"><span class="pre">intersect_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ranges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/imaging.html#intersect_ranges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.imaging.intersect_ranges" title="Link to this definition"></a></dt>
<dd><p>Compute intersection of ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ranges</strong> – List of tuples defining (frequency) intervals</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of two numbers defining the intersection</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>intersect_range</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.imaging.intersect_ranges_by_weight">
<span class="sig-name descname"><span class="pre">intersect_ranges_by_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ranges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/imaging.html#intersect_ranges_by_weight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.imaging.intersect_ranges_by_weight" title="Link to this definition"></a></dt>
<dd><p>Compute intersection of ranges through weight arrays and a threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ranges</strong> – List of tuples defining frequency intervals</p></li>
<li><p><strong>delta</strong> – Frequency step to be used for the intersection</p></li>
<li><p><strong>threshold</strong> – Threshold to be used for the intersection</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of two numbers defining the intersection</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>intersect_range</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.imaging.merge_ranges">
<span class="sig-name descname"><span class="pre">merge_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ranges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Generator</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/imaging.html#merge_ranges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.imaging.merge_ranges" title="Link to this definition"></a></dt>
<dd><p>Merge overlapping and adjacent ranges and yield the merged ranges
in order. The argument must be an iterable of pairs (start, stop).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ranges</strong> – List of tuples of two numbers defining ranges</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generator yielding tuples of merged ranges</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">merge_ranges</span><span class="p">([(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)]))</span>
<span class="go">[(-1, 7)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">merge_ranges</span><span class="p">([(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)]))</span>
<span class="go">[(1, 2), (3, 4), (5, 6)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">merge_ranges</span><span class="p">([]))</span>
<span class="go">[]</span>
</pre></div>
</div>
<ol class="loweralpha simple" start="3">
<li><p>Gareth Rees 02/2013</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.imaging.predict_kernel">
<span class="sig-name descname"><span class="pre">predict_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_beam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pstol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/imaging.html#predict_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.imaging.predict_kernel" title="Link to this definition"></a></dt>
<dd><p>Predict the required convolution kernel to each a target restoring beam.</p>
<p>pstol: the tolerance in arcsec for original vs. target bmaj/bmin identical or kernel “point source” like.
patol: the tolerance in degree for original vs. target bpa identical</p>
<dl class="simple">
<dt>return_code:</dt><dd><p>0:  sucess, the target beam can be reached with a valid convolution kernel
1:  fail, “point source” like
2:  fail, unable to reach the target beam shape, and the original beam is probably already too large in a certain direction.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although ia.deconvolvefrombeam() can also predict convolution kernel sizes, its return can be misleading
in some circumstances (see CAS-13804). Therefore, we use ia.beamforconvolvedsize() here even though we have to catch the CASA runtime error messages.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.imaging.set_nested_dict">
<span class="sig-name descname"><span class="pre">set_nested_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dct</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/imaging.html#set_nested_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.imaging.set_nested_dict" title="Link to this definition"></a></dt>
<dd><p>Set a hierarchy of dictionaries with given keys and value
for the lowest level key.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_nested_dict</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">,</span> <span class="s1">&#39;key3&#39;</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">{&#39;key1&#39;: {&#39;key2&#39;: {&#39;key3&#39;: 1}}}</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dct</strong> – Any dictionary</p></li>
<li><p><strong>keys</strong> – List of keys to build hierarchy</p></li>
<li><p><strong>value</strong> – Value for lowest level key</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. The dictionary is modified in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.imaging.spw_intersect">
<span class="sig-name descname"><span class="pre">spw_intersect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spw_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_regions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/imaging.html#spw_intersect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.imaging.spw_intersect" title="Link to this definition"></a></dt>
<dd><p>This utility function takes a frequency range (as numbers with arbitrary
but common units) and computes the intersection with a list of frequency
ranges defining the regions of spectral lines. It returns the remaining
ranges excluding the line frequency ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spw_range</strong> – List of two numbers defining the spw frequency range</p></li>
<li><p><strong>line_regions</strong> – List of lists of pairs of numbers defining frequency ranges
to be excluded</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of lists of pairs of numbers defining the remaining frequency ranges</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.imaging.update_beams_dict">
<span class="sig-name descname"><span class="pre">update_beams_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dct</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">udct</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/imaging.html#update_beams_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.imaging.update_beams_dict" title="Link to this definition"></a></dt>
<dd><p>Update a beams dictionary. All generic solutions
tried so far did not do the job. So this method assumes
an explicit dictionary structure of
[‘&lt;field name’][‘&lt;intent&gt;’][&lt;spwids&gt;]: {&lt;beam&gt;}.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dct</strong> – Beams dictionary</p></li>
<li><p><strong>udct</strong> – Beams update dictionary</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. The main dictionary is modified in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.imaging.update_sens_dict">
<span class="sig-name descname"><span class="pre">update_sens_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dct</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">udct</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/imaging.html#update_sens_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.imaging.update_sens_dict" title="Link to this definition"></a></dt>
<dd><p>Update a sensitivity dictionary. All generic solutions
tried so far did not do the job. So this method assumes
an explicit dictionary structure of
[‘&lt;MS name&gt;’][‘&lt;field name’][‘&lt;intent&gt;’][&lt;spw&gt;]: {&lt;sensitivity result&gt;}.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dct</strong> – Sensitivities dictionary</p></li>
<li><p><strong>udct</strong> – Sensitivities update dictionary</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. The main dictionary is modified in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.imaging.velocity_to_frequency">
<span class="sig-name descname"><span class="pre">velocity_to_frequency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">velocity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restfreq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/imaging.html#velocity_to_frequency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.imaging.velocity_to_frequency" title="Link to this definition"></a></dt>
<dd><p>Convert radial velocity to frequency using radio convention.</p>
<p>f = f_rest * (1 - v/c)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>velocity</strong> – velocity quantity</p></li>
<li><p><strong>restfreq</strong> – rest frequency quantity</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Frequency quantity in units of restfreq</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="pipeline-infrastructure-utils-imaging-test-module">
<h2>pipeline.infrastructure.utils.imaging_test module<a class="headerlink" href="#pipeline-infrastructure-utils-imaging-test-module" title="Link to this heading"></a></h2>
</section>
<section id="module-pipeline.infrastructure.utils.math">
<span id="pipeline-infrastructure-utils-math-module"></span><h2>pipeline.infrastructure.utils.math module<a class="headerlink" href="#module-pipeline.infrastructure.utils.math" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.math.round_half_up">
<span class="sig-name descname"><span class="pre">round_half_up</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/math.html#round_half_up"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.math.round_half_up" title="Link to this definition"></a></dt>
<dd><p>Provides the “round to nearest integer with ties going away from zero”
behaviour that was the default Python2 rounding behavior.</p>
<p>The behaviour of the “round” built-in changed from Python 2 to Python 3.</p>
<p>In Python 2, round() was rounding to the nearest integer, with ties going
away from 0. For example:</p>
<p>[round(a) for a in [-2.5, -1.5, -0.5, 0.5, 1.5, 2.5]] == [-3.0, -2.0, -1.0, 1.0, 2.0, 3.0]</p>
<p>In Python 3, round() become “Banker’s rounding”, rounding to the nearest
even integer, following the IEEE 754 standard for floating-point arithmetic.
For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">]]</span>
<span class="go">[-2, -2, 0, 0, 2, 2]</span>
</pre></div>
</div>
<p>Note: in this function and the underlying Python decimal module,
“round half up” refers to “round half away from zero” behaviour, rather than
rounding half up to positive infinity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> – Un-rounded value</p></li>
<li><p><strong>precision</strong> – Precision of un-rounded value to consider when rounding</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>rounded value to nearest integer with ties going away from 0</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.math.round_up">
<span class="sig-name descname"><span class="pre">round_up</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/math.html#round_up"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.math.round_up" title="Link to this definition"></a></dt>
<dd><p>Round to nearest integer away from zero.</p>
<p>Example:
&gt;&gt;&gt; [round_up(a) for a in [-1.5, -1.1, -0.5, 0.5, 1.1, 1.5]]
[-2.0, -2.0, -1.0, 1.0, 2.0, 2.0]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> – Un-rounded value</p></li>
<li><p><strong>precision</strong> – Precision of un-rounded value to consider when rounding</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>rounded value to nearest integer away from 0</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="pipeline-infrastructure-utils-math-test-module">
<h2>pipeline.infrastructure.utils.math_test module<a class="headerlink" href="#pipeline-infrastructure-utils-math-test-module" title="Link to this heading"></a></h2>
</section>
<section id="module-pipeline.infrastructure.utils.positioncorrection">
<span id="pipeline-infrastructure-utils-positioncorrection-module"></span><h2>pipeline.infrastructure.utils.positioncorrection module<a class="headerlink" href="#module-pipeline.infrastructure.utils.positioncorrection" title="Link to this heading"></a></h2>
<p>Utilities used for correcting image center coordinates.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.positioncorrection.do_wide_field_pos_cor">
<span class="sig-name descname"><span class="pre">do_wide_field_pos_cor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitsname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_long</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/positioncorrection.html#do_wide_field_pos_cor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.positioncorrection.do_wide_field_pos_cor" title="Link to this definition"></a></dt>
<dd><p>Applies mean wide field position correction to FITS WCS in place.</p>
<p>Apply a mean correction to the FITS WCS reference position as a function
of mean hour angle of observation and mean declination (see PIPE-587,
PIPE-700, SRDP-412, and VLASS Memo #14).</p>
<p>The correction is intended for VLASS-QL images. It is performed as part of
the hifv_exportvlassdata task call in the VLASS-QL pipeline run. It can also
be executed outside of the pipeline.</p>
<p>CRVAL1, CUNIT1, CRVAL2, CUNIT2 and HISTORY keywords are updated <em>in place</em>
in the input FITS image header.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul>
<li><p><strong>fitsname</strong> – name (and path) of FITS file to be processed.</p></li>
<li><p><strong>date_time</strong> – Mean date and time of observation in casa_tools.measure.epoch
format, if None use DATE-OBS FITS header value.
e.g. {‘m0’: {‘unit’: ‘d’, ‘value’: 58089.83550347222},</p>
<blockquote>
<div><p>‘refer’: ‘UTC’, ‘type’: ‘epoch’}</p>
</div></blockquote>
</li>
<li><p><strong>obs_long</strong> – Geographic longitude of observatory, casa_tools.quanta.quantity
format. If None, then use VLA coordinate.
e.g. {‘value’: -107.6, ‘unit’: ‘deg’}.</p></li>
<li><p><strong>obs_lat</strong> – Geographic latitude of observatory, casa_tools.quanta.quantity
format. If None, then use VLA coordinate.
e.g. {‘value’: 34.1, ‘unit’: ‘deg’}.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>file = “VLASS1.1.ql.T19t20.J155950+333000.10.2048.v1.I.iter1.image.pbcor.tt0.subim.fits”
# Mean time of observation
datetime = pipeline.infrastructure.casa_tools.measures.epoch(‘utc’, ‘2017-12-02T20:03:07.500’)
# VLA coordinates
obslong = {‘unit’:’deg’,’value’:-107.6}
obslat = {‘unit’:’deg’,’value’:34.1}
# Correct reference positions in fits header
do_wide_field_pos_cor(file, date_time=datetime, obs_long=obslong, obs_lat=obslat)</p>
</dd></dl>

</section>
<section id="pipeline-infrastructure-utils-positioncorrection-test-module">
<h2>pipeline.infrastructure.utils.positioncorrection_test module<a class="headerlink" href="#pipeline-infrastructure-utils-positioncorrection-test-module" title="Link to this heading"></a></h2>
</section>
<section id="module-pipeline.infrastructure.utils.ppr">
<span id="pipeline-infrastructure-utils-ppr-module"></span><h2>pipeline.infrastructure.utils.ppr module<a class="headerlink" href="#module-pipeline.infrastructure.utils.ppr" title="Link to this heading"></a></h2>
<p>The ppr module contains utility functions useful to PPR processing functions.</p>
<p>TODO There is a lot of duplication between executeppr and vlaexecuteppr. Can
this module be eliminated if a common PPR base class was created?</p>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.ppr.check_ppr">
<span class="sig-name descname"><span class="pre">check_ppr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pprfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/ppr.html#check_ppr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.ppr.check_ppr" title="Link to this definition"></a></dt>
<dd><p>Check PPR to make sure all tasks exist in the CASA task dictionary.</p>
<p>Compares the &lt;Command&gt; elements of the PPR to the keys of
the CASA task dictionary.  This is useful as a quick sanity check
before executing the pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pprfile</strong> – A path to the PPR file (string).
e.g. ‘PPR_VLAT003.xml’ or ‘mydata/working/PPR_VLAT003.xml’</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>False on error.
True  on success.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.ppr.write_errorexit_file">
<span class="sig-name descname"><span class="pre">write_errorexit_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extension</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/ppr.html#write_errorexit_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.ppr.write_errorexit_file" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="pipeline-infrastructure-utils-regression-tester-module">
<h2>pipeline.infrastructure.utils.regression_tester module<a class="headerlink" href="#pipeline-infrastructure-utils-regression-tester-module" title="Link to this heading"></a></h2>
</section>
<section id="module-pipeline.infrastructure.utils.sorting">
<span id="pipeline-infrastructure-utils-sorting-module"></span><h2>pipeline.infrastructure.utils.sorting module<a class="headerlink" href="#module-pipeline.infrastructure.utils.sorting" title="Link to this heading"></a></h2>
<p>The sorting module contains utility functions used to sort pipeline input and
output.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.sorting.natural_sort">
<span class="sig-name descname"><span class="pre">natural_sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/sorting.html#natural_sort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.sorting.natural_sort" title="Link to this definition"></a></dt>
<dd><p>Sort a list in natural order, eg.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">natural_sort</span><span class="p">([</span><span class="s2">&quot;session10&quot;</span><span class="p">,</span> <span class="s2">&quot;session10a&quot;</span><span class="p">,</span> <span class="s2">&quot;session9&quot;</span><span class="p">,</span> <span class="s2">&quot;session1&quot;</span><span class="p">])</span>
<span class="go">[&#39;session1&#39;, &#39;session9&#39;, &#39;session10&#39;, &#39;session10a&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.sorting.natural_sort_key">
<span class="sig-name descname"><span class="pre">natural_sort_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_nsre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">re.compile('([0-9]+)')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/sorting.html#natural_sort_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.sorting.natural_sort_key" title="Link to this definition"></a></dt>
<dd><p>Key to order in natural order with the sort function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.sorting.numeric_sort">
<span class="sig-name descname"><span class="pre">numeric_sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/sorting.html#numeric_sort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.sorting.numeric_sort" title="Link to this definition"></a></dt>
<dd><p>Sort a list numerically, eg.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">numeric_sort</span><span class="p">([</span><span class="s1">&#39;9,11,13,15&#39;</span><span class="p">,</span> <span class="s1">&#39;11,13&#39;</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">])</span>
<span class="go">[&#39;9&#39;, &#39;9,11,13,15&#39;, &#39;11,13&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.sorting.numeric_sort_key">
<span class="sig-name descname"><span class="pre">numeric_sort_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_nsre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">re.compile('([0-9]+)')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/sorting.html#numeric_sort_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.sorting.numeric_sort_key" title="Link to this definition"></a></dt>
<dd><p>Key to order in numeric order with the sort function.
Split a string by numbers.</p>
</dd></dl>

</section>
<section id="pipeline-infrastructure-utils-sorting-test-module">
<h2>pipeline.infrastructure.utils.sorting_test module<a class="headerlink" href="#pipeline-infrastructure-utils-sorting-test-module" title="Link to this heading"></a></h2>
</section>
<section id="module-pipeline.infrastructure.utils.utils">
<span id="pipeline-infrastructure-utils-utils-module"></span><h2>pipeline.infrastructure.utils.utils module<a class="headerlink" href="#module-pipeline.infrastructure.utils.utils" title="Link to this heading"></a></h2>
<p>The utils module contains general-purpose uncategorised utility functions and
classes.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.absolute_path">
<span class="sig-name descname"><span class="pre">absolute_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#absolute_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.absolute_path" title="Link to this definition"></a></dt>
<dd><p>Return an absolute path of a given file.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.approx_equal">
<span class="sig-name descname"><span class="pre">approx_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-15</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#approx_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.approx_equal" title="Link to this definition"></a></dt>
<dd><p>Return True if two numbers are equal within the given tolerance.</p>
<p>This utility function returns True if two numbers are equal within the
given tolerance.</p>
<p>Examples:
&gt;&gt;&gt; approx_equal(1.0e-2, 1.2e-2, 1e-2)
True
&gt;&gt;&gt; approx_equal(1.0e-2, 1.2e-2, 1e-3)
False</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.are_equal">
<span class="sig-name descname"><span class="pre">are_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#are_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.are_equal" title="Link to this definition"></a></dt>
<dd><p>Return True if the contents of the given arrays are equal.</p>
<p>This utility function check the equivalence of array like objects. Two arrays
are equal if they have the same number of elements and elements of the same
index are equal.</p>
<p>Examples:
&gt;&gt;&gt; are_equal([1, 2, 3], [1, 2, 3])
True
&gt;&gt;&gt; are_equal([1, 2, 3], [1, 2, 3, 4])
False</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.deduplicate">
<span class="sig-name descname"><span class="pre">deduplicate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#deduplicate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.deduplicate" title="Link to this definition"></a></dt>
<dd><p>Remove duplicate entries from a list, but preserve the order.</p>
<p>Note that the use of list(set(x)) can cause random order in the output.
The return of this function is guaranteed to be in the order that unique items show up in the input, unlike
a deduplicate-resorting solution like sorted(set(x).
Ref: <a class="reference external" href="https://stackoverflow.com/questions/480214/how-do-i-remove-duplicates-from-a-list-while-preserving-order">https://stackoverflow.com/questions/480214/how-do-i-remove-duplicates-from-a-list-while-preserving-order</a>
This solution only works for Python 3.7+.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.dict_merge">
<span class="sig-name descname"><span class="pre">dict_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#dict_merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.dict_merge" title="Link to this definition"></a></dt>
<dd><p>Recursively merge dictionaries.</p>
<p>This utility function recursively merges dictionaries. If second argument
(b) is a dictionary, then a copy of first argument (dictionary a) is created
and the elements of b are merged into the new dictionary. Otherwise return
argument b.</p>
<p>Examples:
&gt;&gt;&gt; dict_merge({‘a’: {‘b’: 1}}, {‘c’: 2})
{‘a’: {‘b’: 1}, ‘c’: 2}</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.ensure_products_dir_exists">
<span class="sig-name descname"><span class="pre">ensure_products_dir_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">products_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#ensure_products_dir_exists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.ensure_products_dir_exists" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.export_weblog_as_tar">
<span class="sig-name descname"><span class="pre">export_weblog_as_tar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">products_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_builder</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#export_weblog_as_tar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.export_weblog_as_tar" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.fieldname_for_casa">
<span class="sig-name descname"><span class="pre">fieldname_for_casa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#fieldname_for_casa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.fieldname_for_casa" title="Link to this definition"></a></dt>
<dd><p>Prepare field string to be used as CASA argument.</p>
<p>This utility function ensures that field string can be used as CASA argument.</p>
<p>If field contains special characters, then return field string enclose in
quotation marks, otherwise return unchanged string.</p>
<p>Examples:
&gt;&gt;&gt; fieldname_for_casa(‘helm=30’)
‘“helm=30”’</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.find_ranges">
<span class="sig-name descname"><span class="pre">find_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#find_ranges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.find_ranges" title="Link to this definition"></a></dt>
<dd><p>Identify numeric ranges in string or list.</p>
<p>This utility function takes a string or a list of integers (e.g. spectral
window lists) and returns a string containing identified ranges.</p>
<p>Examples:
&gt;&gt;&gt; find_ranges([1,2,3])
‘1~3’
&gt;&gt;&gt; find_ranges(‘1,2,3,5~12’)
‘1~3,5~12’</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.flagged_intervals">
<span class="sig-name descname"><span class="pre">flagged_intervals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#flagged_intervals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.flagged_intervals" title="Link to this definition"></a></dt>
<dd><p>Idendity isnads of ones in input array or list.</p>
<p>This utility function finds islands of ones in array or list provided in argument.
Used to find contiguous flagged channels in a given spw.  Returns a list of
tuples with the start and end channels.</p>
<p>Examples:
&gt;&gt;&gt; flagged_intervals([0, 1, 0, 1, 1])
[(1, 1), (3, 4)]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.get_casa_quantity">
<span class="sig-name descname"><span class="pre">get_casa_quantity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#get_casa_quantity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.get_casa_quantity" title="Link to this definition"></a></dt>
<dd><p>Wrapper around quanta.quantity() that handles None input.</p>
<p>Starting with CASA 6, quanta.quantity() no longer accepts None as input. This
utility function handles None values when calling CASA quanta.quantity() tool
method.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A CASA quanta.quantity (dictionary)</p>
</dd>
</dl>
<p>Examples:
&gt;&gt;&gt; get_casa_quantity(None)
{‘unit’: ‘’, ‘value’: 0.0}
&gt;&gt;&gt; get_casa_quantity(‘10klambda’)
{‘unit’: ‘klambda’, ‘value’: 10.0}</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.get_casa_session_details">
<span class="sig-name descname"><span class="pre">get_casa_session_details</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#get_casa_session_details"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.get_casa_session_details" title="Link to this definition"></a></dt>
<dd><p>Get the current CASA session details.</p>
<dl>
<dt>return a dictionary including the following keys:</dt><dd><p>casa_dir: the root directory of the monolithic CASA distribution.
omp_num_threads: the number of OpenMP threads in the current parallel region.
data_path: CASA data paths in-use.
numa_mem: memory properties from the NUMA software perspective.
numa_cpu: cpu properties from the NUMA software perspective.</p>
<blockquote>
<div><p>The above CPU/mem properties might be different from the hardware specs obtained from
standard Python functions (e.g. os.cpu_count()) or pipeline.environment.
On the difference between the “software” and hardware nodes, see</p>
<blockquote>
<div><p><a class="reference external" href="https://www.kernel.org/doc/html/latest/vm/numa.html">https://www.kernel.org/doc/html/latest/vm/numa.html</a></p>
</div></blockquote>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.get_field_identifiers">
<span class="sig-name descname"><span class="pre">get_field_identifiers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ms</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#get_field_identifiers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.get_field_identifiers" title="Link to this definition"></a></dt>
<dd><p>Maps numeric field IDs to field names.</p>
<p>Get a dict of numeric field ID to unambiguous field identifier, using the
field name where possible and falling back to numeric field ID where the
name is duplicated, for instance in mosaic pointings.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.get_num_caltable_polarizations">
<span class="sig-name descname"><span class="pre">get_num_caltable_polarizations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">caltable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#get_num_caltable_polarizations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.get_num_caltable_polarizations" title="Link to this definition"></a></dt>
<dd><p>Obtain number of polarisations from calibration table.</p>
<p>Seemingly the number of QA ID does not map directly to the number of
polarisations for the spw in the MS, but the number of polarisations for
the spw as held in the caltable.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.get_obj_size">
<span class="sig-name descname"><span class="pre">get_obj_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">serialize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#get_obj_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.get_obj_size" title="Link to this definition"></a></dt>
<dd><p>Estimate the size of a Python object.</p>
<p>If serialize=True, the size of a serialized object is returned. Note that this is NOT the
same as the object size in memory.</p>
<p>When serialize=False, the memory consumption of the object is returned via
the asizeof method of Pympler.:</p>
<blockquote>
<div><p>pympler.asizeof.asizeof(obj) # <a class="reference external" href="https://pypi.org/project/Pympler">https://pypi.org/project/Pympler</a></p>
</div></blockquote>
<dl class="simple">
<dt>An alternative is the get_deep_size() function from objsize.</dt><dd><p>objsize.get_deep_size(obj)   # <a class="reference external" href="https://pypi.org/project/objsize">https://pypi.org/project/objsize</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.get_products_dir">
<span class="sig-name descname"><span class="pre">get_products_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#get_products_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.get_products_dir" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.get_receiver_type_for_spws">
<span class="sig-name descname"><span class="pre">get_receiver_type_for_spws</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spwids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#get_receiver_type_for_spws"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.get_receiver_type_for_spws" title="Link to this definition"></a></dt>
<dd><p>Return dictionary of receiver types for requested spectral window IDs.</p>
<p>If spwid is not found in MeasurementSet instance, then detector type is
set to “N/A”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ms</strong> – MeasurementSet to query for receiver types.</p></li>
<li><p><strong>spwids</strong> – list of spw ids (integers) to query for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary assigning receiver types as values to spwid keys.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.get_si_prefix">
<span class="sig-name descname"><span class="pre">get_si_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lztol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#get_si_prefix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.get_si_prefix" title="Link to this definition"></a></dt>
<dd><p>Obtain the best SI unit prefix option for a numeric value.</p>
<dl class="simple">
<dt>A “best” SI prefix from a specified prefix collection is defined by minimizing :</dt><dd><ul class="simple">
<li><p>leading zeros (possibly to a specified tolerance limit, see <cite>lztol</cite>)</p></li>
<li><p>significant digits before the decimal point</p></li>
</ul>
</dd>
</dl>
<p>, after the prefix is applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>float</em>) – the numerical value for picking the prefix.</p></li>
<li><p><strong>select</strong> (<em>str, optional</em>) – SI prefix candidates, a substring of “yzafpnum kMGTPEZY”).
Defaults to ‘mu’.</p></li>
<li><p><strong>lztol</strong> (<em>int, optional</em>) – leading zeros tolerance.
Defaults to 0 (avoid any leading zeros when possible).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(prefix_string, prefix_scale)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p>Examples:</p>
<p>e.g. for frequency value in Hz
&gt;&gt;&gt; get_si_prefix(10**7,select=’kMGT’)
(‘M’, 1000000.0)</p>
<p>e.g. for flux value in Jy
&gt;&gt;&gt; get_si_prefix(1.0,select=’um’)
(‘’, 1.0)
&gt;&gt;&gt; get_si_prefix(0.0,select=’um’)
(‘’, 1.0)
&gt;&gt;&gt; get_si_prefix(-0.9,select=’um’)
(‘m’, 0.001)
&gt;&gt;&gt; get_si_prefix(0.9,select=’um’,lztol=1)
(‘’, 1.0)
&gt;&gt;&gt; get_si_prefix(1e-7,select=’um’)
(‘u’, 1e-06)
&gt;&gt;&gt; get_si_prefix(1e3,select=’um’)
(‘’, 1.0)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.get_spectralspec_to_spwid_map">
<span class="sig-name descname"><span class="pre">get_spectralspec_to_spwid_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spws</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Collection</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#get_spectralspec_to_spwid_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.get_spectralspec_to_spwid_map" title="Link to this definition"></a></dt>
<dd><p>Returns a dictionary of spectral specs mapped to corresponding spectral
window IDs for requested list of spectral window objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>spws</strong> – list of spectral window objects</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dictionary with spectral spec as keys, and corresponding</p>
</dd>
</dl>
<p>list of spectral window IDs as values.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.get_stokes">
<span class="sig-name descname"><span class="pre">get_stokes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imagename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#get_stokes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.get_stokes" title="Link to this definition"></a></dt>
<dd><p>Get the labels of all stokes planes present in a CASA image.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.get_task_result_count">
<span class="sig-name descname"><span class="pre">get_task_result_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taskname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'hif_makeimages'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#get_task_result_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.get_task_result_count" title="Link to this definition"></a></dt>
<dd><p>Count occurrences of a task result in the context.results list.</p>
<p>Loop over the content of the context.results list and compare taskname to the pipeline_casa_task
attribute of each result object. Increase counter if taskname substring is found in the attribute.</p>
<p>The order number is determined by counting the number of previous execution of
the task, based on the content of the context.results list. The introduction
of this method is necessary because VLASS-SE-CONT imaging happens in multiple
stages (hif_makeimages calls). Imaging parameters change from stage to stage,
therefore it is necessary to know what is the current stage ordinal number.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.get_taskhistory_fromimage">
<span class="sig-name descname"><span class="pre">get_taskhistory_fromimage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imagename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#get_taskhistory_fromimage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.get_taskhistory_fromimage" title="Link to this definition"></a></dt>
<dd><p>Retrieve past CASA/tclean() call parameters from the image history.</p>
<p>Note: the tclean history is only added to images/logtable in CASA ver&gt;=6.2 (see CAS-13247)
For tclean products generated by earlier CASA versions, an empty list will be returned.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.glob_ordered">
<span class="sig-name descname"><span class="pre">glob_ordered</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#glob_ordered"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.glob_ordered" title="Link to this definition"></a></dt>
<dd><p>Return a sorted list of paths matching a pathname pattern.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.ignore_pointing">
<span class="sig-name descname"><span class="pre">ignore_pointing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#ignore_pointing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.ignore_pointing" title="Link to this definition"></a></dt>
<dd><p>A context manager to ignore pointing tables of MSes during I/O operations.</p>
<p>The original pointing table will be temperarily renamed to POINTING_ORIGIN, and a new empty pointing table
is created. When the context manager exits, the original table is restored.</p>
<p>For example, to ignore the pointing table of a MS during mstransform() calls, use:</p>
<blockquote>
<div><dl class="simple">
<dt>with ignore_pointing(‘test.ms’):</dt><dd><p>casatasks.mstransform(vis=’test.ms’,outputvis=’test_output.ms’,scan=’16’,datacolumn=’data’)</p>
</dd>
</dl>
</div></blockquote>
<p>The pointing table of the output MS should be empty.</p>
<p>On the other hand, if the pointing table is needed in the output vis, e.g. for imaging with tclean(usepointing=True),
we can manually create hardlinks of pointing table afterwards while minimizing the disk space usage:</p>
<blockquote>
<div><p>import shutil, os
shutil.rmtree(‘test_small.ms/POINTING’)
shutil.copytree(‘test.ms/POINTING’, ‘test_output.ms/POINTING’, copy_function=os.link)</p>
</div></blockquote>
<p>One can verify the inodes of the pointing table files, which should be the same:</p>
<blockquote>
<div><p>ls -lih test.ms/POINTING
ls -lih test_small.ms/POINTING</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.imstat_items">
<span class="sig-name descname"><span class="pre">imstat_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['min',</span> <span class="pre">'max']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#imstat_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.imstat_items" title="Link to this definition"></a></dt>
<dd><p>Extract desired stats properties (per Stokes) using ia.statistics().</p>
<p>Beside the standard output, some additional stats property keys are supported.
Note: ‘image’ is expected to an instance of CASA ia tool.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.list_to_str">
<span class="sig-name descname"><span class="pre">list_to_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">ScalarType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#list_to_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.list_to_str" title="Link to this definition"></a></dt>
<dd><p>Convert list or numpy.ndarray into string.</p>
<p>The list/ndarray should be 1-dimensional. In that case, the function
returns comma-separated sequence of its elements. Otherwise it just
returns default string representation of the value, str(value).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> – 1-dimensional list or numpy array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>String representation of the value. If input value is in
compliance with the requirement, it will be comma-separated
sequence of elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.nested_dict">
<span class="sig-name descname"><span class="pre">nested_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#nested_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.nested_dict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.open_with_lock">
<span class="sig-name descname"><span class="pre">open_with_lock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#open_with_lock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.open_with_lock" title="Link to this definition"></a></dt>
<dd><p>Open file with a lock.</p>
<p>The file open context manager function will try to lock the file upon opening
so other processes using the same “opener” will wait for the file to unlock.
The applied lock will be released when leaving the context.</p>
<p>Notes:</p>
<p>all file open calls with <cite>open_with_lock</cite> will block other <cite>open_with_lock</cite> usages
(even from different processes/lustre-clients) from read/write until the lock is released.
However, this locking/blocking mechanism will not prevent the file access (potentially
causing IO error) from other file openers (e.g. the default open() function).</p>
<dl class="simple">
<dt>Because the Python/fcntl API depends on the underlying OS/storage implementation:</dt><dd><p><a class="reference external" href="https://docs.python.org/3/library/fcntl.html">https://docs.python.org/3/library/fcntl.html</a></p>
</dd>
</dl>
<p>Not all OS/fsys is fully supported. For Lustre, it seems to depend on fsys mount <cite>-o flock</cite>
options, which is indeed used for cv/naasc/aoc lustre systems:</p>
<blockquote>
<div><dl class="simple">
<dt>$ mount -l | grep lustre</dt><dd><p><a class="reference external" href="mailto:192&#46;168&#46;1&#46;30&#37;&#52;&#48;o2ib">192<span>&#46;</span>168<span>&#46;</span>1<span>&#46;</span>30<span>&#64;</span>o2ib</a>:/aoclst03 on /.lustre/aoc type lustre (rw,flock,user_xattr,lazystatfs)</p>
</dd>
</dl>
</div></blockquote>
<p>For NFS, please see additional notes in PIPE-2051.</p>
<p>For a practical test, try the code snippet below from different clients/processes to see
if the fnctl blocking mechanism can prevent non-exclusive access to a file.</p>
<blockquote>
<div><p>import fcntl
fd=open(filename,’w’)
fcntl.flock(fd, fcntl.LOCK_EX | fcntl.LOCK_NB)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – the file name</p></li>
<li><p><strong>mode</strong> (<em>str, optional</em>) – open mode. Defaults to ‘r’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.place_repr_source_first">
<span class="sig-name descname"><span class="pre">place_repr_source_first</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">itemlist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repr_source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#place_repr_source_first"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.place_repr_source_first" title="Link to this definition"></a></dt>
<dd><p>Place representative source first in a list of source names
or tuples with source name as first tuple element.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.relative_path">
<span class="sig-name descname"><span class="pre">relative_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#relative_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.relative_path" title="Link to this definition"></a></dt>
<dd><p>Retun a relative path of a given file with respect a given origin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – A path to file.</p></li>
<li><p><strong>start</strong> – An origin of relative path. If the start is not given, the
current directory is used as the origin of relative path.</p></li>
</ul>
</dd>
</dl>
<p>Examples:
&gt;&gt;&gt; relative_path(‘/root/a/b.txt’, ‘/root/c’)
‘../a/b.txt’
&gt;&gt;&gt; relative_path(‘../a/b.txt’, ‘./c’)
‘../../a/b.txt’</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.remove_trailing_string">
<span class="sig-name descname"><span class="pre">remove_trailing_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#remove_trailing_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.remove_trailing_string" title="Link to this definition"></a></dt>
<dd><p>Remove a trailing string if it exists.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.request_omp_threading">
<span class="sig-name descname"><span class="pre">request_omp_threading</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#request_omp_threading"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.request_omp_threading" title="Link to this definition"></a></dt>
<dd><p>A context manager to override the session-wise OMP threading setting on CASA MPI client.</p>
<p>This function is intended to improve certain CASAtask/tool call performance on the MPI client by
temporarily turning on OpenMP threading while the MPI servers are idle. This feature will only
take effect under restricted circumstances to avoid competing with the MPI server processes from
the tier0 or tier1 parallelization.</p>
<p>This function can be used as both a decorator and context manager. For example:</p>
<blockquote>
<div><p>&#64;request_omp_threading(4)
def do_something():</p>
<blockquote>
<div><p>…</p>
</div></blockquote>
<p>or,
with request_omp_threading(4):</p>
<blockquote>
<div><p>immoments(..)</p>
</div></blockquote>
</div></blockquote>
<p>Note:
* Please use it with caution and examine the computing resource allocation circumstance
carefully at the execution point.
* The casalog.ompGet/SetNumThreads() API doesn’t work as expected on macOS as of CASA ver6.6.1 although
runtime env var (i.e. OMP_NUM_THREADS) is respected.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.shutdown_plotms">
<span class="sig-name descname"><span class="pre">shutdown_plotms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#shutdown_plotms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.shutdown_plotms" title="Link to this definition"></a></dt>
<dd><p>Shutdown the existing plotms process in the current CASA session.</p>
<p>This utility function shuts down the persist plotms process in the current CASA session, so the next plotms call
can start from a new proc. It’s implemented as a short-term workaround for two plotms behaviors due to the persistent
state of plotms once it’s called in a CASA session.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>a plotms process always uses the initial working directory to construct the output plot path when the
figure name is specified as a relative path (see CAS-13626), even after the working directory has changed
in the Python perspective.</p></li>
<li><p>a plotms process always uses the same casa logfile when it was started for its logging, even after
the casa log file location has been altered.</p></li>
</ol>
</div></blockquote>
<p>Note: This function follows the practice illustrated inside casaplotms.private.plotmstool.__stub_check()</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.utils.string_to_val">
<span class="sig-name descname"><span class="pre">string_to_val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/utils.html#string_to_val"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.utils.string_to_val" title="Link to this definition"></a></dt>
<dd><p>Convert a string to a Python data type.</p>
</dd></dl>

</section>
<section id="pipeline-infrastructure-utils-utils-test-module">
<h2>pipeline.infrastructure.utils.utils_test module<a class="headerlink" href="#pipeline-infrastructure-utils-utils-test-module" title="Link to this heading"></a></h2>
</section>
<section id="module-pipeline.infrastructure.utils.weblog">
<span id="pipeline-infrastructure-utils-weblog-module"></span><h2>pipeline.infrastructure.utils.weblog module<a class="headerlink" href="#module-pipeline.infrastructure.utils.weblog" title="Link to this heading"></a></h2>
<p>The sorting module contains utility functions used by the pipeline web log.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.weblog.OrderedDefaultdict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OrderedDefaultdict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/weblog.html#OrderedDefaultdict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.weblog.OrderedDefaultdict" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code></p>
<p>This class behaves as defaultdict from the collections module but maintaining the order of insertion.</p>
<p>It is usually called in our codebase using the following structure: my_list = utils.OrderedDefaultdict(list)
The dict can then be filled straight away: my_list[2] = [1, 2, 3]</p>
<p>For example,
&gt;&gt;&gt; my_list = OrderedDefaultdict(list)
&gt;&gt;&gt; my_list[2] = [1, 2, 3]
&gt;&gt;&gt; my_list[1]
[]
&gt;&gt;&gt; my_list[2]
[1, 2, 3]</p>
<p>Note that from Python 3.8 this class should probably work as collections.defaultdict given that dicts now preserve
the insertion order as a feature and the __reverse__ method is implemented in dicts.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.weblog.get_intervals">
<span class="sig-name descname"><span class="pre">get_intervals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calapp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/weblog.html#get_intervals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.weblog.get_intervals" title="Link to this definition"></a></dt>
<dd><p>Get the integration intervals for scans processed by a calibration.</p>
<p>The scan and spw selection is formed through inspection of the
CalApplication representing the calibration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> – the pipeline context</p></li>
<li><p><strong>calapp</strong> – the CalApplication representing the calibration</p></li>
<li><p><strong>spw_ids</strong> – a set of spw IDs to get intervals for. Leave as None to
use all spws specified in the CalApplication.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of datetime objects representing the unique scan intervals</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.weblog.get_logrecords">
<span class="sig-name descname"><span class="pre">get_logrecords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglevel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/weblog.html#get_logrecords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.weblog.get_logrecords" title="Link to this definition"></a></dt>
<dd><p>Get the logrecords for the result, removing any duplicates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> – a result containing logrecords</p></li>
<li><p><strong>loglevel</strong> – the loglevel to match</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.weblog.get_vis_from_plots">
<span class="sig-name descname"><span class="pre">get_vis_from_plots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plots</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/weblog.html#get_vis_from_plots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.weblog.get_vis_from_plots" title="Link to this definition"></a></dt>
<dd><p>Get the name to be used for the MS from the given plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>plots</strong></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.weblog.merge_td_columns">
<span class="sig-name descname"><span class="pre">merge_td_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_to_merge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/weblog.html#merge_td_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.weblog.merge_td_columns" title="Link to this definition"></a></dt>
<dd><p>Merge HTML TD columns with identical values using rowspan.</p>
<p>Arguments:
rows – a list of tuples, one tuple per row, containing n elements for the</p>
<blockquote>
<div><p>n columns.</p>
</div></blockquote>
<dl class="simple">
<dt>num_to_merge – the number of columns to merge, starting from the left</dt><dd><p>hand column. Leave as None to merge all columns.</p>
</dd>
</dl>
<p>vertical_align – Set to True to vertically centre any merged cells.</p>
<p>Output:
A list of strings, one string per row, containing TD elements.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.weblog.merge_td_rows">
<span class="sig-name descname"><span class="pre">merge_td_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/weblog.html#merge_td_rows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.weblog.merge_td_rows" title="Link to this definition"></a></dt>
<dd><p>Merge HTML TD rows with identical values using colspan.</p>
<p>Arguments:
table – a list of tuples, one tuple per row, containing n elements for the n columns.</p>
<p>Output:
A list of tuples with adjusted idential values merged with colspan.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.weblog.plots_to_html">
<span class="sig-name descname"><span class="pre">plots_to_html</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caption</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'middle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/weblog.html#plots_to_html"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.weblog.plots_to_html" title="Link to this definition"></a></dt>
<dd><p>Convert a list of plots to HTML snippets.</p>
<p class="rubric">Examples</p>
<p>plots_to_html(plots, caption=None, width=’400px’, height=’300px’)</p>
<p class="rubric">Notes</p>
<p>the generated snippet requires lazyload.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.weblog.scale_uv_range">
<span class="sig-name descname"><span class="pre">scale_uv_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pipeline.infrastructure.html#pipeline.infrastructure.filenamer.MeasurementSet" title="pipeline.infrastructure.filenamer.MeasurementSet"><span class="pre">MeasurementSet</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="pipeline.domain.html#pipeline.domain.measures.Distance" title="pipeline.domain.measures.Distance"><span class="pre">Distance</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/weblog.html#scale_uv_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.weblog.scale_uv_range" title="Link to this definition"></a></dt>
<dd><p>Return the UV range that captures the inner half of the data.</p>
<p>This function returns a 2-tuple with first value set to the UV range
as a domain object, and the second value set to a uvrange constraint
suitable for use in plotms calls.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ms</strong> – measurement set to analyse</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of (UV range, plotms constraint)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.weblog.table_to_html">
<span class="sig-name descname"><span class="pre">table_to_html</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tableclass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'table</span> <span class="pre">table-bordered</span> <span class="pre">table-striped</span> <span class="pre">table-condensed'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/weblog.html#table_to_html"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.weblog.table_to_html" title="Link to this definition"></a></dt>
<dd><p>Convert a astropy.table.Table object to an HTML table snippet.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.weblog.total_time_on_source">
<span class="sig-name descname"><span class="pre">total_time_on_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scans</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/weblog.html#total_time_on_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.weblog.total_time_on_source" title="Link to this definition"></a></dt>
<dd><p>Return the total time on source for the given Scans.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scans</strong> – collection of Scan domain objects</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a datetime.timedelta object set to the total time on source</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.infrastructure.utils.weblog.total_time_on_target_on_source">
<span class="sig-name descname"><span class="pre">total_time_on_target_on_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autocorr_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/infrastructure/utils/weblog.html#total_time_on_target_on_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.infrastructure.utils.weblog.total_time_on_target_on_source" title="Link to this definition"></a></dt>
<dd><p>Return the nominal total time on target source for the given MeasurementSet
excluding OFF-source integrations (REFERENCE). The flag is not taken into account.</p>
<p>Background of development: ALMA-TP observations have integrations of both TARGET
and REFERENCE intents in one scan. Scan.time_on_source does not return appropriate
exposure time in the case.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ms</strong> – MeasurementSet domain object to examine</p></li>
<li><p><strong>autocorr_only</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a datetime.timedelta object set to the total time on source</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="pipeline-infrastructure-utils-weblog-test-module">
<h2>pipeline.infrastructure.utils.weblog_test module<a class="headerlink" href="#pipeline-infrastructure-utils-weblog-test-module" title="Link to this heading"></a></h2>
</section>
<section id="module-pipeline.infrastructure.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pipeline.infrastructure.utils" title="Link to this heading"></a></h2>
<p>The utils package contains a set of utility classes and functions that are
useful to the pipeline framework and to tasks manipulating pipeline framework
objects, Python data types, and CASA data types.</p>
<p>The utils package is intended to be free of any task-specific logic. Code that
assumes knowledge or logic beyond that of the task-independent framework should
be housed in the h.common package (or hif.common, hifv.common, hsd.common, etc.
as appropriate).</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020–2024, Pipeline Dev. Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>