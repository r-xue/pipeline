

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pipeline.hsd.tasks.baseline.validation.ValidateLineRaster &mdash; Pipeline 
 (2024.2.0.4)  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_astrorefs.css?v=4d4a2fdb" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/custom_theme.css?v=30144f19" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=0729d509"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pipeline.hsd.tasks.baseline.validation.ValidateLineResults" href="pipeline.hsd.tasks.baseline.validation.ValidateLineResults.html" />
    <link rel="prev" title="pipeline.hsd.tasks.baseline.validation.ValidateLineInputs" href="pipeline.hsd.tasks.baseline.validation.ValidateLineInputs.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: gray" >

          
          
          <a href="../index.html" class="icon icon-home">
            Pipeline 
 (2024.2.0.4)
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/ways_to_run_the_pipeline.html">Ways to run the Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/recipes.html">Pipeline Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dependencies.html">Dependencies of <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Past Releases</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../apisummary.html">Full APIs (autosummary)</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pipeline.html">pipeline</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pipeline.cli_interface.html">pipeline.cli_interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.find_frame.html">pipeline.find_frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.initcli.html">pipeline.initcli</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.log_host_environment.html">pipeline.log_host_environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.show_weblog.html">pipeline.show_weblog</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.stop_weblog.html">pipeline.stop_weblog</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.Context.html">pipeline.Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.Pipeline.html">pipeline.Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.cli.html">pipeline.cli</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.config.html">pipeline.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.domain.html">pipeline.domain</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.environment.html">pipeline.environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.extern.html">pipeline.extern</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.h.html">pipeline.h</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.hif.html">pipeline.hif</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.hifa.html">pipeline.hifa</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.hifv.html">pipeline.hifv</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="pipeline.hsd.html">pipeline.hsd</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pipeline.hsd.cli.html">pipeline.hsd.cli</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.hsd.heuristics.html">pipeline.hsd.heuristics</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="pipeline.hsd.tasks.html">pipeline.hsd.tasks</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.hsd.templates.html">pipeline.hsd.templates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.hsdn.html">pipeline.hsdn</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.infrastructure.html">pipeline.infrastructure</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.qa.html">pipeline.qa</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.recipereducer.html">pipeline.recipereducer</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.recipes.html">pipeline.recipes</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.runpipeline.html">pipeline.runpipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.runvlapipeline.html">pipeline.runvlapipeline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apisummary.html#pipeline-tasks-autosummary">Pipeline Tasks (autosummary)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apisummary.html#pipeline-domain-context-autosummary">Pipeline domain/context (autosummary)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apisummary.html#pipeline-domain-infrastructure-modules-automodapi">Pipeline domain/infrastructure modules (automodapi)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apisummary.html#pipeline-h-tasks-modules-autmodapi"><code class="docutils literal notranslate"><span class="pre">pipeline.h*.tasks</span></code> modules (autmodapi)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apisummary.html#inheritance-diagrams-for-pipeline-task-inputs-results-classes">Inheritance Diagrams for Pipeline <code class="docutils literal notranslate"><span class="pre">Task</span></code>/<code class="docutils literal notranslate"><span class="pre">Inputs</span></code>/<code class="docutils literal notranslate"><span class="pre">Results</span></code> Classes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/ALMA-Imaging-Workflow.html">ALMA interferometry imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/VLA-Imaging-Workflow.html">VLA interferometry imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/VLASS-SE-CONT-Imaging-Workflow.html">VLASS-SE-CONT imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/VLASS-SE-CUBE-Imaging-Workflow.html">VLASS-SE-CUBE imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/selfcal_workflow.html">VLASS Selfcal &amp; Restore workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/comparing_pipeline_executions.html">Comparing pipeline executions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/building_the_pipeline.html">Building the pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modular.html">Run the Pipeline in a Conda environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/pipeline_tests.html">Pipeline testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/DataType_Testing.html">DataType Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/QA_scores.html">Pipeline Quality Assurance (QA) Score Class Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/DeveloperDocumentation.html">Pipeline developer documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/python3_conversion_notes.html">Python 3 conversion notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../heuristics/field_parameter.html">Field parameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../heuristics/FlaggingTasks.html">Pipeline Flagging Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/context.html">Pipeline Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/tier0dask.html">“Tier0” Parallelization with Dask/Futures</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: gray" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Pipeline 
 (2024.2.0.4)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../apisummary.html">Full APIs (autosummary)</a></li>
          <li class="breadcrumb-item"><a href="pipeline.html">pipeline</a></li>
          <li class="breadcrumb-item"><a href="pipeline.hsd.html">pipeline.hsd</a></li>
          <li class="breadcrumb-item"><a href="pipeline.hsd.tasks.html">pipeline.hsd.tasks</a></li>
          <li class="breadcrumb-item"><a href="pipeline.hsd.tasks.baseline.html">pipeline.hsd.tasks.baseline</a></li>
          <li class="breadcrumb-item"><a href="pipeline.hsd.tasks.baseline.validation.html">pipeline.hsd.tasks.baseline.validation</a></li>
      <li class="breadcrumb-item active">pipeline.hsd.tasks.baseline.validation.ValidateLineRaster</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.rst" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pipeline-hsd-tasks-baseline-validation-validatelineraster">
<h1>pipeline.hsd.tasks.baseline.validation.ValidateLineRaster<a class="headerlink" href="#pipeline-hsd-tasks-baseline-validation-validatelineraster" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ValidateLineRaster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="pipeline.infrastructure.basetask.StandardTaskTemplate.html#pipeline.infrastructure.basetask.StandardTaskTemplate" title="pipeline.infrastructure.basetask.StandardTaskTemplate"><code class="xref py py-class docutils literal notranslate"><span class="pre">StandardTaskTemplate</span></code></a></p>
<p>Line validation task for OTF raster observation.</p>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.CheckLineIdentity" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.CheckLineIdentity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CheckLineIdentity</span></code></a></p></td>
<td><p>Check if the given set of line ranges overlap.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.CleanIsolation" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.CleanIsolation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CleanIsolation</span></code></a></p></td>
<td><p>Clean spatially isolated cluster.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.DoBlur" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.DoBlur"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DoBlur</span></code></a></p></td>
<td><p>Blur cluster subplane.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.analyse" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.analyse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">analyse</span></code></a></p></td>
<td><p>Analyse results instance generated by prepare.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.calc_ProtectMask" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.calc_ProtectMask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_ProtectMask</span></code></a></p></td>
<td><p>Return ProtectMask according to Center and Width.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clean_cluster" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clean_cluster"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clean_cluster</span></code></a></p></td>
<td><p>Clean-up cluster by eliminating outliers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clean_detect_line" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clean_detect_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clean_detect_line</span></code></a></p></td>
<td><p>Exclude false detection by comparing three signals.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clean_detect_signal" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clean_detect_signal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clean_detect_signal</span></code></a></p></td>
<td><p>Exclude false detections based on the detection rate.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clustering_hierarchy" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clustering_hierarchy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clustering_hierarchy</span></code></a></p></td>
<td><p>Perform hierarchical clustering analysis on detected lines.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clustering_kmean" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clustering_kmean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clustering_kmean</span></code></a></p></td>
<td><p>Perform k-mean clustering analysis on detected lines.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clustering_kmean_score" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clustering_kmean_score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clustering_kmean_score</span></code></a></p></td>
<td><p>Compute score of the clusters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.detection_stage" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.detection_stage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">detection_stage</span></code></a></p></td>
<td><p>Classify cluster members by their location on celestial coordinate.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.execute" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.execute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute</span></code></a></p></td>
<td><p>Run this task and return the <code class="xref py py-class docutils literal notranslate"><span class="pre">Results</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.final_stage" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.final_stage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">final_stage</span></code></a></p></td>
<td><p>Distribute validated lines to each observed spectra.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.prepare" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.prepare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare</span></code></a></p></td>
<td><p>Validate spectral lines detected by detection module.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.set_data" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.set_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_data</span></code></a></p></td>
<td><p>Transpose axes of two-dimensional array data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.smoothing_stage" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.smoothing_stage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smoothing_stage</span></code></a></p></td>
<td><p>Smooth cluster distribution.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.validate_cluster" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.validate_cluster"><code class="xref py py-obj docutils literal notranslate"><span class="pre">validate_cluster</span></code></a></p></td>
<td><p>Validate cluster detected by clustering analysis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.validation_stage" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.validation_stage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">validation_stage</span></code></a></p></td>
<td><p>Validate clusters by their detection fraction on each grid.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">CLUSTER_WHITEN</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">DebugOutName</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">DebugOutVer</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Marginal</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.MaxFWHM" title="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.MaxFWHM"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MaxFWHM</span></code></a></p></td>
<td><p>Return maximum FWHM to consider for line validation.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">MinFWHM</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Questionable</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Valid</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_multi_vis_task</span></code></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.CheckLineIdentity">
<span class="sig-name descname"><span class="pre">CheckLineIdentity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.7</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.CheckLineIdentity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.CheckLineIdentity" title="Link to this definition"></a></dt>
<dd><p>Check if the given set of line ranges overlap.</p>
<p>True if the overlap of two lines is greater than the threshold.</p>
<dl class="simple">
<dt>1L          1R          1L         1R          1L        1R       1L       1R</dt><dd><p>[          ]           [          ]            [         ]       [         ]
xxxxxxxxxxxx           xxxxxxxxxxxx            xxxxxxxxxxx       xxxxxxxxxxx</p>
</dd>
</dl>
<p>oooooooooooooo           oooooooooooo          ooooooooooo         ooooooooo
[            ]           [          ]          [         ]         [       ]
2L          2R          2L         2R          2L        2R       2L       2R</p>
<p>True if Num(x) / Num(o) &gt;= overlap</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old</strong> – Reference line range. [left, right, binning]</p></li>
<li><p><strong>new</strong> – Comparing line range. [left, right, binning]</p></li>
<li><p><strong>overlap</strong> – Threshold for overlap. Ranges between 0 and 1. Defaults to 0.7.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether or not two lines overlap.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.CleanIsolation">
<span class="sig-name descname"><span class="pre">CleanIsolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nra</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Original</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Plane</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GridMember</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.CleanIsolation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.CleanIsolation" title="Link to this definition"></a></dt>
<dd><p>Clean spatially isolated cluster.</p>
<p>Pick up only Valid detections, and check if there are enough
surrounding pixels with Valid detection. Create subplane of the
cluster by collecting contiguous cluster members.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nra</strong> – Number of horizontal grids</p></li>
<li><p><strong>ndec</strong> – Number of vertical grids</p></li>
<li><p><strong>Original</strong> – Spatial distribution of Marginal+Valid detections.
Value ranges from 0 to 1.</p></li>
<li><p><strong>Plane</strong> – Integer binary flag, 0 (False) or 1 (True), indicating whether
or not any cluster member exists in the grid.</p></li>
<li><p><strong>GridMember</strong> – Number of spectra at each grid position. Value ranges
from 0 to 3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>2-tuple of cleaned clusters, MemberList and RealMember. If no cluster is
left after the cleaning, empty lists are returned.
MemberList contains positions of cluster member with Marginal+Valid detection
MemberList[n]: [[(x00,y00),(x01,y01),……..,(x0k-1,y0k-1)],</p>
<blockquote>
<div><dl class="simple">
<dt>[(x10,y10),(x11,y11),..,(x1i-1,y1i-1)],</dt><dd><p>…</p>
</dd>
</dl>
<p>[(xn-10,yn-10),(xn-11,yn-11),..,(xn-1i-1,yn-1i-1)]]</p>
</div></blockquote>
<p>Realmember contains number of cluster members with only Valid detection
RealMember: [Nvalid_00, Nvalid_01, …, Nvalid_n-1i-1]</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.DoBlur">
<span class="sig-name descname"><span class="pre">DoBlur</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Realmember</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nra</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SubPlane</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pipeline.hsd.tasks.baseline.validation.Integral.html#pipeline.hsd.tasks.baseline.validation.Integral" title="numbers.Integral"><span class="pre">Integral</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.DoBlur"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.DoBlur" title="Link to this definition"></a></dt>
<dd><p>Blur cluster subplane.</p>
<p>Convolve subplane data with two-dimensional boxcar kernal whose
radius depends on Realmember and ratio.</p>
<blockquote>
<div><p>R_blur = sqrt(Realmember / pi) * ratio + 1.5</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Realmember</strong> – Number of valid cluster members in the subplane</p></li>
<li><p><strong>nra</strong> – Number of horizontal grids</p></li>
<li><p><strong>ndec</strong> – Number of vertical grids</p></li>
<li><p><strong>SubPlane</strong> – Spatial distribution of Valid detections.</p></li>
<li><p><strong>ratio</strong> – Factor for blur radius</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2-tuple of numpy arrays. First one is an integer binary array
of whether original (pre-blur) pixels are Valid detection
while the second array is also an integer binary array
of whether blurred pixels are Valid or Marginal detection</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.HeadTail">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HeadTail</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.HeadTail" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.HeadTail.__add__">
<span class="sig-name descname"><span class="pre">__add__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.HeadTail.__add__" title="Link to this definition"></a></dt>
<dd><p>Return self+value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.HeadTail.__mul__">
<span class="sig-name descname"><span class="pre">__mul__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.HeadTail.__mul__" title="Link to this definition"></a></dt>
<dd><p>Return self*value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.HeadTail.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.HeadTail.count" title="Link to this definition"></a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.HeadTail.head">
<span class="sig-name descname"><span class="pre">head</span></span><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.HeadTail.head" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.HeadTail.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9223372036854775807</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.HeadTail.index" title="Link to this definition"></a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.HeadTail.tail">
<span class="sig-name descname"><span class="pre">tail</span></span><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.HeadTail.tail" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.Inputs">
<span class="sig-name descname"><span class="pre">Inputs</span></span><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.Inputs" title="Link to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="pipeline.hsd.tasks.baseline.validation.ValidateLineInputs.html#pipeline.hsd.tasks.baseline.validation.ValidateLineInputs" title="pipeline.hsd.tasks.baseline.validation.ValidateLineInputs"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValidateLineInputs</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.MaxFWHM">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MaxFWHM</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.MaxFWHM" title="Link to this definition"></a></dt>
<dd><p>Return maximum FWHM to consider for line validation.</p>
<p>Max FWHM is 1/3 of total number of channels excluding edge channels
specified by inputs.edge.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Maximum FWHM in number of channels</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.analyse">
<span class="sig-name descname"><span class="pre">analyse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pipeline.hsd.tasks.baseline.validation.ValidateLineResults.html#pipeline.hsd.tasks.baseline.validation.ValidateLineResults" title="pipeline.hsd.tasks.baseline.validation.ValidateLineResults"><span class="pre">ValidateLineResults</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="pipeline.hsd.tasks.baseline.validation.ValidateLineResults.html#pipeline.hsd.tasks.baseline.validation.ValidateLineResults" title="pipeline.hsd.tasks.baseline.validation.ValidateLineResults"><span class="pre">ValidateLineResults</span></a></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.analyse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.analyse" title="Link to this definition"></a></dt>
<dd><p>Analyse results instance generated by prepare.</p>
<p>Do nothing.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>ValidateLineResutls instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.calc_ProtectMask">
<span class="sig-name descname"><span class="pre">calc_ProtectMask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pipeline.hsd.tasks.baseline.validation.Integral.html#pipeline.hsd.tasks.baseline.validation.Integral" title="numbers.Integral"><span class="pre">Integral</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">Width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pipeline.hsd.tasks.baseline.validation.Integral.html#pipeline.hsd.tasks.baseline.validation.Integral" title="numbers.Integral"><span class="pre">Integral</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">nchan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinFWHM</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pipeline.hsd.tasks.baseline.validation.Integral.html#pipeline.hsd.tasks.baseline.validation.Integral" title="numbers.Integral"><span class="pre">Integral</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">MaxFWHM</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pipeline.hsd.tasks.baseline.validation.Integral.html#pipeline.hsd.tasks.baseline.validation.Integral" title="numbers.Integral"><span class="pre">Integral</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.calc_ProtectMask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.calc_ProtectMask" title="Link to this definition"></a></dt>
<dd><p>Return ProtectMask according to Center and Width.</p>
<p>Return ProtectMask: [MaskL, MaskR]</p>
<p>This method translates a range of protected range given as (center, width) value
into (start, end) style. Effective width of the translated range is calculated
from the original with and the input parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Center</strong> – Center of the range</p></li>
<li><p><strong>Width</strong> – Width of the range</p></li>
<li><p><strong>nchan</strong> – Number of channels of the spectrum</p></li>
<li><p><strong>MinFWHM</strong> – Minimum FWHM</p></li>
<li><p><strong>MaxFTHM</strong> – Maximum FWHM</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Range of protected range as (start, end) value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clean_cluster">
<span class="sig-name descname"><span class="pre">clean_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Category</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Region</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DetectedLineList</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nthreshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NumParam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.clean_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clean_cluster" title="Link to this definition"></a></dt>
<dd><p>Clean-up cluster by eliminating outliers.</p>
<blockquote>
<div><p>Radius = StandardDeviation * nThreshold (circle/sphere)</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul>
<li><p><strong>Data</strong> – List of cluster properties with associated spatial coordinate.</p></li>
<li><p><strong>Category</strong> – Input category list representing membership information</p></li>
<li><p><strong>Region</strong> –</p>
<dl class="simple">
<dt>List of line properties with associated spatial coordinate.</dt><dd><p>Format is as follows.</p>
</dd>
</dl>
<p>[[row, chan0, chan1, RA, DEC, flag, Binning],[],[],,,[]]</p>
</li>
<li><p><strong>Nthreshold</strong> – Threshold factor for detecting outlier</p></li>
<li><p><strong>NumParam</strong> – Number of cluster properties</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>4-tuple of the following values.</dt><dd><p>Region: flag information is added
Range: Range[Ncluster][5]: [ClusterCenterX, ClusterCenterY, 0, 0, Threshold]
Stdev: Stdev[Ncluster][5]: [ClusterStddevX, ClusterStddevY, 0, 0, 0]
Category: renumbered category</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clean_detect_line">
<span class="sig-name descname"><span class="pre">clean_detect_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pipeline.infrastructure.renderer.stats_extractor.OrderedDict.html#pipeline.infrastructure.renderer.stats_extractor.OrderedDict" title="collections.OrderedDict"><span class="pre">OrderedDict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.6</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.clean_detect_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clean_detect_line" title="Link to this definition"></a></dt>
<dd><p>Exclude false detection by comparing three signals.</p>
<p>Select only line candidates with good possibility by checking all spectra
taken at the same position. If list of detected signals per spectrum, data,
is given, this method evaluates detection rate of each signal where identity
of signals is checked by CheckLineIdentity method. If the rate exceeds threshold,
the signal is marked as “true signal”. Default threshold for “true signal” is
0.6 (60%).</p>
<p>Meaning of default value is interpreted as follows. Suppose we have three sets
of signals. If identical lines are found in two out of three signals, detection
rate is 2/3 or 0.66666…. Therefore, default value corresponds to the condition
that the signal is true detection if it is found in two out of three signals.
Larger threshold such as 0.7 is more strict check, which effectively requires
that the signal must be found in all three.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul>
<li><p><strong>data</strong> – List of properties of detected lines to be examined. Format is
as follows</p>
<blockquote>
<div><dl class="simple">
<dt>{ID1: [[LineStart, LineEnd, Binning],,,],</dt><dd><p>ID2: [[LineStart, LineEnd, Binning],,,],
…
IDn: [[LineStart, LineEnd, Binning],,,]}</p>
</dd>
</dl>
</div></blockquote>
</li>
<li><p><strong>threshold</strong> – threshold for the exclusion. Ranges between 0 and 1.
Defalts to 0.6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of lines that are regarded as “true detection”. For false
detection, dict value will be [-1, -1, 1].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clean_detect_signal">
<span class="sig-name descname"><span class="pre">clean_detect_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">detect_signal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.clean_detect_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clean_detect_signal" title="Link to this definition"></a></dt>
<dd><p>Exclude false detections based on the detection rate.</p>
<p>Spectra in each grid positions are splitted into 3 groups along time series.
Group of spectra is then combined to 1 spectrum. So, one grid position has
3 combined spectra.
Suppose that the real signal is correlated but the error is not, we can
clean false signals (not correlated) in advance of the validation stage.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>detect_signal</strong> –</p>
<dl class="simple">
<dt>List of detected lines per spatial position. Its format is</dt><dd><p>as follows.</p>
</dd>
<dt>detect_signal = {</dt><dd><dl class="simple">
<dt>ID1: [RA, DEC, [[LineStartChannel1, LineEndChannel1],</dt><dd><p>[LineStartChannel2, LineEndChannel2],
…,
[LineStartChannelN, LineEndChannelN]]],</p>
</dd>
<dt>IDn: [RA, DEC, [[LineStartChannel1, LineEndChannel1],</dt><dd><p>…,
[LineStartChannelN, LineEndChannelN]]]</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>detect_signal after cleaning</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clustering_hierarchy">
<span class="sig-name descname"><span class="pre">clustering_hierarchy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Region</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DetectedLineList</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Region2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nThreshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nThreshold2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'single'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ClusteringResult</span></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.clustering_hierarchy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clustering_hierarchy" title="Link to this definition"></a></dt>
<dd><p>Perform hierarchical clustering analysis on detected lines.</p>
<p>Perform hierarchical clustering analysis that is a “bottom-up”
approach to configure the clusters that best represents the
distribution of the detected line properties. It starts with
the small clusters and combine them until certain condition
is met.</p>
<dl class="simple">
<dt>method = ‘ward’<span class="classifier">Ward’s linkage method</span></dt><dd><p>‘single’  : nearest point linkage method
‘complete’: farthest point linkage method
‘average’ : average linkage method
‘centroid’: centroid/UPGMC linkage method
‘median’  : median/WPGMC linkage method</p>
</dd>
</dl>
<p>1st threshold is set to nThreshold x stddev(distance matrix)
2nd threshold is set to nThreshold2 x stddev of sub-cluster distance matrix
in:</p>
<blockquote>
<div><p>self.Data -&gt; Region2
self.Ndata</p>
</div></blockquote>
<dl class="simple">
<dt>out:</dt><dd><p>self.Threshold
self.Nthreshold
self.Category
self.Ncluster</p>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul>
<li><p><strong>Region</strong> –</p>
<dl class="simple">
<dt>List of line properties with associated spatial coordinate.</dt><dd><p>Format is as follows.</p>
</dd>
</dl>
<p>[[row, chan0, chan1, RA, DEC, flag, Binning],[],[],,,[]]</p>
</li>
<li><p><strong>Region2</strong> –</p>
<dl class="simple">
<dt>List of line properties (line width and line center)</dt><dd><p>for each data. Format is as follows.</p>
</dd>
</dl>
<p>[[Width, Center],[],[],,,[]]</p>
</li>
<li><p><strong>nThreshold</strong> – Threshold factor for the hierarchical clustering analysis.
It is used as a multiplicative factor for stddev of
initial distance matrix.</p></li>
<li><p><strong>nThreshold2</strong> – Another threshold factor for the hierarchical clustering analysis.
It is used as a multiplicative factor for stddev of
sub-cluster distance matrix.</p></li>
<li><p><strong>method</strong> – Method name for linkage method of the hierarchical clustering analysis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>4-tuple representing clustering results, number of clusters,
list of cluster properties (Center, Width/WHITEN, T/F, ClusterRadius),
List of category indices indicating which lines belong to what
cluster, and list of line properties with associated spatial
coordinate (which is same format as Region).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clustering_kmean">
<span class="sig-name descname"><span class="pre">clustering_kmean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Region</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DetectedLineList</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Region2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ClusteringResult</span></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.clustering_kmean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clustering_kmean" title="Link to this definition"></a></dt>
<dd><p>Perform k-mean clustering analysis on detected lines.</p>
<p>Perform k-mean clustering analysis on detected lines with various
pre-defined number of clusters. Best number of clusters are
determined by the scoring scheme based on the distance between
origin of the cluster and the data regarded as a member of the
cluster.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul>
<li><p><strong>Region</strong> –</p>
<dl class="simple">
<dt>List of line properties with associated spatial coordinate.</dt><dd><p>Format is as follows.</p>
</dd>
</dl>
<p>[[row, chan0, chan1, RA, DEC, flag, Binning],[],[],,,[]]</p>
</li>
<li><p><strong>Region2</strong> –</p>
<dl class="simple">
<dt>List of line properties (line width and line center)</dt><dd><p>for each data. Format is as follows.</p>
</dd>
</dl>
<p>[[Width, Center],[],[],,,[]]</p>
</li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>4-tuple representing clustering results, number of clusters,
list of cluster properties (Center, Width/WHITEN, T/F, ClusterRadius),
List of category indices indicating which lines belong to what
cluster, and list of line properties with associated spatial
coordinate (which is same format as Region).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clustering_kmean_score">
<span class="sig-name descname"><span class="pre">clustering_kmean_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MeanDistance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MedianWidth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ncluster</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MemberRate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.clustering_kmean_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.clustering_kmean_score" title="Link to this definition"></a></dt>
<dd><p>Compute score of the clusters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>MeanDistance</strong> – Mean distance from the center of the cluster</p></li>
<li><p><strong>MedianWidth</strong> – Median value of the line width</p></li>
<li><p><strong>Ncluster</strong> – Number of clusters</p></li>
<li><p><strong>MemberRate</strong> – Fraction of the members that belong to any cluster</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Score of the cluster</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.detection_stage">
<span class="sig-name descname"><span class="pre">detection_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ncluster</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nra</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_ra</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_dec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Region</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DetectedLineList</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detect_signal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.detection_stage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.detection_stage" title="Link to this definition"></a></dt>
<dd><p>Classify cluster members by their location on celestial coordinate.</p>
<p>This method implements the first phase of cluster validation process,
and is so-called “Detection Stage”. It combines clustering analysis
result with spatial information of each detected line, and classify
cluster members by their location on celestial coordinate.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul>
<li><p><strong>Ncluster</strong> – Number of clusters</p></li>
<li><p><strong>nra</strong> – Number of horizontal grids on the sky</p></li>
<li><p><strong>ndec</strong> – Number of vertical grids on the sky</p></li>
<li><p><strong>grid_ra</strong> – Physical size of the horizontal grid in degree</p></li>
<li><p><strong>grid_dec</strong> – Physical size of the vertical grid in degree</p></li>
<li><p><strong>category</strong> – List of cluster membership indices</p></li>
<li><p><strong>Region</strong> –</p>
<dl class="simple">
<dt>List of line properties with associated spatial coordinate.</dt><dd><p>Format is as follows.</p>
</dd>
</dl>
<p>[[row, chan0, chan1, RA, DEC, flag, Binning],[],[],,,[]]</p>
</li>
<li><p><strong>detect_signal</strong> –</p>
<dl class="simple">
<dt>List of detected lines per spatial position. Its format is</dt><dd><p>as follows.</p>
</dd>
<dt>detect_signal = {</dt><dd><dl class="simple">
<dt>ID1: [RA, DEC, [[LineStartChannel1, LineEndChannel1],</dt><dd><p>[LineStartChannel2, LineEndChannel2],
…,
[LineStartChannelN, LineEndChannelN]]],</p>
</dd>
<dt>IDn: [RA, DEC, [[LineStartChannel1, LineEndChannel1],</dt><dd><p>…,
[LineStartChannelN, LineEndChannelN]]]</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
</li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>3-tuple of the following numpy arrays.</p>
<blockquote>
<div><ul class="simple">
<li><p>Three dimensional array representing spatial distribution of
each cluster detected by the clustering analysis.</p></li>
<li><p>Number of spectra at each grid position. Value of the array ranges
from 0 to 3 (either of 0, 1, 2, 3) but usually it is 3.</p></li>
<li><p>array data for plotting clustering analysis results for detection stage</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.execute">
<span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.execute" title="Link to this definition"></a></dt>
<dd><p>Run this task and return the <code class="xref py py-class docutils literal notranslate"><span class="pre">Results</span></code>.</p>
<p>The contract of the method execute is that it may take any action
whatsoever, providing that it returns an instance implementing Results
that summarises those actions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.final_stage">
<span class="sig-name descname"><span class="pre">final_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">GridCluster</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GridMember</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Region</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DetectedLineList</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Region2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_ra</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_dec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">broad_component</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xorder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yorder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Grid2SpectrumID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PosList</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="pipeline.infrastructure.renderer.stats_extractor.OrderedDict.html#pipeline.infrastructure.renderer.stats_extractor.OrderedDict" title="collections.OrderedDict"><span class="pre">OrderedDict</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.final_stage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.final_stage" title="Link to this definition"></a></dt>
<dd><p>Distribute validated lines to each observed spectra.</p>
<p>This method implements the final phase of cluster validation process,
and is so-called “Final Stage”. It performs two-dimensional least-square
fitting of line properties (center, width) on the grid configured onto
the celestial plane, and distribute those properties to each observed
spectra using least-square solution at their associated position.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul>
<li><p><strong>GridCluster</strong> – Three dimensional array representing spatial distribution of
each cluster detected by the clustering analysis</p></li>
<li><p><strong>GridMember</strong> – Number of spectra at each grid position</p></li>
<li><p><strong>Region</strong> –</p>
<dl class="simple">
<dt>List of line properties with associated spatial coordinate.</dt><dd><p>Format is as follows.</p>
</dd>
</dl>
<p>[[row, chan0, chan1, RA, DEC, flag, Binning],[],[],,,[]]</p>
</li>
<li><p><strong>Region2</strong> – List of line properties (line width and line center)
for each data</p></li>
<li><p><strong>lines</strong> – List of line properties with validity flag</p></li>
<li><p><strong>category</strong> – List of cluster membership indices</p></li>
<li><p><strong>grid_ra</strong> – Horizontal (longitudinal) spacing of spatial grids.
The value should be the one with declination correction.</p></li>
<li><p><strong>grid_dec</strong> – Vertical (latitudinal) spacing of spatial grids.</p></li>
<li><p><strong>broad_component</strong> – Process broad component or not. Not used.</p></li>
<li><p><strong>xorder</strong> – Order of the polynomial for horizontal fitting.
If it is -1, order is automatically determined inside
the method (max 5).</p></li>
<li><p><strong>yorder</strong> – Order of the polynomial for vertical fitting.
If it is -1, order is automatically determined inside
the method (max 5).</p></li>
<li><p><strong>x0</strong> – Horizontal position of the bottom left corner</p></li>
<li><p><strong>y0</strong> – Vertical position of the bottom left corner</p></li>
<li><p><strong>Grid2SpectrumID</strong> – Index mapping between serial list of gridded
spectra and two-dimensional grid positions</p></li>
<li><p><strong>index_list</strong> – List of consecutive datatable row numbers.</p></li>
<li><p><strong>PosList</strong> – List of pointings (RA and Dec) of ON_SOURCE data</p></li>
<li><p><strong>cluster_flag</strong> – array data for plotting clustering analysis results</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>4-tuple of the following data.</p>
<blockquote>
<div><ul class="simple">
<li><p>List of validated line ranges distributed to each observed spectrum
using the least-square fitting of line parameters</p></li>
<li><p>List of line properties with updated validity flag</p></li>
<li><p>List of line properties dedicated to plotting</p></li>
<li><p>Updated cluster_flag (flags for smoothing stage is appended)</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.prepare">
<span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datatable_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detect_signal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pipeline.infrastructure.renderer.stats_extractor.OrderedDict.html#pipeline.infrastructure.renderer.stats_extractor.OrderedDict" title="collections.OrderedDict"><span class="pre">OrderedDict</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="pipeline.hsd.tasks.baseline.validation.ValidateLineResults.html#pipeline.hsd.tasks.baseline.validation.ValidateLineResults" title="pipeline.hsd.tasks.baseline.validation.ValidateLineResults"><span class="pre">ValidateLineResults</span></a></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.prepare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.prepare" title="Link to this definition"></a></dt>
<dd><p>Validate spectral lines detected by detection module.</p>
<p>As a first step, the method performs clustering analysis on detected
lines in line width vs line center space. Detected clusters are then
analyzed and set True/False flag based on the spatial distribution
of the cluster members in celestial coordinate. Finally, cluster
line properties are interpolated in two-dimensional celestial space
and are distributed to each ON_SOURCE data point.</p>
<p>Sigma clipping iterations will be applied if inputs.nsigma is positive</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul>
<li><p><strong>datatable_dict</strong> – Dictionary holding datatable instance per MS.</p></li>
<li><p><strong>index_list</strong> – List of consecutive datatable row numbers. Defaults to None.</p></li>
<li><p><strong>grid_table</strong> – Metadata for gridding. See simplegrid.py for detail.</p></li>
<li><p><strong>detect_signal</strong> –</p>
<dl class="simple">
<dt>List of detected lines per spatial position. Its format is</dt><dd><p>as follows.</p>
</dd>
<dt>detect_signal = {</dt><dd><dl class="simple">
<dt>ID1: [RA, DEC, [[LineStartChannel1, LineEndChannel1],</dt><dd><p>[LineStartChannel2, LineEndChannel2],
…,
[LineStartChannelN, LineEndChannelN]]],</p>
</dd>
<dt>IDn: [RA, DEC, [[LineStartChannel1, LineEndChannel1],</dt><dd><p>…,
[LineStartChannelN, LineEndChannelN]]]</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
</li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>ValidateLineResults instance, which contains list of line parameters
with validation results. The list is stored in outcome[‘lines’] and
its format is as follows:</p>
<blockquote>
<div><p>[LineCenter, LineWidth, Validity]</p>
</div></blockquote>
<p>where Validity is boolean value that indicates whether or not the
detected line is validated. OK (validated) for True while NG for False.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.set_data">
<span class="sig-name descname"><span class="pre">set_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Observation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordering</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'none'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.set_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.set_data" title="Link to this definition"></a></dt>
<dd><p>Transpose axes of two-dimensional array data.</p>
<dl>
<dt>Observation: numpy.array([[val1, val2, val3,..,valN],</dt><dd><dl class="simple">
<dt>[val1, val2, val3,..,valN],</dt><dd></dd>
</dl>
<p>[val1, val2, val3,..,valN]], float)</p>
</dd>
<dt>where N is a max dimensions of parameter space</dt><dd><dl class="simple">
<dt>ordering: ‘none’ or list of ordering of columns</dt><dd><p>e.g., ordering=[2,3,1,0] =&gt; [col3,col2,col0,col1]</p>
</dd>
</dl>
</dd>
</dl>
<p>self.Data: Observation data
self.NumParam: Number of dimensions to be used for Clustering Analysis
self.Factor: Set default Whitening factor (to be 1.0)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Observation</strong> – Two-dimensional array data</p></li>
<li><p><strong>ordering</strong> – Axis order for output array</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Given array is not two-dimensional</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Transposed array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.smoothing_stage">
<span class="sig-name descname"><span class="pre">smoothing_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">GridCluster</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.smoothing_stage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.smoothing_stage" title="Link to this definition"></a></dt>
<dd><p>Smooth cluster distribution.</p>
<p>This method implements the third phase of cluster validation process,
and is so-called “Smoothing Stage”. It applies smoothing to spatial
cluster distribution and update validity flag of detected lines
according to the smoothed cluster distribution.</p>
<p>Smoothing kernel is given by,</p>
<blockquote>
<div><p>6.0 if Dx=0 and Dy=0,
1.0 / (Dx**2 + Dy**2) if abs(Dx) + abs(Dy) &lt; 4, and
0 otherwise</p>
</div></blockquote>
<p>where Dx and Dy is distance from the center pixel. It looks like below.</p>
<blockquote>
<div><p>[ 0.0,  0.2, 0.25,  0.2,  0.0]
[ 0.2,  0.5,  0.1,  0.5,  0.2]
[0.25,  0.1,  6.0,  0.1, 0.25]
[ 0.2,  0.5,  0.1,  0.5,  0.2]
[ 0.0,  0.2, 0.25,  0.2,  0.0]</p>
</div></blockquote>
<p>Lines with too low detection value is flagged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>GridCluster</strong> – Three dimensional array representing spatial distribution of
each cluster detected by the clustering analysis</p></li>
<li><p><strong>lines</strong> – List of line properties with validity flag</p></li>
<li><p><strong>cluster_flag</strong> – array data for plotting clustering analysis results</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>3-tuple of updated cluster information.</p>
<blockquote>
<div><ul class="simple">
<li><p>Smoothed GridCluster</p></li>
<li><p>List of line properties with updated validity flag</p></li>
<li><p>Updated cluster_flag (flags for smoothing stage is appended)</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.validate_cluster">
<span class="sig-name descname"><span class="pre">validate_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clustering_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClusteringResult</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detect_signal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PosList</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Region2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.validate_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.validate_cluster" title="Link to this definition"></a></dt>
<dd><p>Validate cluster detected by clustering analysis.</p>
<p>This method validates clusters detected in line center vs line width space.
Validation utilizes spatial distribution of lines associated with the cluster.
Property of validated lines are interpolated in two-dimensional space and
set to each spatial data point.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul>
<li><p><strong>clustering_result</strong> – Clustering result</p></li>
<li><p><strong>index_list</strong> – List of consecutive datatable row numbers</p></li>
<li><p><strong>detect_signal</strong> –</p>
<dl class="simple">
<dt>List of detected lines per spatial position. Its format is</dt><dd><p>as follows.</p>
</dd>
<dt>detect_signal = {</dt><dd><dl class="simple">
<dt>ID1: [RA, DEC, [[LineStartChannel1, LineEndChannel1],</dt><dd><p>[LineStartChannel2, LineEndChannel2],
…,
[LineStartChannelN, LineEndChannelN]]],</p>
</dd>
<dt>IDn: [RA, DEC, [[LineStartChannel1, LineEndChannel1],</dt><dd><p>…,
[LineStartChannelN, LineEndChannelN]]]</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
</li>
<li><p><strong>PosList</strong> – List of pointings (RA and Dec) of ON_SOURCE data</p></li>
<li><p><strong>Region2</strong> – List of line properties (line width and line center)
for each data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>4-tuple of final line properties for each ON_SOURCE pointings (RealSignal),
line property of detected clusters (lines), line property for plotting
(channelmap_range), and flag per validation stage for each cluster (cluster_flag).</p>
<p>cluster_flag is data for plotting clustering analysis results.
It stores GridCluster quantized by given thresholds.
it is defined as integer array and one digit is assigned to
one clustering stage in each integer value:</p>
<blockquote>
<div><p>1st digit: detection
2nd digit: validation
3rd digit: smoothing
4th digit: final</p>
</div></blockquote>
<p>If GridCluster value exceeds any threshold, corresponding
digit is incremented. For example, flag 3210 stands for,</p>
<blockquote>
<div><p>value didn’t exceed any thresholds in detection, and
exceeded one (out of three) threshold in validation, and
exceeded two (out of three) thresholds in smoothing, and
exceeded three (out of four) thresholds in final.</p>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.validation_stage">
<span class="sig-name descname"><span class="pre">validation_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">GridCluster</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GridMember</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pipeline/hsd/tasks/baseline/validation.html#ValidateLineRaster.validation_stage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.hsd.tasks.baseline.validation.ValidateLineRaster.validation_stage" title="Link to this definition"></a></dt>
<dd><p>Validate clusters by their detection fraction on each grid.</p>
<p>This method implements the second phase of cluster validation process,
and is so-called “Validation Stage”. It sets validation flag based on
the detection fraction on each grid.</p>
<p>Cluster is validated if number of spectrum which contains feature belongs
to the cluster is greater or equal to the half number of spectrum in the Grid.
Normally, 3 spectra are created for each grid positions, therefore,
GridMember[ra][dec] = 3 for most of the cases.</p>
<p>Normalized validity can be</p>
<blockquote>
<div><ul class="simple">
<li><p>1/3 (0.2&lt;V) -&gt; only one detection -&gt; Qestionable</p></li>
<li><p>2/3 (0.5&lt;V)-&gt; two detections -&gt; Marginal</p></li>
<li><p>3/3 (0.7&lt;V)-&gt; detected for all spectra -&gt; Valid</p></li>
</ul>
</div></blockquote>
<p>Questionable lines are flagged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>GridCluster</strong> – Three dimensional array representing spatial distribution of
each cluster detected by the clustering analysis</p></li>
<li><p><strong>GridMember</strong> – Number of spectra at each grid position</p></li>
<li><p><strong>lines</strong> – List of line properties with validity flag</p></li>
<li><p><strong>cluster_flag</strong> – array data for plotting clustering analysis results</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>4-tuple of the following arrays.</p>
<blockquote>
<div><ul class="simple">
<li><p>Updated GridCluster normalized by GridMember</p></li>
<li><p>Number of lines detected at each grid position (return GridMember as is)</p></li>
<li><p>List of line properties with updated validity flag (Questionable lines are
flagged out)</p></li>
<li><p>array data for plotting clustering analysis results for validation stage</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pipeline.hsd.tasks.baseline.validation.ValidateLineInputs.html" class="btn btn-neutral float-left" title="pipeline.hsd.tasks.baseline.validation.ValidateLineInputs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pipeline.hsd.tasks.baseline.validation.ValidateLineResults.html" class="btn btn-neutral float-right" title="pipeline.hsd.tasks.baseline.validation.ValidateLineResults" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020–2024, Pipeline Dev. Team, build: 2024.2.0.4+149-gc67ed7416-PIPE-1669-run-dev-pipeline-with-modular-casa6.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>