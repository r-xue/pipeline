

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pipeline.extern.findContinuum.findContinuum &mdash; Pipeline unknown documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_astrorefs.css?v=4d4a2fdb" />
      <link rel="stylesheet" type="text/css" href="../_static/custom_theme.css?v=30144f19" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=3f1b9271"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pipeline.extern.findContinuum.findContinuumChannels" href="pipeline.extern.findContinuum.findContinuumChannels.html" />
    <link rel="prev" title="pipeline.extern.findContinuum.findChannelsInChannelRangeWithComparableIntensity" href="pipeline.extern.findContinuum.findChannelsInChannelRangeWithComparableIntensity.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../index.html" class="icon icon-home">
            Pipeline
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/ways_to_run_the_pipeline.html">Ways to run the Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/recipes.html">Pipeline Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dependencies.html">Dependencies of <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Past Releases</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../apisummary.html">Full APIs (autosummary)</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pipeline.html">pipeline</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pipeline.initcli.html">pipeline.initcli</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.log_host_environment.html">pipeline.log_host_environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.show_weblog.html">pipeline.show_weblog</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.stop_weblog.html">pipeline.stop_weblog</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.cli.html">pipeline.cli</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.config.html">pipeline.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.domain.html">pipeline.domain</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.environment.html">pipeline.environment</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="pipeline.extern.html">pipeline.extern</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pipeline.extern.SDcalatmcorr.html">pipeline.extern.SDcalatmcorr</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.extern.TsysDataClassFile.html">pipeline.extern.TsysDataClassFile</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.extern.XmlObjectifier.html">pipeline.extern.XmlObjectifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.extern.adopted.html">pipeline.extern.adopted</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.extern.almahelpers.html">pipeline.extern.almahelpers</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.extern.almarenorm.html">pipeline.extern.almarenorm</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.extern.almarenorm_pl2023.html">pipeline.extern.almarenorm_pl2023</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="pipeline.extern.findContinuum.html">pipeline.extern.findContinuum</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipeline.extern.tsys_contamination.html">pipeline.extern.tsys_contamination</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.h.html">pipeline.h</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.hif.html">pipeline.hif</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.hifa.html">pipeline.hifa</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.hifv.html">pipeline.hifv</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.hsd.html">pipeline.hsd</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.hsdn.html">pipeline.hsdn</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.infrastructure.html">pipeline.infrastructure</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.qa.html">pipeline.qa</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.recipereducer.html">pipeline.recipereducer</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.recipes.html">pipeline.recipes</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.runpipeline.html">pipeline.runpipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.runvlapipeline.html">pipeline.runvlapipeline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apisummary.html#pipeline-tasks-autosummary">Pipeline Tasks (autosummary)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apisummary.html#pipeline-domain-context-autosummary">Pipeline domain/context (autosummary)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apisummary.html#pipeline-domain-infrastructure-modules-automodapi">Pipeline domain/infrastructure modules (automodapi)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apisummary.html#pipeline-h-tasks-modules-autmodapi"><code class="docutils literal notranslate"><span class="pre">pipeline.h*.tasks</span></code> modules (autmodapi)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apisummary.html#inheritance-diagrams-for-pipeline-task-inputs-results-classes">Inheritance Diagrams for Pipeline <code class="docutils literal notranslate"><span class="pre">Task</span></code>/<code class="docutils literal notranslate"><span class="pre">Inputs</span></code>/<code class="docutils literal notranslate"><span class="pre">Results</span></code> Classes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/ALMA-Imaging-Workflow.html">ALMA interferometry imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/VLA-Imaging-Workflow.html">VLA interferometry imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/VLASS-SE-CONT-Imaging-Workflow.html">VLASS-SE-CONT imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/VLASS-SE-CUBE-Imaging-Workflow.html">VLASS-SE-CUBE imaging workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/selfcal_workflow.html">VLASS Selfcal &amp; Restore workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/comparing_pipeline_executions.html">Comparing pipeline executions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/building_the_pipeline.html">Building the pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modular.html">Run the Pipeline in a Conda environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/pipeline_tests.html">Pipeline testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/DataType_Testing.html">DataType Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/QA_scores.html">Pipeline Quality Assurance (QA) Score Class Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/DeveloperDocumentation.html">Pipeline developer documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develdocmd/python3_conversion_notes.html">Python 3 conversion notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../heuristics/field_parameter.html">Field parameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../heuristics/FlaggingTasks.html">Pipeline Flagging Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/context.html">Pipeline Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/tier0dask.html">“Tier0” Parallelization with Dask/Futures</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Pipeline</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../apisummary.html">Full APIs (autosummary)</a></li>
          <li class="breadcrumb-item"><a href="pipeline.html">pipeline</a></li>
          <li class="breadcrumb-item"><a href="pipeline.extern.html">pipeline.extern</a></li>
          <li class="breadcrumb-item"><a href="pipeline.extern.findContinuum.html">pipeline.extern.findContinuum</a></li>
      <li class="breadcrumb-item active">pipeline.extern.findContinuum.findContinuum</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/pipeline.extern.findContinuum.findContinuum.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pipeline-extern-findcontinuum-findcontinuum">
<h1>pipeline.extern.findContinuum.findContinuum<a class="headerlink" href="#pipeline-extern-findcontinuum-findcontinuum" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="pipeline.extern.findContinuum.findContinuum">
<span class="sig-name descname"><span class="pre">findContinuum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbcube</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psfcube</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minbeamfrac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baselineModeA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baselineModeB</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaCube</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nBaselineChannels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.19</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaFindContinuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaFindContinuumMode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">png</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pngBasename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nanBufferChannels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useAbsoluteValue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trimChannels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuumThreshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">narrow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">';'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">titleText</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxTrim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxTrimFraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meanSpectrumFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centralArcsec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alternateDirectory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotAtmosphere</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transmission'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">airmass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pwv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channelFractionForSlopeRemoval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meanSpectrumMethod</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mom0mom8jointMask'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peakFilterFWHM</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skyTempThreshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skyTransmissionThreshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxGroupsForSkyThreshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minBandwidthFractionForSkyThreshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regressionTest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadraticFit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triangleFraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.83</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxMemory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdmSkyTempThreshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.65</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negativeThresholdFactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">singleContinuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">applyMaskToMask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotBaselinePoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropBaselineChannels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">madRatioUpperLimit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">madRatioLowerLimit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projectCode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useIAGetProfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useThresholdWithMask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalizeByMAD</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnSnrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwriteMoments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minPeakOverMadForSFCAdjustment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minPixelsInJointMask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">userJointMask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signalRatioTier1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.967</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snrThreshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">23</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mom0minsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mom8minsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwriteMasks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmStatContQuadratic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadraticNsigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bidirectionalMaskPhase2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">makeMovie</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnAllContinuumBoolean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowBluePruning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avoidance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnSigmaFindContinuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enableRejectNarrowInnerWindows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avoidExtremaInNoiseCalcForJointMask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buildMom8fc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amendMaskIterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipchan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkIfMaskWouldHaveBeenAmended</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholdForSame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepIntermediatePngs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnWarnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enableOnlyExtraMask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useMomentDiff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smallBandwidthFraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smallSpreadFraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.33</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipAmendMask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useAnnulus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cubeSigmaThreshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npixThreshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useJointMaskPrior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">telescope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ALMA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subimage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxMadRatioForSFCAdjustment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.18</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxMadRatioForSFCAdjustmentInLaterIterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.18</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaFindContinuumForExtraMask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momDiffLevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peakOverMadCriterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">65</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momDiffLevelForProceeding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minGroupsForSFCAdjustment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxGroups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momDiffApproachLevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mom08simultaneous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useUncorrectedMedian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storeExtraMask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnBluePoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">removeOutlierBaselineChannels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enableInitialQuadratic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipCubeNoise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnMomDiffSNR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectralDynamicRangeBandWidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tooManyPixels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">850</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useBaseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pipeline/extern/findContinuum.html#findContinuum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pipeline.extern.findContinuum.findContinuum" title="Link to this definition"></a></dt>
<dd><p>This function calls functions to:
1) compute a representative ‘mean’ spectrum of a dirty cube
2) find the continuum channels
3) plot the results and writes a text file with channel ranges and frequency ranges
It calls runFindContinuum up to 2 times.
If meanSpectrumMethod != ‘mom0mom8jointMask’, then it runs it a second
time with a reduced field size if it finds only one range of continuum
channels.</p>
<p>Please note that the channel ranges do not necessarily map back to
the visibility spectra in the measurement set(s).  In order to produce
channel ranges that are guaranteed to map back correctly, then you must
supply a list of all desired measurement sets to the vis parameter.  In
this case, the final line in the .dat file created will contain the
channel list in the correct frequency frame and order.</p>
<section id="returns">
<h2>Returns:<a class="headerlink" href="#returns" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>A channel selection string suitable for the spw parameter of clean.</p></li>
<li><p>The name of the final png produced.</p></li>
<li><p>The aggregate bandwidth in continuum in GHz.</p></li>
</ul>
<dl>
<dt>If returnAllContinuumBoolean = True, then it also returns a Boolean desribing</dt><dd><p>if it thinks the whole spectrum is continuum (True) or not (False)
Cycle 7 pipeline usage should set returnAllContinuumBoolean = True</p>
</dd>
<dt>If returnWarnings = True, then it also returns a list of warning strings,</dt><dd><p>which may be empty [], for tooLittleBandwidth and/or tooLittleSpread (PL2020+)
and the name of the joint mask image (PL2022+)</p>
</dd>
<dt>If returnSnrs = True, then it also returns two more lists: mom0snrs and mom8snrs,</dt><dd><p>and the max baseline (floating point meters) inferred from the psf image</p>
</dd>
<dt>if returnSigmaFindContinuum = True (new in PL2020), then it also returns 17 more things:</dt><dd><blockquote>
<div><ol class="arabic simple">
<li><p>the final value used for sigmaFindContinuum (PL2022: at the end of the .original stage)</p></li>
<li><p>the Boolean intersectionOfSelections</p></li>
<li><p>number of central ranges that were (or would have been) dropped, summed
over all runs of findContinuumChannels by the final run of runFindContinuum.</p></li>
<li><p>the result of amendMaskYesOrNo (if it was run;  False otherwise)</p></li>
<li><p>the result of extraMaskYesOrNo (if it was run;  False otherwise)</p></li>
<li><p>the result of extraMaskYesOrNo test 2 (if it was run;  False otherwise)</p></li>
<li><p>the result of autoLower</p></li>
<li><p>the name of the finalMomDiff image (if amendMask=True) else the final mom8fc image</p></li>
<li><p>the logic path code (for amendMask) (pathCode)</p></li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="10">
<li><p>the 4-letter code (for amendMask) (momDiffCode)</p></li>
<li><p>the SNR in the final momDiff image (momDiffSNR)</p></li>
<li><p>name of meanSpectrumFile produced</p></li>
<li><p>name of the “_findContinuum.dat” file produced</p></li>
<li><p>positiveThreshold (upper black dotted line)</p></li>
<li><p>negativeThreshold (lower black dotted line)</p></li>
<li><p>median (solid black line)</p></li>
<li><p>median of selected continuum channels (dotted cyan line)</p></li>
</ol>
</dd>
<dt>If returnMomDiffSNR = True (new in PL2023) and returnSigmaFindContinuum &amp; returnSNRs=False</dt><dd><p>then also return the momDiffSNR value.</p>
</dd>
<dt>PL2023 use case (returnWarnings=True, returnAllContinuumBoolean=True returnMomDiffSNR=True)</dt><dd><p>will return:
selection, png, aggregateBandwidth, allContinuum, warningStrings, jointMask, momDiffSNR</p>
</dd>
</dl>
</section>
<section id="required-inputs">
<h2>Required Inputs:<a class="headerlink" href="#required-inputs" title="Link to this heading"></a></h2>
<dl>
<dt>img: the image cube to operate upon (as opposed to specifying a</dt><dd><blockquote>
<div><p>pre-existing meanSpectrumFile from a previous run)</p>
</div></blockquote>
<p>–or–</p>
</dd>
<dt>meanSpectrumFile: an alternative pre-existing ASCII text file to use</dt><dd><p>for the mean spectrum, instead of operating on the img to create one.</p>
</dd>
<dt>Note: if you specify meanSpectrumFile and vis, you must also specify img, but</dt><dd><blockquote>
<div><p>only its metadata will be used.</p>
</div></blockquote>
<p>Parameters relevant only to meanSpectrumFile:
* invert: if True, then invert the sign of intensity and add the minimum</p>
</dd>
</dl>
</section>
<section id="optional-inputs-see-also-general-parameters-below">
<h2>Optional inputs (see also General Parameters below):<a class="headerlink" href="#optional-inputs-see-also-general-parameters-below" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>spw: the spw name or number (integer or string integer) to put in the x-axis label;</dt><dd><p>also, it will be used to select the spw for which to generate topo channels for the
<a href="#id1"><span class="problematic" id="id2">*</span></a>.dat file if vis is also specified; if vis is specified and spw is
not, then it will search the name of the image for an spw number
and use it for generating the topo channel list.</p>
</dd>
</dl>
<p>transition: the name of the spectral transition (for the plot title)
avoidance: a CASA channel selection string to avoid selecting (for manual use);</p>
<blockquote>
<div><p>invoked at the end of each execution of runFindContinuum()</p>
</div></blockquote>
<dl>
<dt>meanSpectrumMethod: ‘auto’, ‘mom0mom8jointMask’, ‘peakOverMad’, ‘peakOverRms’,</dt><dd><dl>
<dt>‘meanAboveThreshold’, ‘meanAboveThresholdOverRms’, ‘meanAboveThresholdOverMad’,</dt><dd><p>where ‘peak’ refers to the peak in a spatially-smoothed version of cube
‘auto’ invokes ‘meanAboveThreshold’ unless sky temperature range</p>
<blockquote>
<div><p>(max-min) from the atmospheric model is more than skyTempThreshold
in which case it invokes ‘peakOverMad’ instead</p>
</div></blockquote>
<p>ALMA Cycle 5 used ‘auto’, while ALMA Cycle 6 will use ‘mom0mom8jointMask’</p>
<ul>
<li><dl class="simple">
<dt>nbin: if greater than NBIN_THRESHOLD (4), then smooth spectrum by this</dt><dd><p>many channels</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>spectralDynamicRangeBandWidth: frequency string with units;</dt><dd><p>compute nbin based on this value (overrides nbin parameter),
example: ‘5.1MHz’</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>window: the smoothing window to use with nbin (one of: ‘gauss’,</dt><dd><p>‘flat’,’hanning’,’hamming’,’bartlett’,’blackman’)</p>
</dd>
</dl>
</li>
<li><p>minPeakOverMadForSFCAdjustment: scalar value</p></li>
<li><dl class="simple">
<dt>pbcube: the primary beam response for img, but only used by</dt><dd><p>meanSpectrumMethod=’mom0mom8jointMask’. If not specified,
it will be searched for by changing file suffix from .residual to .pb</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>psfcube: the psf response for img, but only used by</dt><dd><p>meanSpectrumMethod=’mom0mom8jointMask’. If not specified,
it will be searched for by changing file suffix from .residual to .psf,
if still not found, then pruneMask will default to 6 pixels</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>minbeamfrac: only used if psfcube is specified and meanSpectrumMethod=’mom0mom8jointMask’</dt><dd><p>floating point value or ‘auto’ for 0.3 for 12m and 0.1 for 7m (maxBaseline&lt;60m)
Set to zero to prevent pruning of the joint mask entirely; otherwise pruneMask
will use np.max([4,minbeamfrac*pixelsPerBeam])</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>minPixelsInJointMask: if fewer than these pixels are found (after pruning), then</dt><dd><p>use all pixels above pb=0.3 (or equivalent higher value on mitigated images).
This option was essentially obseleted by the addition of pruneMask with the
knowledge of beamsize from psfcube.  To avoid having any effect, it should be set
to &lt; minbeamfrac*minPixelsPerBeam, which is typically 0.5*7=3.5; so use 3 or less.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>userJointMask: if specified, use this joint mask instead of computing one</dt><dd><p>(this option is meant for test purposes only, typically <a href="#id3"><span class="problematic" id="id4">*</span></a>.mask2_bi)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>useJointMaskPrior: if True, and if the &lt;img&gt;_mom0mom8jointMaskPrior.pkl file exists,</dt><dd><p>then it will skip the creation of joint.mask and joint.mask2 on the first
iteration of amendMask to save some time.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>normalizeByMAD: can be True, False or ‘auto’ (default);</dt><dd><dl class="simple">
<dt>if ‘auto’, then if atmospheric transmission varies enough across the spw,</dt><dd><p>set to True, otherwise set to False.</p>
</dd>
<dt>If True, then request normalization of the resulting mean spectrum by the</dt><dd><p>xmadm spectrum using an outer annulus and outside the joint mask.  The
nominal annulus is the 0.2-0.3 pb response, but the range will
automatically be scaled upward with minimum value in the pb cube,
in order to preserve the fractional number of pixels contained in
a single field’s 0.2-0.3 annulus.</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><p>mom0minsnr: sets the threshold for the mom0 image (i.e. median + mom0minsnr*scaledMAD)</p></li>
<li><p>mom8minsnr: sets the threshold for the mom8 image (i.e. median + mom8minsnr*scaledMAD)</p></li>
<li><p>snrThreshold: if SNR is higher than this, then run a phase 2 mask calculation</p></li>
<li><dl class="simple">
<dt>bidirectionalMaskPhase2: True=extend mask to negative values beyond threshold;</dt><dd><p>False=Cycle6+ behavior (True was tried but gives worse results in some cases)</p>
</dd>
</dl>
</li>
<li><dl>
<dt>enableInitialQuadratic: if True, assess the need for quadratic removal, and use</dt><dd><p>the old-style method to remove it; if ‘auto’, then set to True only
if the lowercase version of the source name includes venus, mars,</p>
<blockquote>
<div><p>jupiter, saturn, uranus, or neptune</p>
</div></blockquote>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>rmStatContQuadratic: if True, then do not do the initialQuadratic removal (if</dt><dd><p>enabled and deemed necessary), but instead always perform the new-style
quadratic removal</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>makeMovie: if True, then make a png for each quadratic fit as channels are</dt><dd><p>removed one-by-one (in the rmStatContQuadratic option)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>quadraticNsigma: the stopping threshold to use when ignoring outliers prior to</dt><dd><p>fitting the quadratic (in the rmStatContQuadratic option). To more quickly test
different values, be sure to set the meanSpectrumFile option and overwrite=False)</p>
</dd>
</dl>
</li>
<li><p>allowBluePruning: use continuum range pruning heuristic added in Cycle 6 (default=True)</p></li>
<li><dl class="simple">
<dt>amendMaskIterations (new in PL2020): if ‘auto’, then choose 0 for TDM and 3 for FDM;</dt><dd><p>if 0, then do not attempt any amendMask (i.e. mimic the Cycle 7 pipeline release)
if &gt;=1, then when finished the initial findContinuum trial, create a mom8fc image and
mom0fc image scaled by nchan and chanwidth in kms, and subtract them to create momDiff
image. If the momDiff image has sufficient signal remaining in it, then expand the
joint mask, and repeat the findContinuum process with this expanded mask as the
userJointMask;  if &gt;=2, and there is still sufficient signal in the new momDiff image from
the second run of findContinuum, then check if further analysis of the extra portion of the
mask is necessary. If so, first check if intersecting the ranges of the first two rounds
eliminates the excess, otherwise create a new spectrum from it and pass it into a third
round of findContinuum with this as the meanSpectrum file.  If &gt;=3, and there is stil
sufficient signal in the new momDiff, image then set sigmaFindContinuumMode=’autolower’
and sigmaFindContinuum=most recent value, and run another round of findContinuum.
If &gt;= 4, and and there is sufficient signal in the new momDiff, run another round
of autolower.</p>
</dd>
</dl>
</li>
<li><p>skipAmendMask: if True, then skip the test for amend mask, and move on to onlyExtraMask</p></li>
<li><dl class="simple">
<dt>skipCubeNoise: if True, then do not run cubeNoiseLevel, instead set MADCubeOutside to</dt><dd><p>DISABLE_CUBE_NOISE and the cubeMedian to zero</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>tooManyPixels: value of pixels in mask beyond which amendMask will not</dt><dd><p>proceed, and causes result code ‘P#’</p>
</dd>
</dl>
</li>
<li><p>storeExtraMask: if True, the write the extraMask as a mask image (for debugging)</p></li>
<li><dl class="simple">
<dt>momDiffLevel: if amendMaskIterations&gt;0, sets the level above which pixels are counted.</dt><dd><p>For SingleContinuum 7m spws, the value is automatically incremented by 3.5. It is not
recommended to change this parameter, as it affects many heuristics. Change the next one.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>momDiffLevelForProceeding: if amendMaskIterations&gt;0, sets the level above pixels must be</dt><dd><p>in the mom8-mom0 image difference to be counted when determining whether to amend the mask.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>useAnnulus: if amendMaskIterations&gt;0, sets whether median/MAD in imageSNR be assessed in</dt><dd><p>annulus but outside the jointmask (True) or simply outside the joint mask (False)</p>
</dd>
</dl>
</li>
<li><p>subimage: if True, then add 0.2 to both radii of the annulus</p></li>
<li><p>enableOnlyExtraMask: if False, then do not do the extraMask or onlyExtraMask iterations</p></li>
<li><p>useMomentDiff: if False, use the mom8fc image to assess AmendMask decision instead of momDiff</p></li>
<li><dl class="simple">
<dt>checkIfMaskWouldHaveBeenAmended (new in PL2020): if True, then if amendMaskIterations=0,</dt><dd><p>then it will still check to see if the mask would have been amended and return the
result (assuming that returnSigmaFindContinuum==True) – for test purposes only</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>maxMadRatioForSFCAdjustment: one of the controls for lowering sigmaFindContinuum in</dt><dd><p>the .original amendMask iteration</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>maxMadRatioForSFCAdjustmentInLaterIterations: one of the controls for lowering</dt><dd><p>sigmaFindContinuum in amendMask iterations after the .original iteration</p>
</dd>
</dl>
</li>
</ul>
<ul>
<li><dl class="simple">
<dt>maxGroups: maximum number of continuum regions below which the potential reduction</dt><dd><p>factor of sigmaFindContinuum will be scaled by (1 - groups/maxGroups)**(bandwidth/1875e6)
via the following equation:</p>
</dd>
</dl>
<p>sFC_factor = np.max([scalingFactor/7.0, (1-groups/float(maxGroups)) ** (spwBandwidth/1.875e9)])</p>
</li>
</ul>
<ul class="simple">
<li><dl class="simple">
<dt>skyTempThreshold: rms value in Kelvin (for FDM spectra&lt;1000MHz), above which</dt><dd><p>the meanSpectrumMethod is changed in ‘auto’ mode to peakOverMad; and above
which normalizeByMAD is set True in meanSpectrumMethod=’mom0mom8jointMask’
when normalizeByMAD=’auto’ mode</p>
</dd>
</dl>
</li>
<li><p>tdmSkyTempThreshold: rms value in Kelvin (for TDM and 1875MHz FDM spectra)</p></li>
<li><dl class="simple">
<dt>skyTransmissionThreshold: threshold on (max-min)/mean, above which the</dt><dd><p>meanSpectrumMethod is changed in ‘auto’ mode to peakOverMad;  and above
which normalizeByMAD is set True in meanSpectrumMethod=’mom0mom8jointMask’
when normalizeByMAD=’auto’ mode</p>
</dd>
</dl>
</li>
<li><p>overwriteMoments: if True, then overwrite any existing moment0 or moment8 image</p></li>
<li><p>overwriteMasks: if True, then overwrite any existing moment0 or moment8 mask image</p></li>
<li><p>rmStatContQuadratic: if True, then fit and remove quadratic after removing outliers</p></li>
<li><dl class="simple">
<dt>outdir: directory to write the .mom0 and .mom8 images, .png, .dat and meanSpectrum</dt><dd><p>(default is same directory as the cube)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>avoidExtremaInNoiseCalcForJointMask (new in PL2020): experimental Boolean to avoid</dt><dd><p>pixels &lt;5%ile and &gt;95%ile in the chauvenet imstat of mom0 and mom8 images</p>
</dd>
</dl>
</li>
</ul>
<ul class="simple">
<li><dl class="simple">
<dt>triangleFraction: remove a triangle shape if the MAD of the dual-linfit residual</dt><dd><p>is less than this fraction*originalMAD; set this parameter to zero to turn it off.</p>
</dd>
</dl>
</li>
</ul>
<ul class="simple">
<li><p>maxMemory: behave as if the machine has this many GB of memory</p></li>
<li><dl class="simple">
<dt>nanBufferChannels: when removing or replacing NaNs, do this many extra channels</dt><dd><p>beyond their extent</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>channelFractionForSlopeRemoval: if this many channels are initially selected,</dt><dd><p>then fit and remove a linear slope and re-identify continuum channels
Set to 1 to turn off.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>quadraticFit: if True, fit quadratic polynomial to the noise regions when</dt><dd><p>deemed appropriate; Otherwise, fit only a linear slope</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>centralArcsec: radius of central box within which to compute the mean spectrum</dt><dd><p>default=’auto’ means start with whole field, then reduce to 1/10 if only
one window is found (unless mask is specified); or ‘fwhm’ for the central square
with the same radius as the PB FWHM; or a floating point value in arcseconds</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>mask: a mask image preferably equal in shape to the parent image that is used to determine</dt><dd><p>the region to compute the noise (outside the mask, i.e. mask=0) and
(in the ‘meanAboveThresholdMethod’) the mean spectrum (inside the mask, i.e. mask=1).
The spatial union of all masked pixels in all channels is used as the mask for each channel.
Option ‘auto’ will look for the &lt;filename&gt;.mask that matches the &lt;filename&gt;.image
and if it finds it, it will use it; otherwise it will use no mask.
If the mask does not match in shape but is multi-channel, it will be regridded to match
and written out as &lt;filename&gt;.mask.regrid.
If it matches spatially but is single-channel, this channel will be used for all.
To convert a .crtf file to a mask, use:
makemask(mode=’copy’, inpimage=img, inpmask=’chariklo.crtf’, output=img+’.mask’)</p>
</dd>
</dl>
</li>
<li><p>applyMaskToMask: if True, apply the mask inside the user mask image to set its masked pixels to 0</p></li>
</ul>
<ul class="simple">
<li><dl class="simple">
<dt>peakFilterFWHM: value (in pixels) to presmooth each plane with a Gaussian kernel of</dt><dd><p>this width.  Set to 1 to not do any smoothing.
Default = 10 which is typically about 2 synthesized beams.</p>
</dd>
</dl>
</li>
</ul>
<ul>
<li><dl class="simple">
<dt>useAbsoluteValue: passed to meanSpectrum, then avgOverCube – take absolute value of</dt><dd><p>the cube before producing mean spectrum</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>useThresholdWithMask: if False, then just take mean rather than meanAboveThreshold</dt><dd><p>when a mask has been specified</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>useIAGetProfile: if True, then for baselineMode=’min’, use ia.getprofile instead of</dt><dd><p>ia.getregion and subsequent arithmetic (faster, less memory exhaustive)</p>
</dd>
</dl>
</li>
<li><p>continuumThreshold: if specified, begin by using only pixels above this intensity level</p></li>
<li><dl class="simple">
<dt>sigmaCube: multiply this value by the MAD to get the threshold above</dt><dd><p>which a voxel is included in the mean spectrum.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>baselineModeA: ‘min’ or ‘edge’, method to define the baseline in meanSpectrum()</dt><dd><ul class="simple">
<li><p>percentile: control parameter for ‘min’</p></li>
</ul>
<p>Parameters relevant to ‘edge’:
* nBaselineChannels: if integer, then the number of channels to use in:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>computing the mean spectrum with the ‘meanAboveThreshold’ methods.</p></li>
<li><p>computing the MAD of the lowest/highest channels in findContinuumChannels
if float, then the fraction of channels to use (i.e. the percentile)
default = 0.19, which is 24 channels (i.e. 12 on each side) of a TDM window</p></li>
</ol>
</div></blockquote>
</dd>
</dl>
</li>
</ul>
<ul class="simple">
<li><dl class="simple">
<dt>keepIntermediatePngs: if True, keep changing the png name to avoid overwriting them; only</dt><dd><p>the final one is returned</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>thresholdForSame: fractional value used to determine if the residual in the mom8fc image</dt><dd><p>improved (‘L’), worsened (‘H’) or stayed the same (‘S’)</p>
</dd>
</dl>
</li>
<li><p>cubeSigmaThreshold: minimum cube SNR for onlyExtraMask to trigger</p></li>
<li><p>npixThreshold: minimum momDiff pixels for onlyExtraMask to trigger</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</section>
<section id="parameters-for-function-findcontinuumchannels-which-is-called-by-all-meanspectrum-heuristics">
<h2>Parameters for function findContinuumChannels (which is called by all meanSpectrum heuristics):<a class="headerlink" href="#parameters-for-function-findcontinuumchannels-which-is-called-by-all-meanspectrum-heuristics" title="Link to this heading"></a></h2>
<dl>
<dt>baselineModeB: ‘min’ (default) or ‘edge’, method to define the baseline</dt><dd><p>Parameters only relevant if baselineModeB=’min’:
* dropBaselineChannels: percentage of extreme values to drop
* removeOutlierBaselineChannels: after dropBaselineChannels, remove &gt;4*scMAD</p>
<blockquote>
<div><p>outliers;  options: ‘high’, ‘low’, ‘both’, or ‘’ == none/False</p>
</div></blockquote>
</dd>
<dt>useBaseline: ‘low’, ‘middle’, ‘high’ or ‘auto’; auto tries to automatically pick ‘low’ for</dt><dd><p>spectra that are emission-line dominated, ‘high’ if absorption line dominated, or ‘both’ if
both types of lines are present</p>
</dd>
<dt>nBaselineChannels: if integer, then the number of channels to use in computing</dt><dd><p>standard deviation/MAD of the baseline channels (i.e. the blue points in the plot)
if float, then it is the fraction of channels to use (i.e. the percentile)</p>
</dd>
<dt>sigmaFindContinuum: starting value for sigmaFindContinuum; passed to findContinuumChannels,</dt><dd><p>‘auto’ starts with value:
TDM: singleContinuum: 9, meanAboveThreshold: 4.5, peakOverMAD: 6.5,</p>
<blockquote>
<div><p>mom0mom8jointMask: 7.2</p>
</div></blockquote>
<dl class="simple">
<dt>FDM: meanAboveThreshold: 3.5, peakOverMAD: 6.0,</dt><dd><dl class="simple">
<dt>mom0mom8jointMask: nchan&lt;750: 4.2 (strong lines) or 4.5 (weak lines)</dt><dd><p>nchan&gt;=759: 2.5 (strong lines) or 3.2 (weak lines)</p>
</dd>
</dl>
</dd>
</dl>
<p>and adjusts it depending on results</p>
</dd>
</dl>
<p>sigmaFindContinuumMode (new in PL2020): ‘auto’, ‘autolower’, ‘fixed’
trimChannels: after doing best job of finding continuum, remove this many</p>
<blockquote>
<div><p>channels from each edge of each block of channels found (for margin of safety)
If it is a float between 0..1, then trim this fraction of channels in each
group (rounding up). If it is ‘auto’ (default), use 0.1 but not more than
maxTrim channels, and not more than maxTrimFraction</p>
</div></blockquote>
<dl>
<dt>narrow: the minimum number of channels that a group of channels must have to survive</dt><dd><dl class="simple">
<dt>if 0&lt;narrow&lt;1, then it is interpreted as the fraction of all</dt><dd><p>channels within identified blocks</p>
</dd>
</dl>
<p>if ‘auto’, then use int(ceil(log10(nchan)))</p>
</dd>
<dt>maxTrim: in trimChannels=’auto’, this is the max channels to trim per group for</dt><dd><p>TDM spws; it is automatically scaled upward for FDM spws.</p>
</dd>
</dl>
<p>maxTrimFraction: in trimChannels=’auto’, the max fraction of channels to trim per group
singleContinuum: if True, treat the cube as having come from a Single_Continuum setup;</p>
<blockquote>
<div><p>For testing purpose, if None, then check the contents of vis (if specified).</p>
</div></blockquote>
<dl class="simple">
<dt>negativeThresholdFactor: scale the nominal negative threshold by this factor (to</dt><dd><p>adjust the sensitivity to absorption features: smaller values=more sensitive)</p>
</dd>
<dt>signalRatioTier1: threshold for signalRatio, above which we desensitize the level to</dt><dd><p>consider line emission in order to avoid small differences in noise levels from
affecting the result (e.g. that occur between serial and parallel tclean cubes)
signalRatio=1 means: no lines seen, while closer to zero: more lines seen</p>
</dd>
<dt>enableRejectNarrowInnerWindows (new in PL2020): if True, then remove any inner groups</dt><dd><p>of channels that are narrower than both edge windows (when there are 3-15 groups)</p>
</dd>
</dl>
</section>
<section id="general-parameters">
<h2>General parameters:<a class="headerlink" href="#general-parameters" title="Link to this heading"></a></h2>
<p>verbose: if True, then print additional information during processing
useUncorrectedMedian: if True, then do not adjust the median (solid black line) upward</p>
<blockquote>
<div><p>from the median of the baseline points (dashed blue line)</p>
</div></blockquote>
<dl class="simple">
<dt>returnBluePoints: if True, then simply set the continuum ranges to the baseline points</dt><dd><p>(i.e. the blue points) inside each run of findContinuumChannels().  If using
mom0mom8jointMask with amendMask option, then also stop after amendMask (and
automatically disable the onlyExtraMask step, even if enableOnlyExtraMask=True)</p>
</dd>
<dt>momentdir (new in PL2020): alternative directory to look for (and write) the</dt><dd><p>moment 0&amp;8 images</p>
</dd>
</dl>
<p>png: the name of the png to produce (’’ yields default name)
pngBasename: if True, then remove the directory from img name before generating png name
source: the name of the source, to be shown in the title of the spectrum.</p>
<blockquote>
<div><p>if None, then use imhead(‘object’)</p>
</div></blockquote>
<dl>
<dt>overwrite: if True, or ASCII file does not exist, then recalculate the mean spectrum</dt><dd><blockquote>
<div><p>writing it to &lt;img&gt;.meanSpectrum</p>
</div></blockquote>
<p>if False, then read the mean spectrum from the existing ASCII file</p>
</dd>
</dl>
<p>separator: the character to use to separate groups of channels in the string returned
titleText: default is img name and transition and the control parameter values
plotAtmosphere: ‘’, ‘tsky’, or ‘transmission’
airmass: for plot of atmospheric transmission
skipchan (newly-exposed in PL2020): used in making the spectral plot, the number of highest</p>
<blockquote>
<div><p>and lowest intensity channels to avoid when constructing the y-axis range</p>
</div></blockquote>
<p>pwv: in mm (for plot of atmospheric transmission)
vis: comma-delimited list or python list of measurement sets to use to convert channel</p>
<blockquote>
<div><p>ranges to topocentric frequency ranges (for use in uvcontfit or uvcontsub)
or ‘auto’ which will look for any/all vis in the cube directory</p>
</div></blockquote>
<p>plotBaselinePoints: if True, then plot the baseline-defining points as black dots
fontsize (newly-exposed in PL2020): size to use for channel ranges, axis labels and plot legend
dpi: dots per inch to use in writing the png (106 produces 861x649 pixels)</p>
<blockquote>
<div><p>150 produces 1218x918</p>
</div></blockquote>
<dl class="simple">
<dt>projectCode: a string to prepend to the title of the plot (useful for regression testing</dt><dd><p>where you can put the page number from the full PDF when running only a subset)</p>
</dd>
<dt>buildMom8fc (new in PL2020): if True, then when finished, generate “mom8fc” and “mom0fc”</dt><dd><p>images using selected channels</p>
</dd>
</dl>
<p>smallBandwidthFraction: threshold for returning a warning for too little bandwidth found
smallSpreadFraction: threshold for returning a warning for too little bandwidth spread found
telescope: name of telescope to use (if no image is passed from which to</p>
<blockquote>
<div><p>read it from the header)</p>
</div></blockquote>
<p>window: the smoothing window to apply to the mean spectrum (when nbin&gt;4)
mom08simultaneous: if True, set moments=[0,8] in one call to immoments instead of two</p>
</section>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pipeline.extern.findContinuum.findChannelsInChannelRangeWithComparableIntensity.html" class="btn btn-neutral float-left" title="pipeline.extern.findContinuum.findChannelsInChannelRangeWithComparableIntensity" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pipeline.extern.findContinuum.findContinuumChannels.html" class="btn btn-neutral float-right" title="pipeline.extern.findContinuum.findContinuumChannels" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020–2024, Pipeline Dev. Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>